
<!doctype html>
<html lang="es" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../ud5_5_flutter_navigation/">
      
      
        <link rel="next" href="../ud5_7_flutter_http/">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.4.2">
    
    
      
        <title>UD5 - 5.6 Flutter: Persistencia de datos - DAM - Diseño de Interfaces - 2023/24</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.d451bc0e.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.a5377069.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../stylesheets/bs5_layout.css">
    
      <link rel="stylesheet" href="../../stylesheets/custom.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="teal" data-md-color-accent="purple">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#ud5-56-flutter-persistencia-de-datos" class="md-skip">
          Saltar a contenido
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Cabecera">
    <a href="../.." title="DAM - Diseño de Interfaces - 2023/24" class="md-header__button md-logo" aria-label="DAM - Diseño de Interfaces - 2023/24" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            DAM - Diseño de Interfaces - 2023/24
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              UD5 - 5.6 Flutter: Persistencia de datos
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="teal" data-md-color-accent="purple"  aria-label="Cambiar a modo oscuro"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Cambiar a modo oscuro" for="__palette_2" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6zm0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4zM7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="teal" data-md-color-accent="lime"  aria-label="Cambiar a modo claro"  type="radio" name="__palette" id="__palette_2">
    
      <label class="md-header__button md-icon" title="Cambiar a modo claro" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3Z"/></svg>
      </label>
    
  
</form>
      
    
    
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Pestañas" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../proyectos/proyecto2ev/" class="md-tabs__link">
          
  
  Proyecto 2ª ev

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../.." class="md-tabs__link">
          
  
  Inicio

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../ud1/ud1_intro/" class="md-tabs__link">
          
  
  UD1 Introducción

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../ud2/ud2_1_electron_requisitos/" class="md-tabs__link">
          
  
  UD2 Elementos

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../ud3/ud3_1_componentes_basicos/" class="md-tabs__link">
          
  
  UD3 Componentes

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../ud4/ud4_1_componentes_avanzados/" class="md-tabs__link">
          
  
  UD4 Componentes avanzados

        </a>
      </li>
    
  

      
        
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../ud5_1_usabilidad/" class="md-tabs__link">
          
  
  UD5 Usabilidad y accesibilidad

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navegación" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="DAM - Diseño de Interfaces - 2023/24" class="md-nav__button md-logo" aria-label="DAM - Diseño de Interfaces - 2023/24" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    DAM - Diseño de Interfaces - 2023/24
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
    
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1" >
        
          
          <label class="md-nav__link" for="__nav_1" id="__nav_1_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Proyecto 2ª ev
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1">
            <span class="md-nav__icon md-icon"></span>
            Proyecto 2ª ev
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../proyectos/proyecto2ev/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DIN semipresencial 2023-24 - Proyecto 2ª Evaluación
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Inicio
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Inicio
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DAM Desarrollo de Interfaces 2023-2024
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../entorno/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Entorno de trabajo
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="">
            
  
  <span class="md-ellipsis">
    UD1 Introducción
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            UD1 Introducción
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../ud1/ud1_intro/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    UD1 Introducción
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="">
            
  
  <span class="md-ellipsis">
    UD2 Elementos
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            UD2 Elementos
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../ud2/ud2_1_electron_requisitos/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    UD2 - 2.1. Introducción a Electron. Requisitos
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../ud2/ud2_2_primera_app/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    UD2 - 2.2. Creando la primera aplicación
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../ud2/ud2_3_maquetacion/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    UD2 - 2.3. Maquetación básica del interfaz de usuario
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="">
            
  
  <span class="md-ellipsis">
    UD3 Componentes
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            UD3 Componentes
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../ud3/ud3_1_componentes_basicos/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    UD3 - 3.1 Componentes básicos de una interfaz
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../ud3/ud3_2_electron_procesos/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    UD3. 2 Comunicación entre procesos
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="">
            
  
  <span class="md-ellipsis">
    UD4 Componentes avanzados
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            UD4 Componentes avanzados
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../ud4/ud4_1_componentes_avanzados/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    UD4 - 4.1 Componentes avanzados
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../ud4/ud4_2_electron_react/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    UD4 - 4.2 Integración de React en Electron
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../ud4/ud4_3_react-eventos-estados/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    UD4 - 4.3 Eventos y estados en React
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../ud4/ud4_4_route-store/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    UD4 - 4.4 Navegación y persistencia de datos
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../ud4/ud4_5_example/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    UD4 - 4.5 Aplicación de ejemplo
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
    
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" checked>
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="">
            
  
  <span class="md-ellipsis">
    UD5 Usabilidad y accesibilidad
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            UD5 Usabilidad y accesibilidad
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../ud5_1_usabilidad/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    UD5 - 5.1 Usabilidad y experiencia de usuario
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../ud5_2_flutter_intro/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    UD5 - 5.2 Introducción a Flutter
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../ud5_3_flutter_layout/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    UD5 - 5.3 Flutter: Widgets y Layout
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../ud5_4_flutter_state/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    UD5 - 5.4 Flutter: Gestión de estados
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../ud5_5_flutter_navigation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    UD5 - 5.5 Flutter: Navegación e interactividad
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    UD5 - 5.6 Flutter: Persistencia de datos
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    UD5 - 5.6 Flutter: Persistencia de datos
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Tabla de contenidos">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Tabla de contenidos
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#introduccion" class="md-nav__link">
    Introducción
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#modelo-de-datos" class="md-nav__link">
    Modelo de datos
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#crear-una-nueva-aplicacion" class="md-nav__link">
    Crear una nueva aplicación
  </a>
  
    <nav class="md-nav" aria-label="Crear una nueva aplicación">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#modelo-de-datos_1" class="md-nav__link">
    Modelo de datos
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mostrar-los-productos" class="md-nav__link">
    Mostrar los productos
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#convertir-objetos-a-json" class="md-nav__link">
    Convertir objetos a JSON
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#solucionar-problemas-tipicos-con-json" class="md-nav__link">
    Solucionar problemas típicos con JSON
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#claves-de-las-propiedades" class="md-nav__link">
    Claves de las propiedades
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#almacenamiento-local" class="md-nav__link">
    Almacenamiento local
  </a>
  
    <nav class="md-nav" aria-label="Almacenamiento local">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#instalar-la-libreria" class="md-nav__link">
    Instalar la librería
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tipos-de-datos-soportados" class="md-nav__link">
    Tipos de datos soportados
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#guardar-un-valor" class="md-nav__link">
    Guardar un valor
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#leer-un-valor" class="md-nav__link">
    Leer un valor
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#anadir-un-nuevo-producto" class="md-nav__link">
    Añadir un nuevo producto
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#vista-detalle" class="md-nav__link">
    Vista detalle
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#vista-edicion" class="md-nav__link">
    Vista edición
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../ud5_7_flutter_http/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    UD5 - 5.7 Flutter: Comunicación con el servidor
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Tabla de contenidos">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Tabla de contenidos
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#introduccion" class="md-nav__link">
    Introducción
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#modelo-de-datos" class="md-nav__link">
    Modelo de datos
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#crear-una-nueva-aplicacion" class="md-nav__link">
    Crear una nueva aplicación
  </a>
  
    <nav class="md-nav" aria-label="Crear una nueva aplicación">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#modelo-de-datos_1" class="md-nav__link">
    Modelo de datos
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mostrar-los-productos" class="md-nav__link">
    Mostrar los productos
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#convertir-objetos-a-json" class="md-nav__link">
    Convertir objetos a JSON
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#solucionar-problemas-tipicos-con-json" class="md-nav__link">
    Solucionar problemas típicos con JSON
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#claves-de-las-propiedades" class="md-nav__link">
    Claves de las propiedades
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#almacenamiento-local" class="md-nav__link">
    Almacenamiento local
  </a>
  
    <nav class="md-nav" aria-label="Almacenamiento local">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#instalar-la-libreria" class="md-nav__link">
    Instalar la librería
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tipos-de-datos-soportados" class="md-nav__link">
    Tipos de datos soportados
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#guardar-un-valor" class="md-nav__link">
    Guardar un valor
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#leer-un-valor" class="md-nav__link">
    Leer un valor
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#anadir-un-nuevo-producto" class="md-nav__link">
    Añadir un nuevo producto
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#vista-detalle" class="md-nav__link">
    Vista detalle
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#vista-edicion" class="md-nav__link">
    Vista edición
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<h1 id="ud5-56-flutter-persistencia-de-datos">UD5 - 5.6 Flutter: Persistencia de datos<a class="headerlink" href="#ud5-56-flutter-persistencia-de-datos" title="Permanent link">&para;</a></h1>
<h2 id="introduccion">Introducción<a class="headerlink" href="#introduccion" title="Permanent link">&para;</a></h2>
<p>En este apartado vamos a ver como guardar datos en el dispositivo. Para ello, vamos a crear una aplicación de gestión de productos, que permita añadir, editar y eliminar productos. Además, se va a usar el almacenamiento local para guardar los productos.</p>
<h2 id="modelo-de-datos">Modelo de datos<a class="headerlink" href="#modelo-de-datos" title="Permanent link">&para;</a></h2>
<p>JSON se ha convertido en el formato estándar para almacenar, intercambiar y consumir datos entre aplicaciones. Muchos servicios utilizan JSON para recibir y devolver información. Por lo tanto, es una buena idea utilizar JSON para almacenar los datos de nuestra aplicación.</p>
<p>JSON es un estándar de intercambio de datos basado en texto, donde se almacenan pares clave-valor. Como es un String, podemos convertir objetos de Dart a JSON, conocido como serializar, y viceversa, de JSON a objeto (deserializar).</p>
<p>Se utilizará la librería <code>dart:convert</code> que viene incluida en el SDK de Dart para serializar y deserializar objetos.</p>
<h2 id="crear-una-nueva-aplicacion">Crear una nueva aplicación<a class="headerlink" href="#crear-una-nueva-aplicacion" title="Permanent link">&para;</a></h2>
<p>Para el ejemplo, se crea una nueva aplicación llamada <code>flutter_products</code>, con la siguiente estructura básica.</p>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">lib/main.dart</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-0-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-0-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-0-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-0-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-0-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-0-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-0-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-0-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-0-10">10</a></span>
<span class="normal"><a href="#__codelineno-0-11">11</a></span>
<span class="normal"><a href="#__codelineno-0-12">12</a></span>
<span class="normal"><a href="#__codelineno-0-13">13</a></span>
<span class="normal"><a href="#__codelineno-0-14">14</a></span>
<span class="normal"><a href="#__codelineno-0-15">15</a></span>
<span class="normal"><a href="#__codelineno-0-16">16</a></span>
<span class="normal"><a href="#__codelineno-0-17">17</a></span>
<span class="normal"><a href="#__codelineno-0-18">18</a></span>
<span class="normal"><a href="#__codelineno-0-19">19</a></span>
<span class="normal"><a href="#__codelineno-0-20">20</a></span>
<span class="normal"><a href="#__codelineno-0-21">21</a></span>
<span class="normal"><a href="#__codelineno-0-22">22</a></span>
<span class="normal"><a href="#__codelineno-0-23">23</a></span>
<span class="normal"><a href="#__codelineno-0-24">24</a></span>
<span class="normal"><a href="#__codelineno-0-25">25</a></span>
<span class="normal"><a href="#__codelineno-0-26">26</a></span>
<span class="normal"><a href="#__codelineno-0-27">27</a></span>
<span class="normal"><a href="#__codelineno-0-28">28</a></span>
<span class="normal"><a href="#__codelineno-0-29">29</a></span>
<span class="normal"><a href="#__codelineno-0-30">30</a></span>
<span class="normal"><a href="#__codelineno-0-31">31</a></span>
<span class="normal"><a href="#__codelineno-0-32">32</a></span>
<span class="normal"><a href="#__codelineno-0-33">33</a></span>
<span class="normal"><a href="#__codelineno-0-34">34</a></span>
<span class="normal"><a href="#__codelineno-0-35">35</a></span>
<span class="normal"><a href="#__codelineno-0-36">36</a></span>
<span class="normal"><a href="#__codelineno-0-37">37</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="k">import</span><span class="w"> </span><span class="s1">&#39;package:flutter/material.dart&#39;</span><span class="p">;</span>
<a id="__codelineno-0-2" name="__codelineno-0-2"></a>
<a id="__codelineno-0-3" name="__codelineno-0-3"></a><span class="kt">void</span><span class="w"> </span><span class="n">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-0-4" name="__codelineno-0-4"></a><span class="w">  </span><span class="n">runApp</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">ProductsApp</span><span class="p">());</span>
<a id="__codelineno-0-5" name="__codelineno-0-5"></a><span class="p">}</span>
<a id="__codelineno-0-6" name="__codelineno-0-6"></a>
<a id="__codelineno-0-7" name="__codelineno-0-7"></a><span class="kd">class</span><span class="w"> </span><span class="nc">ProductsApp</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">StatelessWidget</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-0-8" name="__codelineno-0-8"></a><span class="w">  </span><span class="k">const</span><span class="w"> </span><span class="n">ProductsApp</span><span class="p">({</span><span class="k">super</span><span class="p">.</span><span class="n">key</span><span class="p">});</span>
<a id="__codelineno-0-9" name="__codelineno-0-9"></a>
<a id="__codelineno-0-10" name="__codelineno-0-10"></a><span class="w">  </span><span class="nd">@override</span>
<a id="__codelineno-0-11" name="__codelineno-0-11"></a><span class="w">  </span><span class="n">Widget</span><span class="w"> </span><span class="n">build</span><span class="p">(</span><span class="n">BuildContext</span><span class="w"> </span><span class="n">context</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-0-12" name="__codelineno-0-12"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">MaterialApp</span><span class="p">(</span>
<a id="__codelineno-0-13" name="__codelineno-0-13"></a><span class="w">      </span><span class="nl">title:</span><span class="w"> </span><span class="s1">&#39;Flutter Products&#39;</span><span class="p">,</span>
<a id="__codelineno-0-14" name="__codelineno-0-14"></a><span class="w">      </span><span class="nl">debugShowCheckedModeBanner:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span>
<a id="__codelineno-0-15" name="__codelineno-0-15"></a><span class="w">      </span><span class="nl">theme:</span><span class="w"> </span><span class="n">ThemeData</span><span class="p">(</span>
<a id="__codelineno-0-16" name="__codelineno-0-16"></a><span class="w">        </span><span class="nl">colorScheme:</span><span class="w"> </span><span class="n">ColorScheme</span><span class="p">.</span><span class="n">fromSeed</span><span class="p">(</span><span class="nl">seedColor:</span><span class="w"> </span><span class="n">Colors</span><span class="p">.</span><span class="n">blue</span><span class="p">),</span>
<a id="__codelineno-0-17" name="__codelineno-0-17"></a><span class="w">        </span><span class="nl">useMaterial3:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<a id="__codelineno-0-18" name="__codelineno-0-18"></a><span class="w">      </span><span class="p">),</span>
<a id="__codelineno-0-19" name="__codelineno-0-19"></a><span class="w">      </span><span class="nl">home:</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">Products</span><span class="p">(),</span>
<a id="__codelineno-0-20" name="__codelineno-0-20"></a><span class="w">    </span><span class="p">);</span>
<a id="__codelineno-0-21" name="__codelineno-0-21"></a><span class="w">  </span><span class="p">}</span>
<a id="__codelineno-0-22" name="__codelineno-0-22"></a><span class="p">}</span>
<a id="__codelineno-0-23" name="__codelineno-0-23"></a>
<a id="__codelineno-0-24" name="__codelineno-0-24"></a><span class="kd">class</span><span class="w"> </span><span class="nc">Products</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">StatefulWidget</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-0-25" name="__codelineno-0-25"></a><span class="w">  </span><span class="k">const</span><span class="w"> </span><span class="n">Products</span><span class="p">({</span><span class="k">super</span><span class="p">.</span><span class="n">key</span><span class="p">});</span>
<a id="__codelineno-0-26" name="__codelineno-0-26"></a>
<a id="__codelineno-0-27" name="__codelineno-0-27"></a><span class="w">  </span><span class="nd">@override</span>
<a id="__codelineno-0-28" name="__codelineno-0-28"></a><span class="w">  </span><span class="n">State</span><span class="o">&lt;</span><span class="n">Products</span><span class="o">&gt;</span><span class="w"> </span><span class="n">createState</span><span class="p">()</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">_ProductsState</span><span class="p">();</span>
<a id="__codelineno-0-29" name="__codelineno-0-29"></a><span class="p">}</span>
<a id="__codelineno-0-30" name="__codelineno-0-30"></a>
<a id="__codelineno-0-31" name="__codelineno-0-31"></a><span class="kd">class</span><span class="w"> </span><span class="nc">_ProductsState</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">State</span><span class="o">&lt;</span><span class="n">Products</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-0-32" name="__codelineno-0-32"></a><span class="w">  </span><span class="nd">@override</span>
<a id="__codelineno-0-33" name="__codelineno-0-33"></a><span class="w">  </span><span class="n">Widget</span><span class="w"> </span><span class="n">build</span><span class="p">(</span><span class="n">BuildContext</span><span class="w"> </span><span class="n">context</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-0-34" name="__codelineno-0-34"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">Scaffold</span><span class="p">(</span>
<a id="__codelineno-0-35" name="__codelineno-0-35"></a><span class="w">        </span><span class="nl">appBar:</span><span class="w"> </span><span class="n">AppBar</span><span class="p">(</span><span class="nl">title:</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span><span class="s1">&#39;JSON&#39;</span><span class="p">)),</span><span class="w"> </span><span class="nl">body:</span><span class="w"> </span><span class="n">Container</span><span class="p">());</span>
<a id="__codelineno-0-36" name="__codelineno-0-36"></a><span class="w">  </span><span class="p">}</span>
<a id="__codelineno-0-37" name="__codelineno-0-37"></a><span class="p">}</span>
</code></pre></div></td></tr></table></div>
<p>Añadir un nievo directorio llamado <code>assets/</code> en la raíz del proyecto.</p>
<p>Dentro de <code>assets/</code> crear un fichero llamado <code>products.json</code> con el siguiente contenido:</p>
<div class="highlight"><span class="filename">assets/products.json</span><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="p">[</span>
<a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a><span class="w">  </span><span class="p">{</span>
<a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a><span class="w">    </span><span class="nt">&quot;id&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span>
<a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a><span class="w">    </span><span class="nt">&quot;description&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;WD BLACK SN770 2TB NVMe SSD&quot;</span><span class="p">,</span>
<a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a><span class="w">    </span><span class="nt">&quot;price&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">115</span><span class="p">,</span>
<a id="__codelineno-1-6" name="__codelineno-1-6" href="#__codelineno-1-6"></a><span class="w">    </span><span class="nt">&quot;available&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2023-10-03&quot;</span><span class="p">,</span>
<a id="__codelineno-1-7" name="__codelineno-1-7" href="#__codelineno-1-7"></a><span class="w">    </span><span class="nt">&quot;imageUrl&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;http://placehold.it/200x100&quot;</span><span class="p">,</span>
<a id="__codelineno-1-8" name="__codelineno-1-8" href="#__codelineno-1-8"></a><span class="w">    </span><span class="nt">&quot;rating&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">5</span>
<a id="__codelineno-1-9" name="__codelineno-1-9" href="#__codelineno-1-9"></a><span class="w">  </span><span class="p">},</span>
<a id="__codelineno-1-10" name="__codelineno-1-10" href="#__codelineno-1-10"></a><span class="w">  </span><span class="p">{</span>
<a id="__codelineno-1-11" name="__codelineno-1-11" href="#__codelineno-1-11"></a><span class="w">    </span><span class="nt">&quot;id&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span>
<a id="__codelineno-1-12" name="__codelineno-1-12" href="#__codelineno-1-12"></a><span class="w">    </span><span class="nt">&quot;description&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;MSI MPG B550 GAMING PLUS&quot;</span><span class="p">,</span>
<a id="__codelineno-1-13" name="__codelineno-1-13" href="#__codelineno-1-13"></a><span class="w">    </span><span class="nt">&quot;price&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">139.9</span><span class="p">,</span>
<a id="__codelineno-1-14" name="__codelineno-1-14" href="#__codelineno-1-14"></a><span class="w">    </span><span class="nt">&quot;available&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2023-09-15&quot;</span><span class="p">,</span>
<a id="__codelineno-1-15" name="__codelineno-1-15" href="#__codelineno-1-15"></a><span class="w">    </span><span class="nt">&quot;imageUrl&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;http://placehold.it/200x100&quot;</span><span class="p">,</span>
<a id="__codelineno-1-16" name="__codelineno-1-16" href="#__codelineno-1-16"></a><span class="w">    </span><span class="nt">&quot;rating&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">4</span>
<a id="__codelineno-1-17" name="__codelineno-1-17" href="#__codelineno-1-17"></a><span class="w">  </span><span class="p">},</span>
<a id="__codelineno-1-18" name="__codelineno-1-18" href="#__codelineno-1-18"></a><span class="w">  </span><span class="p">{</span>
<a id="__codelineno-1-19" name="__codelineno-1-19" href="#__codelineno-1-19"></a><span class="w">    </span><span class="nt">&quot;id&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span>
<a id="__codelineno-1-20" name="__codelineno-1-20" href="#__codelineno-1-20"></a><span class="w">    </span><span class="nt">&quot;description&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Kingston FURY Beast DDR4 3200 MHz 16GB 2x8GB CL16&quot;</span><span class="p">,</span>
<a id="__codelineno-1-21" name="__codelineno-1-21" href="#__codelineno-1-21"></a><span class="w">    </span><span class="nt">&quot;price&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">45.95</span><span class="p">,</span>
<a id="__codelineno-1-22" name="__codelineno-1-22" href="#__codelineno-1-22"></a><span class="w">    </span><span class="nt">&quot;available&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2023-01-03&quot;</span><span class="p">,</span>
<a id="__codelineno-1-23" name="__codelineno-1-23" href="#__codelineno-1-23"></a><span class="w">    </span><span class="nt">&quot;imageUrl&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;http://placehold.it/200x100&quot;</span><span class="p">,</span>
<a id="__codelineno-1-24" name="__codelineno-1-24" href="#__codelineno-1-24"></a><span class="w">    </span><span class="nt">&quot;rating&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">3</span>
<a id="__codelineno-1-25" name="__codelineno-1-25" href="#__codelineno-1-25"></a><span class="w">  </span><span class="p">}</span>
<a id="__codelineno-1-26" name="__codelineno-1-26" href="#__codelineno-1-26"></a><span class="p">]</span>
</code></pre></div>
<p>En el fichero de configuración <code>pubspec.yaml</code> añadir el siguiente código dentro del apartado <code>flutter:</code>:</p>
<div class="highlight"><span class="filename">pubspec.yaml</span><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="nn">...</span>
<a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a><span class="hll"><span class="w">  </span><span class="nt">assets</span><span class="p">:</span>
</span><a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a><span class="hll"><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">assets/</span>
</span><a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a><span class="nn">...</span>
</code></pre></div>
<p>En la clase <code>_ProductsState</code> añadir el siguiente código:</p>
<div class="highlight"><span class="filename">lib/main.dart</span><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="p">...</span>
<a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a><span class="kd">class</span><span class="w"> </span><span class="nc">_ProductsState</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">State</span><span class="o">&lt;</span><span class="n">Products</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a><span class="hll"><span class="w">  </span><span class="kt">String</span><span class="w"> </span><span class="n">productsJSONString</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="p">;</span>
</span><a id="__codelineno-3-4" name="__codelineno-3-4" href="#__codelineno-3-4"></a><span class="w">  </span><span class="p">...</span>
</code></pre></div>
<p>Para leer el contenido del fichero <code>products.json</code>, al final de <code>_ProductsState</code> añadir un nuevo método asíncrono llamado <code>readJsonFile</code> que establecerá el valor de <code>productsJSONString</code> con el contenido del fichero.</p>
<div class="highlight"><span class="filename">lib/main.dart</span><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a><span class="p">...</span>
<a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a><span class="kd">class</span><span class="w"> </span><span class="nc">_ProductsState</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">State</span><span class="o">&lt;</span><span class="n">Products</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a><span class="w">  </span><span class="kt">String</span><span class="w"> </span><span class="n">productsJSONString</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="p">;</span>
<a id="__codelineno-4-4" name="__codelineno-4-4" href="#__codelineno-4-4"></a>
<a id="__codelineno-4-5" name="__codelineno-4-5" href="#__codelineno-4-5"></a><span class="w">  </span><span class="p">...</span>
<a id="__codelineno-4-6" name="__codelineno-4-6" href="#__codelineno-4-6"></a>
<a id="__codelineno-4-7" name="__codelineno-4-7" href="#__codelineno-4-7"></a><span class="hll"><span class="w">  </span><span class="n">Future</span><span class="w"> </span><span class="n">readJsonFile</span><span class="p">()</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="p">{</span>
</span><a id="__codelineno-4-8" name="__codelineno-4-8" href="#__codelineno-4-8"></a><span class="hll"><span class="w">    </span><span class="kt">String</span><span class="w"> </span><span class="n">jsonString</span><span class="w"> </span><span class="o">=</span>
</span><a id="__codelineno-4-9" name="__codelineno-4-9" href="#__codelineno-4-9"></a><span class="hll"><span class="w">        </span><span class="kd">await</span><span class="w"> </span><span class="n">DefaultAssetBundle</span><span class="p">.</span><span class="n">of</span><span class="p">(</span><span class="n">context</span><span class="p">).</span><span class="n">loadString</span><span class="p">(</span><span class="s1">&#39;assets/products.json&#39;</span><span class="p">);</span>
</span><a id="__codelineno-4-10" name="__codelineno-4-10" href="#__codelineno-4-10"></a><span class="hll"><span class="w">    </span><span class="n">setState</span><span class="p">(()</span><span class="w"> </span><span class="p">{</span>
</span><a id="__codelineno-4-11" name="__codelineno-4-11" href="#__codelineno-4-11"></a><span class="hll"><span class="w">      </span><span class="n">productsJSONString</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">jsonString</span><span class="p">;</span>
</span><a id="__codelineno-4-12" name="__codelineno-4-12" href="#__codelineno-4-12"></a><span class="hll"><span class="w">    </span><span class="p">});</span>
</span><a id="__codelineno-4-13" name="__codelineno-4-13" href="#__codelineno-4-13"></a><span class="hll"><span class="w">  </span><span class="p">}</span>
</span><a id="__codelineno-4-14" name="__codelineno-4-14" href="#__codelineno-4-14"></a><span class="p">}</span>
</code></pre></div>
<p>Sobrecargar el método <code>initState</code> para llamar al método <code>readJsonFile</code>:</p>
<div class="highlight"><span class="filename">lib/main.dart</span><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a><span class="p">...</span>
<a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a><span class="kd">class</span><span class="w"> </span><span class="nc">_ProductsState</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">State</span><span class="o">&lt;</span><span class="n">Products</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-5-3" name="__codelineno-5-3" href="#__codelineno-5-3"></a><span class="w">  </span><span class="kt">String</span><span class="w"> </span><span class="n">productsJSONString</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="p">;</span>
<a id="__codelineno-5-4" name="__codelineno-5-4" href="#__codelineno-5-4"></a>
<a id="__codelineno-5-5" name="__codelineno-5-5" href="#__codelineno-5-5"></a><span class="hll"><span class="w">  </span><span class="nd">@override</span>
</span><a id="__codelineno-5-6" name="__codelineno-5-6" href="#__codelineno-5-6"></a><span class="hll"><span class="w">  </span><span class="kt">void</span><span class="w"> </span><span class="n">initState</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><a id="__codelineno-5-7" name="__codelineno-5-7" href="#__codelineno-5-7"></a><span class="hll"><span class="w">    </span><span class="k">super</span><span class="p">.</span><span class="n">initState</span><span class="p">();</span>
</span><a id="__codelineno-5-8" name="__codelineno-5-8" href="#__codelineno-5-8"></a><span class="hll"><span class="w">    </span><span class="n">readJsonFile</span><span class="p">();</span>
</span><a id="__codelineno-5-9" name="__codelineno-5-9" href="#__codelineno-5-9"></a><span class="hll"><span class="w">  </span><span class="p">}</span>
</span><a id="__codelineno-5-10" name="__codelineno-5-10" href="#__codelineno-5-10"></a>
<a id="__codelineno-5-11" name="__codelineno-5-11" href="#__codelineno-5-11"></a><span class="w">  </span><span class="p">...</span>
</code></pre></div>
<p>Ahora, para mostrar el JSON en el <code>body</code> se añade un widget <code>Text</code> con el contenido de <code>productsJSONString</code>:</p>
<div class="highlight"><span class="filename">lib/main.dart</span><pre><span></span><code><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a><span class="p">...</span>
<a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a><span class="kd">class</span><span class="w"> </span><span class="nc">_ProductsState</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">State</span><span class="o">&lt;</span><span class="n">Products</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-6-3" name="__codelineno-6-3" href="#__codelineno-6-3"></a><span class="w">  </span><span class="kt">String</span><span class="w"> </span><span class="n">productsJSONString</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="p">;</span>
<a id="__codelineno-6-4" name="__codelineno-6-4" href="#__codelineno-6-4"></a>
<a id="__codelineno-6-5" name="__codelineno-6-5" href="#__codelineno-6-5"></a><span class="w">  </span><span class="nd">@override</span>
<a id="__codelineno-6-6" name="__codelineno-6-6" href="#__codelineno-6-6"></a><span class="w">  </span><span class="kt">void</span><span class="w"> </span><span class="n">initState</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-6-7" name="__codelineno-6-7" href="#__codelineno-6-7"></a><span class="w">    </span><span class="k">super</span><span class="p">.</span><span class="n">initState</span><span class="p">();</span>
<a id="__codelineno-6-8" name="__codelineno-6-8" href="#__codelineno-6-8"></a><span class="w">    </span><span class="n">readJsonFile</span><span class="p">();</span>
<a id="__codelineno-6-9" name="__codelineno-6-9" href="#__codelineno-6-9"></a><span class="w">  </span><span class="p">}</span>
<a id="__codelineno-6-10" name="__codelineno-6-10" href="#__codelineno-6-10"></a>
<a id="__codelineno-6-11" name="__codelineno-6-11" href="#__codelineno-6-11"></a><span class="w">  </span><span class="nd">@override</span>
<a id="__codelineno-6-12" name="__codelineno-6-12" href="#__codelineno-6-12"></a><span class="w">  </span><span class="n">Widget</span><span class="w"> </span><span class="n">build</span><span class="p">(</span><span class="n">BuildContext</span><span class="w"> </span><span class="n">context</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-6-13" name="__codelineno-6-13" href="#__codelineno-6-13"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">Scaffold</span><span class="p">(</span>
<a id="__codelineno-6-14" name="__codelineno-6-14" href="#__codelineno-6-14"></a><span class="w">        </span><span class="nl">appBar:</span><span class="w"> </span><span class="n">AppBar</span><span class="p">(</span><span class="nl">title:</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span><span class="s1">&#39;JSON&#39;</span><span class="p">)),</span>
<a id="__codelineno-6-15" name="__codelineno-6-15" href="#__codelineno-6-15"></a><span class="hll"><span class="w">        </span><span class="nl">body:</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span><span class="n">productsJSONString</span><span class="p">));</span>
</span><a id="__codelineno-6-16" name="__codelineno-6-16" href="#__codelineno-6-16"></a><span class="w">  </span><span class="p">}</span>
<a id="__codelineno-6-17" name="__codelineno-6-17" href="#__codelineno-6-17"></a>
<a id="__codelineno-6-18" name="__codelineno-6-18" href="#__codelineno-6-18"></a><span class="w">  </span><span class="n">Future</span><span class="w"> </span><span class="n">readJsonFile</span><span class="p">()</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-6-19" name="__codelineno-6-19" href="#__codelineno-6-19"></a><span class="w">    </span><span class="kt">String</span><span class="w"> </span><span class="n">jsonString</span><span class="w"> </span><span class="o">=</span>
<a id="__codelineno-6-20" name="__codelineno-6-20" href="#__codelineno-6-20"></a><span class="w">        </span><span class="kd">await</span><span class="w"> </span><span class="n">DefaultAssetBundle</span><span class="p">.</span><span class="n">of</span><span class="p">(</span><span class="n">context</span><span class="p">).</span><span class="n">loadString</span><span class="p">(</span><span class="s1">&#39;assets/products.json&#39;</span><span class="p">);</span>
<a id="__codelineno-6-21" name="__codelineno-6-21" href="#__codelineno-6-21"></a><span class="w">    </span><span class="n">setState</span><span class="p">(()</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-6-22" name="__codelineno-6-22" href="#__codelineno-6-22"></a><span class="w">      </span><span class="n">productsJSONString</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">jsonString</span><span class="p">;</span>
<a id="__codelineno-6-23" name="__codelineno-6-23" href="#__codelineno-6-23"></a><span class="w">    </span><span class="p">});</span>
<a id="__codelineno-6-24" name="__codelineno-6-24" href="#__codelineno-6-24"></a><span class="w">  </span><span class="p">}</span>
<a id="__codelineno-6-25" name="__codelineno-6-25" href="#__codelineno-6-25"></a><span class="p">}</span>
</code></pre></div>
<p>Al ejecutar la aplicación, se muestra el contenido del fichero <code>products.json</code>:</p>
<p><img alt="JSON" src="../assets/ud5_6_1.png" /></p>
<h3 id="modelo-de-datos_1">Modelo de datos<a class="headerlink" href="#modelo-de-datos_1" title="Permanent link">&para;</a></h3>
<p>Para convertir el JSON a objetos de Dart, se crea una clase <code>Product</code> con las propiedades del JSON y un constructor que recibe un <code>Map&lt;String, dynamic&gt;</code> que asigna los valores a las propiedades.</p>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">lib/models/product.dart</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-7-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-7-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-7-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-7-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-7-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-7-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-7-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-7-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-7-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-7-10">10</a></span>
<span class="normal"><a href="#__codelineno-7-11">11</a></span>
<span class="normal"><a href="#__codelineno-7-12">12</a></span>
<span class="normal"><a href="#__codelineno-7-13">13</a></span>
<span class="normal"><a href="#__codelineno-7-14">14</a></span>
<span class="normal"><a href="#__codelineno-7-15">15</a></span>
<span class="normal"><a href="#__codelineno-7-16">16</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-7-1" name="__codelineno-7-1"></a><span class="kd">class</span><span class="w"> </span><span class="nc">Product</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-7-2" name="__codelineno-7-2"></a><span class="w">  </span><span class="kd">final</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">id</span><span class="p">;</span>
<a id="__codelineno-7-3" name="__codelineno-7-3"></a><span class="w">  </span><span class="kd">final</span><span class="w"> </span><span class="kt">String</span><span class="w"> </span><span class="n">description</span><span class="p">;</span>
<a id="__codelineno-7-4" name="__codelineno-7-4"></a><span class="w">  </span><span class="kd">final</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">price</span><span class="p">;</span>
<a id="__codelineno-7-5" name="__codelineno-7-5"></a><span class="w">  </span><span class="kd">final</span><span class="w"> </span><span class="n">DateTime</span><span class="w"> </span><span class="n">available</span><span class="p">;</span>
<a id="__codelineno-7-6" name="__codelineno-7-6"></a><span class="w">  </span><span class="kd">final</span><span class="w"> </span><span class="kt">String</span><span class="w"> </span><span class="n">imageUrl</span><span class="p">;</span>
<a id="__codelineno-7-7" name="__codelineno-7-7"></a><span class="w">  </span><span class="kd">final</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">rating</span><span class="p">;</span>
<a id="__codelineno-7-8" name="__codelineno-7-8"></a>
<a id="__codelineno-7-9" name="__codelineno-7-9"></a><span class="w">  </span><span class="n">Product</span><span class="p">.</span><span class="n">fromJson</span><span class="p">(</span><span class="n">Map</span><span class="o">&lt;</span><span class="kt">String</span><span class="p">,</span><span class="w"> </span><span class="kt">dynamic</span><span class="o">&gt;</span><span class="w"> </span><span class="n">json</span><span class="p">)</span>
<a id="__codelineno-7-10" name="__codelineno-7-10"></a><span class="w">      </span><span class="o">:</span><span class="w"> </span><span class="n">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">json</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="kt">int</span><span class="p">,</span>
<a id="__codelineno-7-11" name="__codelineno-7-11"></a><span class="w">        </span><span class="n">description</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">json</span><span class="p">[</span><span class="s1">&#39;description&#39;</span><span class="p">]</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="kt">String</span><span class="p">,</span>
<a id="__codelineno-7-12" name="__codelineno-7-12"></a><span class="w">        </span><span class="n">price</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">json</span><span class="p">[</span><span class="s1">&#39;price&#39;</span><span class="p">]</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="kt">double</span><span class="p">,</span>
<a id="__codelineno-7-13" name="__codelineno-7-13"></a><span class="w">        </span><span class="n">available</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DateTime</span><span class="p">.</span><span class="n">parse</span><span class="p">(</span><span class="n">json</span><span class="p">[</span><span class="s1">&#39;available&#39;</span><span class="p">]</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="kt">String</span><span class="p">),</span>
<a id="__codelineno-7-14" name="__codelineno-7-14"></a><span class="w">        </span><span class="n">imageUrl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">json</span><span class="p">[</span><span class="s1">&#39;imageUrl&#39;</span><span class="p">]</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="kt">String</span><span class="p">,</span>
<a id="__codelineno-7-15" name="__codelineno-7-15"></a><span class="w">        </span><span class="n">rating</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">json</span><span class="p">[</span><span class="s1">&#39;rating&#39;</span><span class="p">]</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="kt">int</span><span class="p">;</span>
<a id="__codelineno-7-16" name="__codelineno-7-16"></a><span class="p">}</span>
</code></pre></div></td></tr></table></div>
<p>Modificar el método <code>readJsonFile</code> de la clase <code>_ProductsState</code> para convertir el JSON a objetos de Dart. El primer paso es transformar el <code>String</code> a un <code>Map</code> con el método <code>jsonDecode</code> de la librería <code>dart:convert</code>.</p>
<div class="highlight"><span class="filename">lib/main.dart</span><pre><span></span><code><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a><span class="p">...</span>
<a id="__codelineno-8-2" name="__codelineno-8-2" href="#__codelineno-8-2"></a><span class="kd">class</span><span class="w"> </span><span class="nc">_ProductsState</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">State</span><span class="o">&lt;</span><span class="n">Products</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-8-3" name="__codelineno-8-3" href="#__codelineno-8-3"></a><span class="w">  </span><span class="p">...</span>
<a id="__codelineno-8-4" name="__codelineno-8-4" href="#__codelineno-8-4"></a><span class="w">  </span><span class="n">Future</span><span class="w"> </span><span class="n">readJsonFile</span><span class="p">()</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-8-5" name="__codelineno-8-5" href="#__codelineno-8-5"></a><span class="w">    </span><span class="kt">String</span><span class="w"> </span><span class="n">jsonString</span><span class="w"> </span><span class="o">=</span>
<a id="__codelineno-8-6" name="__codelineno-8-6" href="#__codelineno-8-6"></a><span class="w">        </span><span class="kd">await</span><span class="w"> </span><span class="n">DefaultAssetBundle</span><span class="p">.</span><span class="n">of</span><span class="p">(</span><span class="n">context</span><span class="p">).</span><span class="n">loadString</span><span class="p">(</span><span class="s1">&#39;assets/products.json&#39;</span><span class="p">);</span>
<a id="__codelineno-8-7" name="__codelineno-8-7" href="#__codelineno-8-7"></a><span class="hll"><span class="w">    </span><span class="n">List</span><span class="w"> </span><span class="n">jsonList</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">jsonDecode</span><span class="p">(</span><span class="n">jsonString</span><span class="p">);</span>
</span><a id="__codelineno-8-8" name="__codelineno-8-8" href="#__codelineno-8-8"></a><span class="w">    </span><span class="p">...</span>
</code></pre></div>
<p>Debemos asegurarnos que el editor a importado de forma automática la librería <code>dart:convert</code>, además, debemos añadir la clase <code>Product</code> para poder utilizarla.</p>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">lib/main.dart</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-9-1">1</a></span>
<span class="normal"><a href="#__codelineno-9-2">2</a></span>
<span class="normal"><a href="#__codelineno-9-3">3</a></span>
<span class="normal"><a href="#__codelineno-9-4">4</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-9-1" name="__codelineno-9-1"></a><span class="k">import</span><span class="w"> </span><span class="s1">&#39;package:flutter/material.dart&#39;</span><span class="p">;</span>
<a id="__codelineno-9-2" name="__codelineno-9-2"></a>
<a id="__codelineno-9-3" name="__codelineno-9-3"></a><span class="hll"><span class="k">import</span><span class="w"> </span><span class="s1">&#39;dart:convert&#39;</span><span class="p">;</span>
</span><a id="__codelineno-9-4" name="__codelineno-9-4"></a><span class="hll"><span class="k">import</span><span class="w"> </span><span class="s1">&#39;./models/product.dart&#39;</span><span class="p">;</span>
</span></code></pre></div></td></tr></table></div>
<p>El último paso es convertir el JSON a <code>List</code>. Se puede hacer con un bucle <code>for</code> y transformar cada elemento del <code>List</code> a un objeto de tipo <code>Product</code> con el constructor <code>fromJson</code>. En el método <code>readJsonFile</code> de la clase <code>_ProductsState</code> añadir el siguiente código:</p>
<div class="highlight"><span class="filename">lib/main.dart</span><pre><span></span><code><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a><span class="p">...</span>
<a id="__codelineno-10-2" name="__codelineno-10-2" href="#__codelineno-10-2"></a><span class="w">    </span><span class="n">List</span><span class="w"> </span><span class="n">jsonList</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">jsonDecode</span><span class="p">(</span><span class="n">jsonString</span><span class="p">);</span>
<a id="__codelineno-10-3" name="__codelineno-10-3" href="#__codelineno-10-3"></a>
<a id="__codelineno-10-4" name="__codelineno-10-4" href="#__codelineno-10-4"></a><span class="hll"><span class="w">    </span><span class="n">List</span><span class="o">&lt;</span><span class="n">Product</span><span class="o">&gt;</span><span class="w"> </span><span class="n">products</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[];</span>
</span><a id="__codelineno-10-5" name="__codelineno-10-5" href="#__codelineno-10-5"></a><span class="hll"><span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kd">var</span><span class="w"> </span><span class="n">item</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">jsonList</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><a id="__codelineno-10-6" name="__codelineno-10-6" href="#__codelineno-10-6"></a><span class="hll"><span class="w">      </span><span class="n">Product</span><span class="w"> </span><span class="n">product</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Product</span><span class="p">.</span><span class="n">fromJson</span><span class="p">(</span><span class="n">item</span><span class="p">);</span>
</span><a id="__codelineno-10-7" name="__codelineno-10-7" href="#__codelineno-10-7"></a><span class="hll"><span class="w">      </span><span class="n">products</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">product</span><span class="p">);</span>
</span><a id="__codelineno-10-8" name="__codelineno-10-8" href="#__codelineno-10-8"></a><span class="hll"><span class="w">    </span><span class="p">}</span>
</span><a id="__codelineno-10-9" name="__codelineno-10-9" href="#__codelineno-10-9"></a><span class="p">...</span>
</code></pre></div>
<p>Ahora se puede eliminar (o comentar) el <code>setState</code> y devolver la lista de productos en su lugar, además de cambiar el tipo de retorno del método a <code>List&lt;Product&gt;</code>.</p>
<div class="highlight"><span class="filename">lib/main.dart</span><pre><span></span><code><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a><span class="p">...</span>
<a id="__codelineno-11-2" name="__codelineno-11-2" href="#__codelineno-11-2"></a><span class="hll"><span class="w">  </span><span class="n">Future</span><span class="o">&lt;</span><span class="n">List</span><span class="o">&lt;</span><span class="n">Product</span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">readJsonFile</span><span class="p">()</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="p">{</span>
</span><a id="__codelineno-11-3" name="__codelineno-11-3" href="#__codelineno-11-3"></a><span class="w">    </span><span class="kt">String</span><span class="w"> </span><span class="n">jsonString</span><span class="w"> </span><span class="o">=</span>
<a id="__codelineno-11-4" name="__codelineno-11-4" href="#__codelineno-11-4"></a><span class="w">        </span><span class="kd">await</span><span class="w"> </span><span class="n">DefaultAssetBundle</span><span class="p">.</span><span class="n">of</span><span class="p">(</span><span class="n">context</span><span class="p">).</span><span class="n">loadString</span><span class="p">(</span><span class="s1">&#39;assets/products.json&#39;</span><span class="p">);</span>
<a id="__codelineno-11-5" name="__codelineno-11-5" href="#__codelineno-11-5"></a>
<a id="__codelineno-11-6" name="__codelineno-11-6" href="#__codelineno-11-6"></a><span class="w">    </span><span class="n">List</span><span class="w"> </span><span class="n">jsonList</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">jsonDecode</span><span class="p">(</span><span class="n">jsonString</span><span class="p">);</span>
<a id="__codelineno-11-7" name="__codelineno-11-7" href="#__codelineno-11-7"></a>
<a id="__codelineno-11-8" name="__codelineno-11-8" href="#__codelineno-11-8"></a><span class="w">    </span><span class="n">List</span><span class="o">&lt;</span><span class="n">Product</span><span class="o">&gt;</span><span class="w"> </span><span class="n">products</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[];</span>
<a id="__codelineno-11-9" name="__codelineno-11-9" href="#__codelineno-11-9"></a><span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kd">var</span><span class="w"> </span><span class="n">item</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">jsonList</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-11-10" name="__codelineno-11-10" href="#__codelineno-11-10"></a><span class="w">      </span><span class="n">Product</span><span class="w"> </span><span class="n">product</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Product</span><span class="p">.</span><span class="n">fromJson</span><span class="p">(</span><span class="n">item</span><span class="p">);</span>
<a id="__codelineno-11-11" name="__codelineno-11-11" href="#__codelineno-11-11"></a><span class="w">      </span><span class="n">products</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">product</span><span class="p">);</span>
<a id="__codelineno-11-12" name="__codelineno-11-12" href="#__codelineno-11-12"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-11-13" name="__codelineno-11-13" href="#__codelineno-11-13"></a>
<a id="__codelineno-11-14" name="__codelineno-11-14" href="#__codelineno-11-14"></a><span class="hll"><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">products</span><span class="p">;</span>
</span><a id="__codelineno-11-15" name="__codelineno-11-15" href="#__codelineno-11-15"></a><span class="w">  </span><span class="p">}</span>
<a id="__codelineno-11-16" name="__codelineno-11-16" href="#__codelineno-11-16"></a><span class="p">...</span>
</code></pre></div>
<h3 id="mostrar-los-productos">Mostrar los productos<a class="headerlink" href="#mostrar-los-productos" title="Permanent link">&para;</a></h3>
<p>Ahora que se obtiene la lista de productos, en lugar de mostrar el texto, se pueden representar los productos en una lista. Para ello, se utiliza un <code>ListView</code> con un <code>ListTile</code> para cada producto. En la clase <code>_ProductsState</code> se añade un <code>List&lt;Product&gt;</code> llamado <code>products</code>:</p>
<div class="highlight"><span class="filename">lib/main.dart</span><pre><span></span><code><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a><span class="p">...</span>
<a id="__codelineno-12-2" name="__codelineno-12-2" href="#__codelineno-12-2"></a><span class="kd">class</span><span class="w"> </span><span class="nc">_ProductsState</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">State</span><span class="o">&lt;</span><span class="n">Products</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-12-3" name="__codelineno-12-3" href="#__codelineno-12-3"></a><span class="hll"><span class="w">  </span><span class="n">List</span><span class="o">&lt;</span><span class="n">Product</span><span class="o">&gt;</span><span class="w"> </span><span class="n">products</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[];</span>
</span><a id="__codelineno-12-4" name="__codelineno-12-4" href="#__codelineno-12-4"></a><span class="w">  </span><span class="p">...</span>
</code></pre></div>
<p>En el método <code>initState</code> se llama al método <code>readJsonFile</code> y se asigna el resultado a <code>products</code>:</p>
<div class="highlight"><span class="filename">lib/main.dart</span><pre><span></span><code><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a><span class="p">...</span>
<a id="__codelineno-13-2" name="__codelineno-13-2" href="#__codelineno-13-2"></a><span class="w">  </span><span class="nd">@override</span>
<a id="__codelineno-13-3" name="__codelineno-13-3" href="#__codelineno-13-3"></a><span class="w">  </span><span class="kt">void</span><span class="w"> </span><span class="n">initState</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-13-4" name="__codelineno-13-4" href="#__codelineno-13-4"></a><span class="w">    </span><span class="k">super</span><span class="p">.</span><span class="n">initState</span><span class="p">();</span>
<a id="__codelineno-13-5" name="__codelineno-13-5" href="#__codelineno-13-5"></a><span class="hll"><span class="w">    </span><span class="n">readJsonFile</span><span class="p">().</span><span class="n">then</span><span class="p">((</span><span class="n">value</span><span class="p">)</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="p">{</span>
</span><a id="__codelineno-13-6" name="__codelineno-13-6" href="#__codelineno-13-6"></a><span class="hll"><span class="w">          </span><span class="n">setState</span><span class="p">(()</span><span class="w"> </span><span class="p">{</span>
</span><a id="__codelineno-13-7" name="__codelineno-13-7" href="#__codelineno-13-7"></a><span class="hll"><span class="w">            </span><span class="n">products</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">value</span><span class="p">;</span>
</span><a id="__codelineno-13-8" name="__codelineno-13-8" href="#__codelineno-13-8"></a><span class="hll"><span class="w">          </span><span class="p">})</span>
</span><a id="__codelineno-13-9" name="__codelineno-13-9" href="#__codelineno-13-9"></a><span class="hll"><span class="w">        </span><span class="p">});</span>
</span><a id="__codelineno-13-10" name="__codelineno-13-10" href="#__codelineno-13-10"></a><span class="w">  </span><span class="p">}</span>
<a id="__codelineno-13-11" name="__codelineno-13-11" href="#__codelineno-13-11"></a><span class="p">...</span>
</code></pre></div>
<p>En el <code>body</code> del <code>Scaffold</code> se añade un <code>ListView</code> con un <code>ListTile</code> para cada producto:</p>
<div class="highlight"><span class="filename">lib/main.dart</span><pre><span></span><code><a id="__codelineno-14-1" name="__codelineno-14-1" href="#__codelineno-14-1"></a><span class="p">...</span>
<a id="__codelineno-14-2" name="__codelineno-14-2" href="#__codelineno-14-2"></a><span class="w">  </span><span class="nd">@override</span>
<a id="__codelineno-14-3" name="__codelineno-14-3" href="#__codelineno-14-3"></a><span class="w">  </span><span class="n">Widget</span><span class="w"> </span><span class="n">build</span><span class="p">(</span><span class="n">BuildContext</span><span class="w"> </span><span class="n">context</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-14-4" name="__codelineno-14-4" href="#__codelineno-14-4"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">Scaffold</span><span class="p">(</span>
<a id="__codelineno-14-5" name="__codelineno-14-5" href="#__codelineno-14-5"></a><span class="w">        </span><span class="nl">appBar:</span><span class="w"> </span><span class="n">AppBar</span><span class="p">(</span><span class="nl">title:</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span><span class="s1">&#39;JSON&#39;</span><span class="p">)),</span>
<a id="__codelineno-14-6" name="__codelineno-14-6" href="#__codelineno-14-6"></a><span class="hll"><span class="w">        </span><span class="nl">body:</span><span class="w"> </span><span class="n">ListView</span><span class="p">.</span><span class="n">builder</span><span class="p">(</span>
</span><a id="__codelineno-14-7" name="__codelineno-14-7" href="#__codelineno-14-7"></a><span class="hll"><span class="w">          </span><span class="nl">itemCount:</span><span class="w"> </span><span class="n">products</span><span class="p">.</span><span class="n">length</span><span class="p">,</span>
</span><a id="__codelineno-14-8" name="__codelineno-14-8" href="#__codelineno-14-8"></a><span class="hll"><span class="w">          </span><span class="nl">itemBuilder:</span><span class="w"> </span><span class="p">(</span><span class="n">context</span><span class="p">,</span><span class="w"> </span><span class="n">index</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><a id="__codelineno-14-9" name="__codelineno-14-9" href="#__codelineno-14-9"></a><span class="hll"><span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">ListTile</span><span class="p">(</span>
</span><a id="__codelineno-14-10" name="__codelineno-14-10" href="#__codelineno-14-10"></a><span class="hll"><span class="w">              </span><span class="nl">leading:</span><span class="w"> </span><span class="n">Image</span><span class="p">.</span><span class="n">network</span><span class="p">(</span><span class="n">products</span><span class="p">[</span><span class="n">index</span><span class="p">].</span><span class="n">imageUrl</span><span class="p">),</span>
</span><a id="__codelineno-14-11" name="__codelineno-14-11" href="#__codelineno-14-11"></a><span class="hll"><span class="w">              </span><span class="nl">title:</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span><span class="n">products</span><span class="p">[</span><span class="n">index</span><span class="p">].</span><span class="n">description</span><span class="p">),</span>
</span><a id="__codelineno-14-12" name="__codelineno-14-12" href="#__codelineno-14-12"></a><span class="hll"><span class="w">              </span><span class="nl">subtitle:</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span><span class="n">products</span><span class="p">[</span><span class="n">index</span><span class="p">].</span><span class="n">price</span><span class="p">.</span><span class="n">toString</span><span class="p">()),</span>
</span><a id="__codelineno-14-13" name="__codelineno-14-13" href="#__codelineno-14-13"></a><span class="hll"><span class="w">              </span><span class="nl">trailing:</span><span class="w"> </span><span class="n">Row</span><span class="p">(</span>
</span><a id="__codelineno-14-14" name="__codelineno-14-14" href="#__codelineno-14-14"></a><span class="hll"><span class="w">                </span><span class="nl">mainAxisSize:</span><span class="w"> </span><span class="n">MainAxisSize</span><span class="p">.</span><span class="n">min</span><span class="p">,</span>
</span><a id="__codelineno-14-15" name="__codelineno-14-15" href="#__codelineno-14-15"></a><span class="hll"><span class="w">                </span><span class="nl">children:</span><span class="w"> </span><span class="p">[</span>
</span><a id="__codelineno-14-16" name="__codelineno-14-16" href="#__codelineno-14-16"></a><span class="hll"><span class="w">                  </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kd">var</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">products</span><span class="p">[</span><span class="n">index</span><span class="p">].</span><span class="n">rating</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span>
</span><a id="__codelineno-14-17" name="__codelineno-14-17" href="#__codelineno-14-17"></a><span class="hll"><span class="w">                    </span><span class="k">const</span><span class="w"> </span><span class="n">Icon</span><span class="p">(</span><span class="n">Icons</span><span class="p">.</span><span class="n">star</span><span class="p">,</span><span class="w"> </span><span class="nl">color:</span><span class="w"> </span><span class="n">Colors</span><span class="p">.</span><span class="n">amber</span><span class="p">,</span><span class="w"> </span><span class="nl">size:</span><span class="w"> </span><span class="m">14</span><span class="p">),</span>
</span><a id="__codelineno-14-18" name="__codelineno-14-18" href="#__codelineno-14-18"></a><span class="hll"><span class="w">                  </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kd">var</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="m">5</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">products</span><span class="p">[</span><span class="n">index</span><span class="p">].</span><span class="n">rating</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span>
</span><a id="__codelineno-14-19" name="__codelineno-14-19" href="#__codelineno-14-19"></a><span class="hll"><span class="w">                    </span><span class="k">const</span><span class="w"> </span><span class="n">Icon</span><span class="p">(</span><span class="n">Icons</span><span class="p">.</span><span class="n">star</span><span class="p">,</span><span class="w"> </span><span class="nl">color:</span><span class="w"> </span><span class="n">Colors</span><span class="p">.</span><span class="n">grey</span><span class="p">,</span><span class="w"> </span><span class="nl">size:</span><span class="w"> </span><span class="m">14</span><span class="p">),</span>
</span><a id="__codelineno-14-20" name="__codelineno-14-20" href="#__codelineno-14-20"></a><span class="hll"><span class="w">                </span><span class="p">],</span>
</span><a id="__codelineno-14-21" name="__codelineno-14-21" href="#__codelineno-14-21"></a><span class="hll"><span class="w">              </span><span class="p">),</span>
</span><a id="__codelineno-14-22" name="__codelineno-14-22" href="#__codelineno-14-22"></a><span class="hll"><span class="w">            </span><span class="p">);</span>
</span><a id="__codelineno-14-23" name="__codelineno-14-23" href="#__codelineno-14-23"></a><span class="hll"><span class="w">          </span><span class="p">},</span>
</span><a id="__codelineno-14-24" name="__codelineno-14-24" href="#__codelineno-14-24"></a><span class="hll"><span class="w">        </span><span class="p">));</span>
</span><a id="__codelineno-14-25" name="__codelineno-14-25" href="#__codelineno-14-25"></a><span class="w">  </span><span class="p">}</span>
<a id="__codelineno-14-26" name="__codelineno-14-26" href="#__codelineno-14-26"></a><span class="p">...</span>
</code></pre></div>
<p><img alt="ListView" src="../assets/ud5_6_2.png" /></p>
<h2 id="convertir-objetos-a-json">Convertir objetos a JSON<a class="headerlink" href="#convertir-objetos-a-json" title="Permanent link">&para;</a></h2>
<p>La operación más común es deserializar un JSON a un objeto de Dart, pero también es posible convertir un objeto de Dart a JSON. Para ello, se utiliza el método <code>toJson</code> de la clase <code>Product</code>.</p>
<div class="highlight"><span class="filename">lib/models/product.dart</span><pre><span></span><code><a id="__codelineno-15-1" name="__codelineno-15-1" href="#__codelineno-15-1"></a><span class="hll"><span class="kd">class</span><span class="w"> </span><span class="nc">Product</span><span class="w"> </span><span class="p">{</span>
</span><a id="__codelineno-15-2" name="__codelineno-15-2" href="#__codelineno-15-2"></a><span class="hll"><span class="w">  </span><span class="p">...</span>
</span><a id="__codelineno-15-3" name="__codelineno-15-3" href="#__codelineno-15-3"></a><span class="w">  </span><span class="n">Map</span><span class="o">&lt;</span><span class="kt">String</span><span class="p">,</span><span class="w"> </span><span class="kt">dynamic</span><span class="o">&gt;</span><span class="w"> </span><span class="n">toJson</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-15-4" name="__codelineno-15-4" href="#__codelineno-15-4"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-15-5" name="__codelineno-15-5" href="#__codelineno-15-5"></a><span class="w">        </span><span class="s1">&#39;id&#39;</span><span class="o">:</span><span class="w"> </span><span class="n">id</span><span class="p">,</span>
<a id="__codelineno-15-6" name="__codelineno-15-6" href="#__codelineno-15-6"></a><span class="w">        </span><span class="s1">&#39;description&#39;</span><span class="o">:</span><span class="w"> </span><span class="n">description</span><span class="p">,</span>
<a id="__codelineno-15-7" name="__codelineno-15-7" href="#__codelineno-15-7"></a><span class="w">        </span><span class="s1">&#39;price&#39;</span><span class="o">:</span><span class="w"> </span><span class="n">price</span><span class="p">,</span>
<a id="__codelineno-15-8" name="__codelineno-15-8" href="#__codelineno-15-8"></a><span class="w">        </span><span class="s1">&#39;available&#39;</span><span class="o">:</span><span class="w"> </span><span class="n">available</span><span class="p">.</span><span class="n">toIso8601String</span><span class="p">(),</span>
<a id="__codelineno-15-9" name="__codelineno-15-9" href="#__codelineno-15-9"></a><span class="w">        </span><span class="s1">&#39;imageUrl&#39;</span><span class="o">:</span><span class="w"> </span><span class="n">imageUrl</span><span class="p">,</span>
<a id="__codelineno-15-10" name="__codelineno-15-10" href="#__codelineno-15-10"></a><span class="w">        </span><span class="s1">&#39;rating&#39;</span><span class="o">:</span><span class="w"> </span><span class="n">rating</span>
<a id="__codelineno-15-11" name="__codelineno-15-11" href="#__codelineno-15-11"></a><span class="w">    </span><span class="p">};</span>
<a id="__codelineno-15-12" name="__codelineno-15-12" href="#__codelineno-15-12"></a><span class="w">  </span><span class="p">}</span>
<a id="__codelineno-15-13" name="__codelineno-15-13" href="#__codelineno-15-13"></a><span class="p">}</span>
</code></pre></div>
<p>Para convertir la lista de productos a JSON, se podría utilizar el siguiente código:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-16-1" name="__codelineno-16-1" href="#__codelineno-16-1"></a><span class="kt">String</span><span class="w"> </span><span class="n">convertToJSON</span><span class="p">(</span><span class="n">List</span><span class="o">&lt;</span><span class="n">Product</span><span class="o">&gt;</span><span class="w"> </span><span class="n">products</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-16-2" name="__codelineno-16-2" href="#__codelineno-16-2"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">jsonEncode</span><span class="p">(</span><span class="n">products</span><span class="p">);</span>
<a id="__codelineno-16-3" name="__codelineno-16-3" href="#__codelineno-16-3"></a><span class="p">}</span>
</code></pre></div>
<h2 id="solucionar-problemas-tipicos-con-json">Solucionar problemas típicos con JSON<a class="headerlink" href="#solucionar-problemas-tipicos-con-json" title="Permanent link">&para;</a></h2>
<p>En el ejemplo todo funciona correctamente, pero en una aplicación real, es posible que el JSON no tenga el formato correcto o que falten propiedades.</p>
<ul>
<li>Una propiedad puede que no tenga el tipo correcto, por ejemplo, se espera un <code>int</code> pero se recibe un <code>String</code> o se necesita un <code>double</code> pero se recibe un <code>int</code>.</li>
</ul>
<div class="highlight"><span class="filename">lib/models/product.dart</span><pre><span></span><code><a id="__codelineno-17-1" name="__codelineno-17-1" href="#__codelineno-17-1"></a><span class="w">  </span><span class="n">Product</span><span class="p">.</span><span class="n">fromJson</span><span class="p">(</span><span class="n">Map</span><span class="o">&lt;</span><span class="kt">String</span><span class="p">,</span><span class="w"> </span><span class="kt">dynamic</span><span class="o">&gt;</span><span class="w"> </span><span class="n">json</span><span class="p">)</span>
<a id="__codelineno-17-2" name="__codelineno-17-2" href="#__codelineno-17-2"></a><span class="hll"><span class="w">      </span><span class="o">:</span><span class="w"> </span><span class="n">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kt">int</span><span class="p">.</span><span class="n">tryParse</span><span class="p">(</span><span class="n">json</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">])</span><span class="w"> </span><span class="o">??</span><span class="w"> </span><span class="m">0</span><span class="p">,</span>
</span><a id="__codelineno-17-3" name="__codelineno-17-3" href="#__codelineno-17-3"></a><span class="w">        </span><span class="n">description</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">json</span><span class="p">[</span><span class="s1">&#39;description&#39;</span><span class="p">],</span>
<a id="__codelineno-17-4" name="__codelineno-17-4" href="#__codelineno-17-4"></a><span class="hll"><span class="w">        </span><span class="n">price</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kt">double</span><span class="p">.</span><span class="n">tryParse</span><span class="p">(</span><span class="n">json</span><span class="p">[</span><span class="s1">&#39;price&#39;</span><span class="p">])</span><span class="w"> </span><span class="o">??</span><span class="w"> </span><span class="m">0</span><span class="p">,</span>
</span><a id="__codelineno-17-5" name="__codelineno-17-5" href="#__codelineno-17-5"></a><span class="w">        </span><span class="n">available</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DateTime</span><span class="p">.</span><span class="n">parse</span><span class="p">(</span><span class="n">json</span><span class="p">[</span><span class="s1">&#39;available&#39;</span><span class="p">]),</span>
<a id="__codelineno-17-6" name="__codelineno-17-6" href="#__codelineno-17-6"></a><span class="w">        </span><span class="n">imageUrl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">json</span><span class="p">[</span><span class="s1">&#39;imageUrl&#39;</span><span class="p">],</span>
<a id="__codelineno-17-7" name="__codelineno-17-7" href="#__codelineno-17-7"></a><span class="w">        </span><span class="n">rating</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">json</span><span class="p">[</span><span class="s1">&#39;rating&#39;</span><span class="p">];</span>
<a id="__codelineno-17-8" name="__codelineno-17-8" href="#__codelineno-17-8"></a><span class="p">}</span>
</code></pre></div>
<ul>
<li>Una propiedad puede ser opcional, por lo que no siempre se va a recibir. En este caso, se puede utilizar el operador <code>??</code> para asignar un valor por defecto.</li>
</ul>
<div class="highlight"><span class="filename">lib/models/product.dart</span><pre><span></span><code><a id="__codelineno-18-1" name="__codelineno-18-1" href="#__codelineno-18-1"></a><span class="w">  </span><span class="n">Product</span><span class="p">.</span><span class="n">fromJson</span><span class="p">(</span><span class="n">Map</span><span class="o">&lt;</span><span class="kt">String</span><span class="p">,</span><span class="w"> </span><span class="kt">dynamic</span><span class="o">&gt;</span><span class="w"> </span><span class="n">json</span><span class="p">)</span>
<a id="__codelineno-18-2" name="__codelineno-18-2" href="#__codelineno-18-2"></a><span class="w">      </span><span class="o">:</span><span class="w"> </span><span class="n">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">json</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="kt">int</span><span class="p">,</span>
<a id="__codelineno-18-3" name="__codelineno-18-3" href="#__codelineno-18-3"></a><span class="w">        </span><span class="n">description</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">json</span><span class="p">[</span><span class="s1">&#39;description&#39;</span><span class="p">],</span>
<a id="__codelineno-18-4" name="__codelineno-18-4" href="#__codelineno-18-4"></a><span class="w">        </span><span class="n">price</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">json</span><span class="p">[</span><span class="s1">&#39;price&#39;</span><span class="p">],</span>
<a id="__codelineno-18-5" name="__codelineno-18-5" href="#__codelineno-18-5"></a><span class="w">        </span><span class="n">available</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DateTime</span><span class="p">.</span><span class="n">parse</span><span class="p">(</span><span class="n">json</span><span class="p">[</span><span class="s1">&#39;available&#39;</span><span class="p">]),</span>
<a id="__codelineno-18-6" name="__codelineno-18-6" href="#__codelineno-18-6"></a><span class="hll"><span class="w">        </span><span class="n">imageUrl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">json</span><span class="p">[</span><span class="s1">&#39;imageUrl&#39;</span><span class="p">]</span><span class="w"> </span><span class="o">??</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="p">,</span>
</span><a id="__codelineno-18-7" name="__codelineno-18-7" href="#__codelineno-18-7"></a><span class="hll"><span class="w">        </span><span class="n">rating</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kt">int</span><span class="p">.</span><span class="n">tryParse</span><span class="p">(</span><span class="n">json</span><span class="p">[</span><span class="s1">&#39;rating&#39;</span><span class="p">])</span><span class="w"> </span><span class="o">??</span><span class="w"> </span><span class="m">0</span><span class="p">;</span>
</span><a id="__codelineno-18-8" name="__codelineno-18-8" href="#__codelineno-18-8"></a><span class="p">}</span>
</code></pre></div>
<ul>
<li>Una buena práctica es añadir el método <code>toString</code> en los valores que se esperan como <code>String</code> para evitar errores.</li>
</ul>
<div class="highlight"><span class="filename">lib/models/product.dart</span><pre><span></span><code><a id="__codelineno-19-1" name="__codelineno-19-1" href="#__codelineno-19-1"></a><span class="w">  </span><span class="n">Product</span><span class="p">.</span><span class="n">fromJson</span><span class="p">(</span><span class="n">Map</span><span class="o">&lt;</span><span class="kt">String</span><span class="p">,</span><span class="w"> </span><span class="kt">dynamic</span><span class="o">&gt;</span><span class="w"> </span><span class="n">json</span><span class="p">)</span>
<a id="__codelineno-19-2" name="__codelineno-19-2" href="#__codelineno-19-2"></a><span class="w">      </span><span class="o">:</span><span class="w"> </span><span class="n">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">json</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">],</span>
<a id="__codelineno-19-3" name="__codelineno-19-3" href="#__codelineno-19-3"></a><span class="hll"><span class="w">        </span><span class="n">description</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">json</span><span class="p">[</span><span class="s1">&#39;description&#39;</span><span class="p">].</span><span class="n">toString</span><span class="p">(),</span>
</span><a id="__codelineno-19-4" name="__codelineno-19-4" href="#__codelineno-19-4"></a><span class="w">        </span><span class="n">price</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">json</span><span class="p">[</span><span class="s1">&#39;price&#39;</span><span class="p">],</span>
<a id="__codelineno-19-5" name="__codelineno-19-5" href="#__codelineno-19-5"></a><span class="hll"><span class="w">        </span><span class="n">available</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DateTime</span><span class="p">.</span><span class="n">parse</span><span class="p">(</span><span class="n">json</span><span class="p">[</span><span class="s1">&#39;available&#39;</span><span class="p">].</span><span class="n">toString</span><span class="p">()),</span>
</span><a id="__codelineno-19-6" name="__codelineno-19-6" href="#__codelineno-19-6"></a><span class="hll"><span class="w">        </span><span class="n">imageUrl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">json</span><span class="p">[</span><span class="s1">&#39;imageUrl&#39;</span><span class="p">].</span><span class="n">toString</span><span class="p">(),</span>
</span><a id="__codelineno-19-7" name="__codelineno-19-7" href="#__codelineno-19-7"></a><span class="w">        </span><span class="n">rating</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kt">int</span><span class="p">.</span><span class="n">tryParse</span><span class="p">(</span><span class="n">json</span><span class="p">[</span><span class="s1">&#39;rating&#39;</span><span class="p">]);</span>
<a id="__codelineno-19-8" name="__codelineno-19-8" href="#__codelineno-19-8"></a><span class="p">}</span>
</code></pre></div>
<ul>
<li>Para evitar que aparezca <code>null</code> en la vista se puede comprobar si el valor y mostrar un valor por defecto.</li>
</ul>
<div class="highlight"><span class="filename">lib/models/product.dart</span><pre><span></span><code><a id="__codelineno-20-1" name="__codelineno-20-1" href="#__codelineno-20-1"></a><span class="w">  </span><span class="n">Product</span><span class="p">.</span><span class="n">fromJson</span><span class="p">(</span><span class="n">Map</span><span class="o">&lt;</span><span class="kt">String</span><span class="p">,</span><span class="w"> </span><span class="kt">dynamic</span><span class="o">&gt;</span><span class="w"> </span><span class="n">json</span><span class="p">)</span>
<a id="__codelineno-20-2" name="__codelineno-20-2" href="#__codelineno-20-2"></a><span class="w">      </span><span class="o">:</span><span class="w"> </span><span class="n">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kt">int</span><span class="p">.</span><span class="n">tryParse</span><span class="p">(</span><span class="n">json</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">].</span><span class="n">toString</span><span class="p">())</span><span class="w"> </span><span class="o">??</span><span class="w"> </span><span class="m">0</span><span class="p">,</span>
<a id="__codelineno-20-3" name="__codelineno-20-3" href="#__codelineno-20-3"></a><span class="hll"><span class="w">        </span><span class="n">description</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">json</span><span class="p">[</span><span class="s1">&#39;description&#39;</span><span class="p">]</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">null</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="n">json</span><span class="p">[</span><span class="s1">&#39;description&#39;</span><span class="p">].</span><span class="n">toString</span><span class="p">()</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Sin descripción&#39;</span><span class="p">,</span>
</span><a id="__codelineno-20-4" name="__codelineno-20-4" href="#__codelineno-20-4"></a><span class="w">        </span><span class="n">price</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kt">double</span><span class="p">.</span><span class="n">tryParse</span><span class="p">(</span><span class="n">json</span><span class="p">[</span><span class="s1">&#39;price&#39;</span><span class="p">]).</span><span class="n">toString</span><span class="p">()</span><span class="w"> </span><span class="o">??</span><span class="w"> </span><span class="m">0</span><span class="p">,</span>
<a id="__codelineno-20-5" name="__codelineno-20-5" href="#__codelineno-20-5"></a><span class="w">        </span><span class="n">available</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">json</span><span class="p">[</span><span class="s1">&#39;available&#39;</span><span class="p">]</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">null</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="n">DateTime</span><span class="p">.</span><span class="n">parse</span><span class="p">(</span><span class="n">json</span><span class="p">[</span><span class="s1">&#39;available&#39;</span><span class="p">].</span><span class="n">toString</span><span class="p">())</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">DateTime</span><span class="p">.</span><span class="n">now</span><span class="p">(),</span>
<a id="__codelineno-20-6" name="__codelineno-20-6" href="#__codelineno-20-6"></a><span class="w">        </span><span class="n">imageUrl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">json</span><span class="p">[</span><span class="s1">&#39;imageUrl&#39;</span><span class="p">]</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">null</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="n">json</span><span class="p">[</span><span class="s1">&#39;imageUrl&#39;</span><span class="p">].</span><span class="n">toString</span><span class="p">()</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="p">,</span>
<a id="__codelineno-20-7" name="__codelineno-20-7" href="#__codelineno-20-7"></a><span class="w">        </span><span class="n">rating</span><span class="w"> </span><span class="o">=</span><span class="kt">int</span><span class="p">.</span><span class="n">tryParse</span><span class="p">(</span><span class="n">json</span><span class="p">[</span><span class="s1">&#39;rating&#39;</span><span class="p">].</span><span class="n">toString</span><span class="p">())</span><span class="w"> </span><span class="o">??</span><span class="w"> </span><span class="m">0</span><span class="p">;</span>
<a id="__codelineno-20-8" name="__codelineno-20-8" href="#__codelineno-20-8"></a><span class="p">}</span>
</code></pre></div>
<h2 id="claves-de-las-propiedades">Claves de las propiedades<a class="headerlink" href="#claves-de-las-propiedades" title="Permanent link">&para;</a></h2>
<p>Durante el desarrollo de una aplicación, es posible que se cambie el nombre de una propiedad o que se añadan nuevas propiedades. En este caso, el JSON no se va a poder convertir a objetos de Dart, ya que no se van a encontrar las propiedades.</p>
<p>Una solución es utilizar constantes para almacenar las claves de las propiedades. De esta forma, si se cambia el nombre de una propiedad, solo hay que cambiar el valor de la constante.</p>
<p>En la clase <code>Product</code> se añaden las constantes:</p>
<div class="highlight"><span class="filename">lib/models/product.dart</span><pre><span></span><code><a id="__codelineno-21-1" name="__codelineno-21-1" href="#__codelineno-21-1"></a><span class="kd">class</span><span class="w"> </span><span class="nc">Product</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-21-2" name="__codelineno-21-2" href="#__codelineno-21-2"></a><span class="w">  </span><span class="kd">static</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="kt">String</span><span class="w"> </span><span class="n">idKey</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;id&#39;</span><span class="p">;</span>
<a id="__codelineno-21-3" name="__codelineno-21-3" href="#__codelineno-21-3"></a><span class="w">  </span><span class="kd">static</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="kt">String</span><span class="w"> </span><span class="n">descriptionKey</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;description&#39;</span><span class="p">;</span>
<a id="__codelineno-21-4" name="__codelineno-21-4" href="#__codelineno-21-4"></a><span class="w">  </span><span class="kd">static</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="kt">String</span><span class="w"> </span><span class="n">priceKey</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;price&#39;</span><span class="p">;</span>
<a id="__codelineno-21-5" name="__codelineno-21-5" href="#__codelineno-21-5"></a><span class="w">  </span><span class="kd">static</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="kt">String</span><span class="w"> </span><span class="n">availableKey</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;available&#39;</span><span class="p">;</span>
<a id="__codelineno-21-6" name="__codelineno-21-6" href="#__codelineno-21-6"></a><span class="w">  </span><span class="kd">static</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="kt">String</span><span class="w"> </span><span class="n">imageUrlKey</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;imageUrl&#39;</span><span class="p">;</span>
<a id="__codelineno-21-7" name="__codelineno-21-7" href="#__codelineno-21-7"></a><span class="w">  </span><span class="kd">static</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="kt">String</span><span class="w"> </span><span class="n">ratingKey</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;rating&#39;</span><span class="p">;</span>
<a id="__codelineno-21-8" name="__codelineno-21-8" href="#__codelineno-21-8"></a>
<a id="__codelineno-21-9" name="__codelineno-21-9" href="#__codelineno-21-9"></a><span class="w">  </span><span class="p">...</span>
</code></pre></div>
<p>Y en el constructor se utilizan las constantes:</p>
<div class="highlight"><span class="filename">lib/models/product.dart</span><pre><span></span><code><a id="__codelineno-22-1" name="__codelineno-22-1" href="#__codelineno-22-1"></a><span class="w">  </span><span class="n">Product</span><span class="p">.</span><span class="n">fromJson</span><span class="p">(</span><span class="n">Map</span><span class="o">&lt;</span><span class="kt">String</span><span class="p">,</span><span class="w"> </span><span class="kt">dynamic</span><span class="o">&gt;</span><span class="w"> </span><span class="n">json</span><span class="p">)</span>
<a id="__codelineno-22-2" name="__codelineno-22-2" href="#__codelineno-22-2"></a><span class="w">      </span><span class="o">:</span><span class="w"> </span><span class="n">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kt">int</span><span class="p">.</span><span class="n">tryParse</span><span class="p">(</span><span class="n">json</span><span class="p">[</span><span class="n">idKey</span><span class="p">].</span><span class="n">toString</span><span class="p">())</span><span class="w"> </span><span class="o">??</span><span class="w"> </span><span class="m">0</span><span class="p">,</span>
<a id="__codelineno-22-3" name="__codelineno-22-3" href="#__codelineno-22-3"></a><span class="w">        </span><span class="n">description</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">json</span><span class="p">[</span><span class="n">descriptionKey</span><span class="p">]</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">null</span>
<a id="__codelineno-22-4" name="__codelineno-22-4" href="#__codelineno-22-4"></a><span class="w">            </span><span class="o">?</span><span class="w"> </span><span class="n">json</span><span class="p">[</span><span class="n">descriptionKey</span><span class="p">].</span><span class="n">toString</span><span class="p">()</span>
<a id="__codelineno-22-5" name="__codelineno-22-5" href="#__codelineno-22-5"></a><span class="w">            </span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Sin descripción&#39;</span><span class="p">,</span>
<a id="__codelineno-22-6" name="__codelineno-22-6" href="#__codelineno-22-6"></a><span class="w">        </span><span class="n">price</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kt">double</span><span class="p">.</span><span class="n">tryParse</span><span class="p">(</span><span class="n">json</span><span class="p">[</span><span class="n">priceKey</span><span class="p">].</span><span class="n">toString</span><span class="p">())</span><span class="w"> </span><span class="o">??</span><span class="w"> </span><span class="m">0.0</span><span class="p">,</span>
<a id="__codelineno-22-7" name="__codelineno-22-7" href="#__codelineno-22-7"></a><span class="w">        </span><span class="n">available</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">json</span><span class="p">[</span><span class="n">availableKey</span><span class="p">]</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">null</span>
<a id="__codelineno-22-8" name="__codelineno-22-8" href="#__codelineno-22-8"></a><span class="w">            </span><span class="o">?</span><span class="w"> </span><span class="n">DateTime</span><span class="p">.</span><span class="n">parse</span><span class="p">(</span><span class="n">json</span><span class="p">[</span><span class="n">availableKey</span><span class="p">].</span><span class="n">toString</span><span class="p">())</span>
<a id="__codelineno-22-9" name="__codelineno-22-9" href="#__codelineno-22-9"></a><span class="w">            </span><span class="o">:</span><span class="w"> </span><span class="n">DateTime</span><span class="p">.</span><span class="n">now</span><span class="p">(),</span>
<a id="__codelineno-22-10" name="__codelineno-22-10" href="#__codelineno-22-10"></a><span class="w">        </span><span class="n">imageUrl</span><span class="w"> </span><span class="o">=</span>
<a id="__codelineno-22-11" name="__codelineno-22-11" href="#__codelineno-22-11"></a><span class="w">            </span><span class="n">json</span><span class="p">[</span><span class="n">imageUrlKey</span><span class="p">]</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">null</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="n">json</span><span class="p">[</span><span class="n">imageUrlKey</span><span class="p">].</span><span class="n">toString</span><span class="p">()</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="p">,</span>
<a id="__codelineno-22-12" name="__codelineno-22-12" href="#__codelineno-22-12"></a><span class="w">        </span><span class="n">rating</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kt">int</span><span class="p">.</span><span class="n">tryParse</span><span class="p">(</span><span class="n">json</span><span class="p">[</span><span class="n">ratingKey</span><span class="p">].</span><span class="n">toString</span><span class="p">())</span><span class="w"> </span><span class="o">??</span><span class="w"> </span><span class="m">0</span><span class="p">;</span>
<a id="__codelineno-22-13" name="__codelineno-22-13" href="#__codelineno-22-13"></a><span class="p">}</span>
</code></pre></div>
<p>Después de los cambios, la clase quedaría de la siguiente forma:</p>
<div class="highlight"><span class="filename">lib/models/product.dart</span><pre><span></span><code><a id="__codelineno-23-1" name="__codelineno-23-1" href="#__codelineno-23-1"></a><span class="kd">class</span><span class="w"> </span><span class="nc">Product</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-23-2" name="__codelineno-23-2" href="#__codelineno-23-2"></a><span class="w">  </span><span class="kd">static</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="kt">String</span><span class="w"> </span><span class="n">idKey</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;id&#39;</span><span class="p">;</span>
<a id="__codelineno-23-3" name="__codelineno-23-3" href="#__codelineno-23-3"></a><span class="w">  </span><span class="kd">static</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="kt">String</span><span class="w"> </span><span class="n">descriptionKey</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;description&#39;</span><span class="p">;</span>
<a id="__codelineno-23-4" name="__codelineno-23-4" href="#__codelineno-23-4"></a><span class="w">  </span><span class="kd">static</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="kt">String</span><span class="w"> </span><span class="n">priceKey</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;price&#39;</span><span class="p">;</span>
<a id="__codelineno-23-5" name="__codelineno-23-5" href="#__codelineno-23-5"></a><span class="w">  </span><span class="kd">static</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="kt">String</span><span class="w"> </span><span class="n">availableKey</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;available&#39;</span><span class="p">;</span>
<a id="__codelineno-23-6" name="__codelineno-23-6" href="#__codelineno-23-6"></a><span class="w">  </span><span class="kd">static</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="kt">String</span><span class="w"> </span><span class="n">imageUrlKey</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;imageUrl&#39;</span><span class="p">;</span>
<a id="__codelineno-23-7" name="__codelineno-23-7" href="#__codelineno-23-7"></a><span class="w">  </span><span class="kd">static</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="kt">String</span><span class="w"> </span><span class="n">ratingKey</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;rating&#39;</span><span class="p">;</span>
<a id="__codelineno-23-8" name="__codelineno-23-8" href="#__codelineno-23-8"></a>
<a id="__codelineno-23-9" name="__codelineno-23-9" href="#__codelineno-23-9"></a><span class="w">  </span><span class="kd">final</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">id</span><span class="p">;</span>
<a id="__codelineno-23-10" name="__codelineno-23-10" href="#__codelineno-23-10"></a><span class="w">  </span><span class="kd">final</span><span class="w"> </span><span class="kt">String</span><span class="w"> </span><span class="n">description</span><span class="p">;</span>
<a id="__codelineno-23-11" name="__codelineno-23-11" href="#__codelineno-23-11"></a><span class="w">  </span><span class="kd">final</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">price</span><span class="p">;</span>
<a id="__codelineno-23-12" name="__codelineno-23-12" href="#__codelineno-23-12"></a><span class="w">  </span><span class="kd">final</span><span class="w"> </span><span class="n">DateTime</span><span class="w"> </span><span class="n">available</span><span class="p">;</span>
<a id="__codelineno-23-13" name="__codelineno-23-13" href="#__codelineno-23-13"></a><span class="w">  </span><span class="kd">final</span><span class="w"> </span><span class="kt">String</span><span class="w"> </span><span class="n">imageUrl</span><span class="p">;</span>
<a id="__codelineno-23-14" name="__codelineno-23-14" href="#__codelineno-23-14"></a><span class="w">  </span><span class="kd">final</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">rating</span><span class="p">;</span>
<a id="__codelineno-23-15" name="__codelineno-23-15" href="#__codelineno-23-15"></a>
<a id="__codelineno-23-16" name="__codelineno-23-16" href="#__codelineno-23-16"></a><span class="w">  </span><span class="k">const</span><span class="w"> </span><span class="n">Product</span><span class="p">({</span>
<a id="__codelineno-23-17" name="__codelineno-23-17" href="#__codelineno-23-17"></a><span class="w">    </span><span class="kd">required</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="n">id</span><span class="p">,</span>
<a id="__codelineno-23-18" name="__codelineno-23-18" href="#__codelineno-23-18"></a><span class="w">    </span><span class="kd">required</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="n">description</span><span class="p">,</span>
<a id="__codelineno-23-19" name="__codelineno-23-19" href="#__codelineno-23-19"></a><span class="w">    </span><span class="kd">required</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="n">price</span><span class="p">,</span>
<a id="__codelineno-23-20" name="__codelineno-23-20" href="#__codelineno-23-20"></a><span class="w">    </span><span class="kd">required</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="n">available</span><span class="p">,</span>
<a id="__codelineno-23-21" name="__codelineno-23-21" href="#__codelineno-23-21"></a><span class="w">    </span><span class="kd">required</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="n">imageUrl</span><span class="p">,</span>
<a id="__codelineno-23-22" name="__codelineno-23-22" href="#__codelineno-23-22"></a><span class="w">    </span><span class="kd">required</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="n">rating</span><span class="p">,</span>
<a id="__codelineno-23-23" name="__codelineno-23-23" href="#__codelineno-23-23"></a><span class="w">  </span><span class="p">});</span>
<a id="__codelineno-23-24" name="__codelineno-23-24" href="#__codelineno-23-24"></a>
<a id="__codelineno-23-25" name="__codelineno-23-25" href="#__codelineno-23-25"></a><span class="w">  </span><span class="n">Product</span><span class="p">.</span><span class="n">fromJson</span><span class="p">(</span><span class="n">Map</span><span class="o">&lt;</span><span class="kt">String</span><span class="p">,</span><span class="w"> </span><span class="kt">dynamic</span><span class="o">&gt;</span><span class="w"> </span><span class="n">json</span><span class="p">)</span>
<a id="__codelineno-23-26" name="__codelineno-23-26" href="#__codelineno-23-26"></a><span class="w">      </span><span class="o">:</span><span class="w"> </span><span class="n">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kt">int</span><span class="p">.</span><span class="n">tryParse</span><span class="p">(</span><span class="n">json</span><span class="p">[</span><span class="n">idKey</span><span class="p">].</span><span class="n">toString</span><span class="p">())</span><span class="w"> </span><span class="o">??</span><span class="w"> </span><span class="m">0</span><span class="p">,</span>
<a id="__codelineno-23-27" name="__codelineno-23-27" href="#__codelineno-23-27"></a><span class="w">        </span><span class="n">description</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">json</span><span class="p">[</span><span class="n">descriptionKey</span><span class="p">]</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">null</span>
<a id="__codelineno-23-28" name="__codelineno-23-28" href="#__codelineno-23-28"></a><span class="w">            </span><span class="o">?</span><span class="w"> </span><span class="n">json</span><span class="p">[</span><span class="n">descriptionKey</span><span class="p">].</span><span class="n">toString</span><span class="p">()</span>
<a id="__codelineno-23-29" name="__codelineno-23-29" href="#__codelineno-23-29"></a><span class="w">            </span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Sin descripción&#39;</span><span class="p">,</span>
<a id="__codelineno-23-30" name="__codelineno-23-30" href="#__codelineno-23-30"></a><span class="w">        </span><span class="n">price</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kt">double</span><span class="p">.</span><span class="n">tryParse</span><span class="p">(</span><span class="n">json</span><span class="p">[</span><span class="n">priceKey</span><span class="p">].</span><span class="n">toString</span><span class="p">())</span><span class="w"> </span><span class="o">??</span><span class="w"> </span><span class="m">0.0</span><span class="p">,</span>
<a id="__codelineno-23-31" name="__codelineno-23-31" href="#__codelineno-23-31"></a><span class="w">        </span><span class="n">available</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">json</span><span class="p">[</span><span class="n">availableKey</span><span class="p">]</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">null</span>
<a id="__codelineno-23-32" name="__codelineno-23-32" href="#__codelineno-23-32"></a><span class="w">            </span><span class="o">?</span><span class="w"> </span><span class="n">DateTime</span><span class="p">.</span><span class="n">parse</span><span class="p">(</span><span class="n">json</span><span class="p">[</span><span class="n">availableKey</span><span class="p">].</span><span class="n">toString</span><span class="p">())</span>
<a id="__codelineno-23-33" name="__codelineno-23-33" href="#__codelineno-23-33"></a><span class="w">            </span><span class="o">:</span><span class="w"> </span><span class="n">DateTime</span><span class="p">.</span><span class="n">now</span><span class="p">(),</span>
<a id="__codelineno-23-34" name="__codelineno-23-34" href="#__codelineno-23-34"></a><span class="w">        </span><span class="n">imageUrl</span><span class="w"> </span><span class="o">=</span>
<a id="__codelineno-23-35" name="__codelineno-23-35" href="#__codelineno-23-35"></a><span class="w">            </span><span class="n">json</span><span class="p">[</span><span class="n">imageUrlKey</span><span class="p">]</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">null</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="n">json</span><span class="p">[</span><span class="n">imageUrlKey</span><span class="p">].</span><span class="n">toString</span><span class="p">()</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="p">,</span>
<a id="__codelineno-23-36" name="__codelineno-23-36" href="#__codelineno-23-36"></a><span class="w">        </span><span class="n">rating</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kt">int</span><span class="p">.</span><span class="n">tryParse</span><span class="p">(</span><span class="n">json</span><span class="p">[</span><span class="n">ratingKey</span><span class="p">].</span><span class="n">toString</span><span class="p">())</span><span class="w"> </span><span class="o">??</span><span class="w"> </span><span class="m">0</span><span class="p">;</span>
<a id="__codelineno-23-37" name="__codelineno-23-37" href="#__codelineno-23-37"></a>
<a id="__codelineno-23-38" name="__codelineno-23-38" href="#__codelineno-23-38"></a><span class="w">  </span><span class="n">Map</span><span class="o">&lt;</span><span class="kt">String</span><span class="p">,</span><span class="w"> </span><span class="kt">dynamic</span><span class="o">&gt;</span><span class="w"> </span><span class="n">toJson</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-23-39" name="__codelineno-23-39" href="#__codelineno-23-39"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-23-40" name="__codelineno-23-40" href="#__codelineno-23-40"></a><span class="w">      </span><span class="nl">idKey:</span><span class="w"> </span><span class="n">id</span><span class="p">,</span>
<a id="__codelineno-23-41" name="__codelineno-23-41" href="#__codelineno-23-41"></a><span class="w">      </span><span class="nl">descriptionKey:</span><span class="w"> </span><span class="n">description</span><span class="p">,</span>
<a id="__codelineno-23-42" name="__codelineno-23-42" href="#__codelineno-23-42"></a><span class="w">      </span><span class="nl">priceKey:</span><span class="w"> </span><span class="n">price</span><span class="p">,</span>
<a id="__codelineno-23-43" name="__codelineno-23-43" href="#__codelineno-23-43"></a><span class="w">      </span><span class="nl">availableKey:</span><span class="w"> </span><span class="n">available</span><span class="p">.</span><span class="n">toIso8601String</span><span class="p">(),</span>
<a id="__codelineno-23-44" name="__codelineno-23-44" href="#__codelineno-23-44"></a><span class="w">      </span><span class="nl">imageUrlKey:</span><span class="w"> </span><span class="n">imageUrl</span><span class="p">,</span>
<a id="__codelineno-23-45" name="__codelineno-23-45" href="#__codelineno-23-45"></a><span class="w">      </span><span class="nl">ratingKey:</span><span class="w"> </span><span class="n">rating</span>
<a id="__codelineno-23-46" name="__codelineno-23-46" href="#__codelineno-23-46"></a><span class="w">    </span><span class="p">};</span>
<a id="__codelineno-23-47" name="__codelineno-23-47" href="#__codelineno-23-47"></a><span class="w">  </span><span class="p">}</span>
<a id="__codelineno-23-48" name="__codelineno-23-48" href="#__codelineno-23-48"></a><span class="p">}</span>
</code></pre></div>
<h2 id="almacenamiento-local">Almacenamiento local<a class="headerlink" href="#almacenamiento-local" title="Permanent link">&para;</a></h2>
<p>En Flutter se puede utilizar el almacenamiento local para guardar datos en el dispositivo. Para ello, se utiliza la librería <code>shared_preferences</code> que permite guardar datos de tipo <code>String</code>, <code>bool</code>, <code>int</code>, <code>double</code> y <code>StringList</code>.</p>
<p>No se debe almacenar información sensible, como contraseñas o tokens de acceso, ya que no se encripta la información.</p>
<p>Almacena pares de datos clave-valor, donde la clave es un <code>String</code> y el valor es uno de los tipos soportados. Para guardar un valor se utiliza el método <code>set</code> y para obtener un valor se utiliza el método <code>get</code>.</p>
<h3 id="instalar-la-libreria">Instalar la librería<a class="headerlink" href="#instalar-la-libreria" title="Permanent link">&para;</a></h3>
<p>Para instalar la librería <code>shared_preferences</code>, desde el terminal ejecutar el siguiente comando:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-24-1" name="__codelineno-24-1" href="#__codelineno-24-1"></a>flutter<span class="w"> </span>pub<span class="w"> </span>add<span class="w"> </span>shared_preferences
</code></pre></div>
<p>Para actualizar las dependencias del proyecto, ejecutar el siguiente comando:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-25-1" name="__codelineno-25-1" href="#__codelineno-25-1"></a>flutter<span class="w"> </span>pub<span class="w"> </span>get
</code></pre></div>
<h3 id="tipos-de-datos-soportados">Tipos de datos soportados<a class="headerlink" href="#tipos-de-datos-soportados" title="Permanent link">&para;</a></h3>
<ul>
<li><code>String</code>: <code>setString</code> y <code>getString</code></li>
<li><code>bool</code>: <code>setBool</code> y <code>getBool</code></li>
<li><code>int</code>: <code>setInt</code> y <code>getInt</code></li>
<li><code>double</code>: <code>setDouble</code> y <code>getDouble</code></li>
<li><code>StringList</code>: <code>setStringList</code> y <code>getStringList</code>. Se utiliza para guardar una lista de cadenas de texto.</li>
</ul>
<p>Ejemplo de guardado:</p>
<div class="highlight"><span class="filename">Ejemplos de guardado en shared_preferences</span><pre><span></span><code><a id="__codelineno-26-1" name="__codelineno-26-1" href="#__codelineno-26-1"></a><span class="c1">// Obtener una instancia de SharedPreferences</span>
<a id="__codelineno-26-2" name="__codelineno-26-2" href="#__codelineno-26-2"></a><span class="kd">final</span><span class="w"> </span><span class="n">SharedPreferences</span><span class="w"> </span><span class="n">prefs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">await</span><span class="w"> </span><span class="n">SharedPreferences</span><span class="p">.</span><span class="n">getInstance</span><span class="p">();</span>
<a id="__codelineno-26-3" name="__codelineno-26-3" href="#__codelineno-26-3"></a>
<a id="__codelineno-26-4" name="__codelineno-26-4" href="#__codelineno-26-4"></a><span class="c1">// Guardar un valor integer en la clave &#39;counter&#39;.</span>
<a id="__codelineno-26-5" name="__codelineno-26-5" href="#__codelineno-26-5"></a><span class="kd">await</span><span class="w"> </span><span class="n">prefs</span><span class="p">.</span><span class="n">setInt</span><span class="p">(</span><span class="s1">&#39;counter&#39;</span><span class="p">,</span><span class="w"> </span><span class="m">10</span><span class="p">);</span>
<a id="__codelineno-26-6" name="__codelineno-26-6" href="#__codelineno-26-6"></a><span class="c1">// Guardar un valor boolean en la clave &#39;repeat&#39;.</span>
<a id="__codelineno-26-7" name="__codelineno-26-7" href="#__codelineno-26-7"></a><span class="kd">await</span><span class="w"> </span><span class="n">prefs</span><span class="p">.</span><span class="n">setBool</span><span class="p">(</span><span class="s1">&#39;repeat&#39;</span><span class="p">,</span><span class="w"> </span><span class="kc">true</span><span class="p">);</span>
<a id="__codelineno-26-8" name="__codelineno-26-8" href="#__codelineno-26-8"></a><span class="c1">// Guardar un valor double en la clave &#39;decimal&#39;.</span>
<a id="__codelineno-26-9" name="__codelineno-26-9" href="#__codelineno-26-9"></a><span class="kd">await</span><span class="w"> </span><span class="n">prefs</span><span class="p">.</span><span class="n">setDouble</span><span class="p">(</span><span class="s1">&#39;decimal&#39;</span><span class="p">,</span><span class="w"> </span><span class="m">1.5</span><span class="p">);</span>
<a id="__codelineno-26-10" name="__codelineno-26-10" href="#__codelineno-26-10"></a><span class="c1">// Guardar un valor String en la clave &#39;user_name&#39;.</span>
<a id="__codelineno-26-11" name="__codelineno-26-11" href="#__codelineno-26-11"></a><span class="kd">await</span><span class="w"> </span><span class="n">prefs</span><span class="p">.</span><span class="n">setString</span><span class="p">(</span><span class="s1">&#39;user_name&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;John Doe&#39;</span><span class="p">);</span>
<a id="__codelineno-26-12" name="__codelineno-26-12" href="#__codelineno-26-12"></a><span class="c1">// Guardar un listado de strings en la clave &#39;items&#39;.</span>
<a id="__codelineno-26-13" name="__codelineno-26-13" href="#__codelineno-26-13"></a><span class="kd">await</span><span class="w"> </span><span class="n">prefs</span><span class="p">.</span><span class="n">setStringList</span><span class="p">(</span><span class="s1">&#39;items&#39;</span><span class="p">,</span><span class="w"> </span><span class="o">&lt;</span><span class="kt">String</span><span class="o">&gt;</span><span class="p">[</span><span class="s1">&#39;Earth&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Moon&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Sun&#39;</span><span class="p">]);</span>
</code></pre></div>
<p>Ejemplo de lectura:</p>
<div class="highlight"><span class="filename">Ejemplos de lectura en shared_preferences</span><pre><span></span><code><a id="__codelineno-27-1" name="__codelineno-27-1" href="#__codelineno-27-1"></a><span class="c1">// Obtener una instancia de SharedPreferences</span>
<a id="__codelineno-27-2" name="__codelineno-27-2" href="#__codelineno-27-2"></a><span class="kd">final</span><span class="w"> </span><span class="n">SharedPreferences</span><span class="w"> </span><span class="n">prefs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">await</span><span class="w"> </span><span class="n">SharedPreferences</span><span class="p">.</span><span class="n">getInstance</span><span class="p">();</span>
<a id="__codelineno-27-3" name="__codelineno-27-3" href="#__codelineno-27-3"></a>
<a id="__codelineno-27-4" name="__codelineno-27-4" href="#__codelineno-27-4"></a><span class="c1">// Obtener un valor integer de la clave &#39;counter&#39;.</span>
<a id="__codelineno-27-5" name="__codelineno-27-5" href="#__codelineno-27-5"></a><span class="kd">final</span><span class="w"> </span><span class="kt">int</span><span class="o">?</span><span class="w"> </span><span class="n">counter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">prefs</span><span class="p">.</span><span class="n">getInt</span><span class="p">(</span><span class="s1">&#39;counter&#39;</span><span class="p">);</span>
<a id="__codelineno-27-6" name="__codelineno-27-6" href="#__codelineno-27-6"></a><span class="c1">// Obtener un valor boolean de la clave &#39;repeat&#39;.</span>
<a id="__codelineno-27-7" name="__codelineno-27-7" href="#__codelineno-27-7"></a><span class="kd">final</span><span class="w"> </span><span class="kt">bool</span><span class="o">?</span><span class="w"> </span><span class="n">repeat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">prefs</span><span class="p">.</span><span class="n">getBool</span><span class="p">(</span><span class="s1">&#39;repeat&#39;</span><span class="p">);</span>
<a id="__codelineno-27-8" name="__codelineno-27-8" href="#__codelineno-27-8"></a><span class="c1">// Obtener un valor double de la clave &#39;decimal&#39;.</span>
<a id="__codelineno-27-9" name="__codelineno-27-9" href="#__codelineno-27-9"></a><span class="kd">final</span><span class="w"> </span><span class="kt">double</span><span class="o">?</span><span class="w"> </span><span class="n">decimal</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">prefs</span><span class="p">.</span><span class="n">getDouble</span><span class="p">(</span><span class="s1">&#39;decimal&#39;</span><span class="p">);</span>
<a id="__codelineno-27-10" name="__codelineno-27-10" href="#__codelineno-27-10"></a><span class="c1">// Obtener un valor String de la clave &#39;user_name&#39;.</span>
<a id="__codelineno-27-11" name="__codelineno-27-11" href="#__codelineno-27-11"></a><span class="kd">final</span><span class="w"> </span><span class="kt">String</span><span class="o">?</span><span class="w"> </span><span class="n">userName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">prefs</span><span class="p">.</span><span class="n">getString</span><span class="p">(</span><span class="s1">&#39;user_name&#39;</span><span class="p">);</span>
<a id="__codelineno-27-12" name="__codelineno-27-12" href="#__codelineno-27-12"></a><span class="c1">// Obtener un listado de strings de la clave &#39;items&#39;.</span>
<a id="__codelineno-27-13" name="__codelineno-27-13" href="#__codelineno-27-13"></a><span class="kd">final</span><span class="w"> </span><span class="n">List</span><span class="o">&lt;</span><span class="kt">String</span><span class="o">&gt;?</span><span class="w"> </span><span class="n">items</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">prefs</span><span class="p">.</span><span class="n">getStringList</span><span class="p">(</span><span class="s1">&#39;items&#39;</span><span class="p">);</span>
</code></pre></div>
<h3 id="guardar-un-valor">Guardar un valor<a class="headerlink" href="#guardar-un-valor" title="Permanent link">&para;</a></h3>
<p>Para guardar un valor se utiliza el método <code>set</code> de la clase <code>SharedPreferences</code>. El método <code>set</code> recibe dos parámetros, el nombre de la clave y el valor a guardar.</p>
<p>Permite guardar valores de tipo <code>String</code>, <code>bool</code>, <code>int</code>, <code>double</code> y <code>StringList</code>. Para guardar un objeto de tipo <code>List</code> o <code>Map</code> se debe convertir a <code>String</code> con <code>jsonEncode</code>.</p>
<p>En la aplicación de ejemplo, se va a crear un método <code>saveProducts</code> en la clase <code>_ProductsState</code> para guardar la lista de productos en el almacenamiento local.</p>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">lib/main.dart</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-28-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-28-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-28-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-28-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-28-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-28-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-28-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-28-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-28-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-28-10">10</a></span>
<span class="normal"><a href="#__codelineno-28-11">11</a></span>
<span class="normal"><a href="#__codelineno-28-12">12</a></span>
<span class="normal"><a href="#__codelineno-28-13">13</a></span>
<span class="normal"><a href="#__codelineno-28-14">14</a></span>
<span class="normal"><a href="#__codelineno-28-15">15</a></span>
<span class="normal"><a href="#__codelineno-28-16">16</a></span>
<span class="normal"><a href="#__codelineno-28-17">17</a></span>
<span class="normal"><a href="#__codelineno-28-18">18</a></span>
<span class="normal"><a href="#__codelineno-28-19">19</a></span>
<span class="normal"><a href="#__codelineno-28-20">20</a></span>
<span class="normal"><a href="#__codelineno-28-21">21</a></span>
<span class="normal"><a href="#__codelineno-28-22">22</a></span>
<span class="normal"><a href="#__codelineno-28-23">23</a></span>
<span class="normal"><a href="#__codelineno-28-24">24</a></span>
<span class="normal"><a href="#__codelineno-28-25">25</a></span>
<span class="normal"><a href="#__codelineno-28-26">26</a></span>
<span class="normal"><a href="#__codelineno-28-27">27</a></span>
<span class="normal"><a href="#__codelineno-28-28">28</a></span>
<span class="normal"><a href="#__codelineno-28-29">29</a></span>
<span class="normal"><a href="#__codelineno-28-30">30</a></span>
<span class="normal"><a href="#__codelineno-28-31">31</a></span>
<span class="normal"><a href="#__codelineno-28-32">32</a></span>
<span class="normal"><a href="#__codelineno-28-33">33</a></span>
<span class="normal"><a href="#__codelineno-28-34">34</a></span>
<span class="normal"><a href="#__codelineno-28-35">35</a></span>
<span class="normal"><a href="#__codelineno-28-36">36</a></span>
<span class="normal"><a href="#__codelineno-28-37">37</a></span>
<span class="normal"><a href="#__codelineno-28-38">38</a></span>
<span class="normal"><a href="#__codelineno-28-39">39</a></span>
<span class="normal"><a href="#__codelineno-28-40">40</a></span>
<span class="normal"><a href="#__codelineno-28-41">41</a></span>
<span class="normal"><a href="#__codelineno-28-42">42</a></span>
<span class="normal"><a href="#__codelineno-28-43">43</a></span>
<span class="normal"><a href="#__codelineno-28-44">44</a></span>
<span class="normal"><a href="#__codelineno-28-45">45</a></span>
<span class="normal"><a href="#__codelineno-28-46">46</a></span>
<span class="normal"><a href="#__codelineno-28-47">47</a></span>
<span class="normal"><a href="#__codelineno-28-48">48</a></span>
<span class="normal"><a href="#__codelineno-28-49">49</a></span>
<span class="normal"><a href="#__codelineno-28-50">50</a></span>
<span class="normal"><a href="#__codelineno-28-51">51</a></span>
<span class="normal"><a href="#__codelineno-28-52">52</a></span>
<span class="normal"><a href="#__codelineno-28-53">53</a></span>
<span class="normal"><a href="#__codelineno-28-54">54</a></span>
<span class="normal"><a href="#__codelineno-28-55">55</a></span>
<span class="normal"><a href="#__codelineno-28-56">56</a></span>
<span class="normal"><a href="#__codelineno-28-57">57</a></span>
<span class="normal"><a href="#__codelineno-28-58">58</a></span>
<span class="normal"><a href="#__codelineno-28-59">59</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-28-1" name="__codelineno-28-1"></a><span class="k">import</span><span class="w"> </span><span class="s1">&#39;package:flutter/material.dart&#39;</span><span class="p">;</span>
<a id="__codelineno-28-2" name="__codelineno-28-2"></a><span class="hll"><span class="k">import</span><span class="w"> </span><span class="s1">&#39;package:shared_preferences/shared_preferences.dart&#39;</span><span class="p">;</span>
</span><a id="__codelineno-28-3" name="__codelineno-28-3"></a>
<a id="__codelineno-28-4" name="__codelineno-28-4"></a><span class="kt">void</span><span class="w"> </span><span class="n">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-28-5" name="__codelineno-28-5"></a><span class="w">  </span><span class="n">runApp</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">ProductsApp</span><span class="p">());</span>
<a id="__codelineno-28-6" name="__codelineno-28-6"></a><span class="p">}</span>
<a id="__codelineno-28-7" name="__codelineno-28-7"></a>
<a id="__codelineno-28-8" name="__codelineno-28-8"></a><span class="kd">class</span><span class="w"> </span><span class="nc">ProductsApp</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">StatelessWidget</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-28-9" name="__codelineno-28-9"></a><span class="w">  </span><span class="k">const</span><span class="w"> </span><span class="n">ProductsApp</span><span class="p">({</span><span class="k">super</span><span class="p">.</span><span class="n">key</span><span class="p">});</span>
<a id="__codelineno-28-10" name="__codelineno-28-10"></a>
<a id="__codelineno-28-11" name="__codelineno-28-11"></a><span class="w">  </span><span class="nd">@override</span>
<a id="__codelineno-28-12" name="__codelineno-28-12"></a><span class="w">  </span><span class="n">Widget</span><span class="w"> </span><span class="n">build</span><span class="p">(</span><span class="n">BuildContext</span><span class="w"> </span><span class="n">context</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-28-13" name="__codelineno-28-13"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">MaterialApp</span><span class="p">(</span>
<a id="__codelineno-28-14" name="__codelineno-28-14"></a><span class="w">      </span><span class="nl">title:</span><span class="w"> </span><span class="s1">&#39;Flutter Products&#39;</span><span class="p">,</span>
<a id="__codelineno-28-15" name="__codelineno-28-15"></a><span class="w">      </span><span class="nl">debugShowCheckedModeBanner:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span>
<a id="__codelineno-28-16" name="__codelineno-28-16"></a><span class="w">      </span><span class="nl">theme:</span><span class="w"> </span><span class="n">ThemeData</span><span class="p">(</span>
<a id="__codelineno-28-17" name="__codelineno-28-17"></a><span class="w">        </span><span class="nl">colorScheme:</span><span class="w"> </span><span class="n">ColorScheme</span><span class="p">.</span><span class="n">fromSeed</span><span class="p">(</span><span class="nl">seedColor:</span><span class="w"> </span><span class="n">Colors</span><span class="p">.</span><span class="n">blue</span><span class="p">),</span>
<a id="__codelineno-28-18" name="__codelineno-28-18"></a><span class="w">        </span><span class="nl">useMaterial3:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<a id="__codelineno-28-19" name="__codelineno-28-19"></a><span class="w">      </span><span class="p">),</span>
<a id="__codelineno-28-20" name="__codelineno-28-20"></a><span class="w">      </span><span class="nl">home:</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">Products</span><span class="p">(),</span>
<a id="__codelineno-28-21" name="__codelineno-28-21"></a><span class="w">    </span><span class="p">);</span>
<a id="__codelineno-28-22" name="__codelineno-28-22"></a><span class="w">  </span><span class="p">}</span>
<a id="__codelineno-28-23" name="__codelineno-28-23"></a><span class="p">}</span>
<a id="__codelineno-28-24" name="__codelineno-28-24"></a>
<a id="__codelineno-28-25" name="__codelineno-28-25"></a><span class="kd">class</span><span class="w"> </span><span class="nc">Products</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">StatefulWidget</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-28-26" name="__codelineno-28-26"></a><span class="w">  </span><span class="k">const</span><span class="w"> </span><span class="n">Products</span><span class="p">({</span><span class="k">super</span><span class="p">.</span><span class="n">key</span><span class="p">});</span>
<a id="__codelineno-28-27" name="__codelineno-28-27"></a>
<a id="__codelineno-28-28" name="__codelineno-28-28"></a><span class="w">  </span><span class="nd">@override</span>
<a id="__codelineno-28-29" name="__codelineno-28-29"></a><span class="w">  </span><span class="n">State</span><span class="o">&lt;</span><span class="n">Products</span><span class="o">&gt;</span><span class="w"> </span><span class="n">createState</span><span class="p">()</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">_ProductsState</span><span class="p">();</span>
<a id="__codelineno-28-30" name="__codelineno-28-30"></a><span class="p">}</span>
<a id="__codelineno-28-31" name="__codelineno-28-31"></a>
<a id="__codelineno-28-32" name="__codelineno-28-32"></a><span class="kd">class</span><span class="w"> </span><span class="nc">_ProductsState</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">State</span><span class="o">&lt;</span><span class="n">Products</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-28-33" name="__codelineno-28-33"></a><span class="w">  </span><span class="n">List</span><span class="o">&lt;</span><span class="n">Product</span><span class="o">&gt;</span><span class="w"> </span><span class="n">products</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[];</span>
<a id="__codelineno-28-34" name="__codelineno-28-34"></a>
<a id="__codelineno-28-35" name="__codelineno-28-35"></a><span class="w">  </span><span class="nd">@override</span>
<a id="__codelineno-28-36" name="__codelineno-28-36"></a><span class="w">  </span><span class="n">Widget</span><span class="w"> </span><span class="n">build</span><span class="p">(</span><span class="n">BuildContext</span><span class="w"> </span><span class="n">context</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-28-37" name="__codelineno-28-37"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">Scaffold</span><span class="p">(</span>
<a id="__codelineno-28-38" name="__codelineno-28-38"></a><span class="w">        </span><span class="nl">appBar:</span><span class="w"> </span><span class="n">AppBar</span><span class="p">(</span><span class="nl">title:</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span><span class="s1">&#39;Productos&#39;</span><span class="p">)),</span><span class="w"> </span><span class="nl">body:</span><span class="w"> </span><span class="n">Container</span><span class="p">());</span>
<a id="__codelineno-28-39" name="__codelineno-28-39"></a><span class="w">  </span><span class="p">}</span>
<a id="__codelineno-28-40" name="__codelineno-28-40"></a>
<a id="__codelineno-28-41" name="__codelineno-28-41"></a><span class="w">  </span><span class="n">Future</span><span class="w"> </span><span class="n">readJsonFile</span><span class="p">()</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-28-42" name="__codelineno-28-42"></a><span class="w">    </span><span class="kt">String</span><span class="w"> </span><span class="n">jsonString</span><span class="w"> </span><span class="o">=</span>
<a id="__codelineno-28-43" name="__codelineno-28-43"></a><span class="w">        </span><span class="kd">await</span><span class="w"> </span><span class="n">DefaultAssetBundle</span><span class="p">.</span><span class="n">of</span><span class="p">(</span><span class="n">context</span><span class="p">).</span><span class="n">loadString</span><span class="p">(</span><span class="s1">&#39;assets/products.json&#39;</span><span class="p">);</span>
<a id="__codelineno-28-44" name="__codelineno-28-44"></a><span class="w">    </span><span class="n">List</span><span class="w"> </span><span class="n">jsonList</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">jsonDecode</span><span class="p">(</span><span class="n">jsonString</span><span class="p">);</span>
<a id="__codelineno-28-45" name="__codelineno-28-45"></a>
<a id="__codelineno-28-46" name="__codelineno-28-46"></a><span class="w">    </span><span class="n">List</span><span class="o">&lt;</span><span class="n">Product</span><span class="o">&gt;</span><span class="w"> </span><span class="n">products</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[];</span>
<a id="__codelineno-28-47" name="__codelineno-28-47"></a><span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kd">var</span><span class="w"> </span><span class="n">item</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">jsonList</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-28-48" name="__codelineno-28-48"></a><span class="w">      </span><span class="n">Product</span><span class="w"> </span><span class="n">product</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Product</span><span class="p">.</span><span class="n">fromJson</span><span class="p">(</span><span class="n">item</span><span class="p">);</span>
<a id="__codelineno-28-49" name="__codelineno-28-49"></a><span class="w">      </span><span class="n">products</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">product</span><span class="p">);</span>
<a id="__codelineno-28-50" name="__codelineno-28-50"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-28-51" name="__codelineno-28-51"></a>
<a id="__codelineno-28-52" name="__codelineno-28-52"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">products</span><span class="p">;</span>
<a id="__codelineno-28-53" name="__codelineno-28-53"></a><span class="w">  </span><span class="p">}</span>
<a id="__codelineno-28-54" name="__codelineno-28-54"></a>
<a id="__codelineno-28-55" name="__codelineno-28-55"></a><span class="hll"><span class="w">  </span><span class="n">Future</span><span class="w"> </span><span class="n">saveProducts</span><span class="p">()</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="p">{</span>
</span><a id="__codelineno-28-56" name="__codelineno-28-56"></a><span class="hll"><span class="w">    </span><span class="n">SharedPreferences</span><span class="w"> </span><span class="n">prefs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">await</span><span class="w"> </span><span class="n">SharedPreferences</span><span class="p">.</span><span class="n">getInstance</span><span class="p">();</span>
</span><a id="__codelineno-28-57" name="__codelineno-28-57"></a><span class="hll"><span class="w">    </span><span class="kd">await</span><span class="w"> </span><span class="n">prefs</span><span class="p">.</span><span class="n">setString</span><span class="p">(</span><span class="s1">&#39;products&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">convertToJSON</span><span class="p">(</span><span class="n">products</span><span class="p">));</span>
</span><a id="__codelineno-28-58" name="__codelineno-28-58"></a><span class="hll"><span class="w">  </span><span class="p">}</span>
</span><a id="__codelineno-28-59" name="__codelineno-28-59"></a><span class="p">}</span>
</code></pre></div></td></tr></table></div>
<p>En el método <code>saveProducts</code> se obtiene una instancia de <code>SharedPreferences</code> con el método <code>getInstance</code> y se guarda el valor de del listado de productos convertido a formato JSON con el método <code>setString</code>.</p>
<h3 id="leer-un-valor">Leer un valor<a class="headerlink" href="#leer-un-valor" title="Permanent link">&para;</a></h3>
<p>A modo de ejemplo, se va a crear una pequeña base de datos en el almacenamiento local utilizando <code>SharedPreferences</code>. Para ello se va a abstraer la lógica de acceso a datos en una clase llamada <code>ProductsService</code>.</p>
<p>Actuará como un servicio, ofreciendo la lista de productos en un atributo estático. Además, notificará de los cambios a los widgets que estén escuchando mediante un <code>ChangeNotifier</code>.</p>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">lib/provider/products_service.dart</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-29-1">  1</a></span>
<span class="normal"><a href="#__codelineno-29-2">  2</a></span>
<span class="normal"><a href="#__codelineno-29-3">  3</a></span>
<span class="normal"><a href="#__codelineno-29-4">  4</a></span>
<span class="normal"><a href="#__codelineno-29-5">  5</a></span>
<span class="normal"><a href="#__codelineno-29-6">  6</a></span>
<span class="normal"><a href="#__codelineno-29-7">  7</a></span>
<span class="normal"><a href="#__codelineno-29-8">  8</a></span>
<span class="normal"><a href="#__codelineno-29-9">  9</a></span>
<span class="normal"><a href="#__codelineno-29-10"> 10</a></span>
<span class="normal"><a href="#__codelineno-29-11"> 11</a></span>
<span class="normal"><a href="#__codelineno-29-12"> 12</a></span>
<span class="normal"><a href="#__codelineno-29-13"> 13</a></span>
<span class="normal"><a href="#__codelineno-29-14"> 14</a></span>
<span class="normal"><a href="#__codelineno-29-15"> 15</a></span>
<span class="normal"><a href="#__codelineno-29-16"> 16</a></span>
<span class="normal"><a href="#__codelineno-29-17"> 17</a></span>
<span class="normal"><a href="#__codelineno-29-18"> 18</a></span>
<span class="normal"><a href="#__codelineno-29-19"> 19</a></span>
<span class="normal"><a href="#__codelineno-29-20"> 20</a></span>
<span class="normal"><a href="#__codelineno-29-21"> 21</a></span>
<span class="normal"><a href="#__codelineno-29-22"> 22</a></span>
<span class="normal"><a href="#__codelineno-29-23"> 23</a></span>
<span class="normal"><a href="#__codelineno-29-24"> 24</a></span>
<span class="normal"><a href="#__codelineno-29-25"> 25</a></span>
<span class="normal"><a href="#__codelineno-29-26"> 26</a></span>
<span class="normal"><a href="#__codelineno-29-27"> 27</a></span>
<span class="normal"><a href="#__codelineno-29-28"> 28</a></span>
<span class="normal"><a href="#__codelineno-29-29"> 29</a></span>
<span class="normal"><a href="#__codelineno-29-30"> 30</a></span>
<span class="normal"><a href="#__codelineno-29-31"> 31</a></span>
<span class="normal"><a href="#__codelineno-29-32"> 32</a></span>
<span class="normal"><a href="#__codelineno-29-33"> 33</a></span>
<span class="normal"><a href="#__codelineno-29-34"> 34</a></span>
<span class="normal"><a href="#__codelineno-29-35"> 35</a></span>
<span class="normal"><a href="#__codelineno-29-36"> 36</a></span>
<span class="normal"><a href="#__codelineno-29-37"> 37</a></span>
<span class="normal"><a href="#__codelineno-29-38"> 38</a></span>
<span class="normal"><a href="#__codelineno-29-39"> 39</a></span>
<span class="normal"><a href="#__codelineno-29-40"> 40</a></span>
<span class="normal"><a href="#__codelineno-29-41"> 41</a></span>
<span class="normal"><a href="#__codelineno-29-42"> 42</a></span>
<span class="normal"><a href="#__codelineno-29-43"> 43</a></span>
<span class="normal"><a href="#__codelineno-29-44"> 44</a></span>
<span class="normal"><a href="#__codelineno-29-45"> 45</a></span>
<span class="normal"><a href="#__codelineno-29-46"> 46</a></span>
<span class="normal"><a href="#__codelineno-29-47"> 47</a></span>
<span class="normal"><a href="#__codelineno-29-48"> 48</a></span>
<span class="normal"><a href="#__codelineno-29-49"> 49</a></span>
<span class="normal"><a href="#__codelineno-29-50"> 50</a></span>
<span class="normal"><a href="#__codelineno-29-51"> 51</a></span>
<span class="normal"><a href="#__codelineno-29-52"> 52</a></span>
<span class="normal"><a href="#__codelineno-29-53"> 53</a></span>
<span class="normal"><a href="#__codelineno-29-54"> 54</a></span>
<span class="normal"><a href="#__codelineno-29-55"> 55</a></span>
<span class="normal"><a href="#__codelineno-29-56"> 56</a></span>
<span class="normal"><a href="#__codelineno-29-57"> 57</a></span>
<span class="normal"><a href="#__codelineno-29-58"> 58</a></span>
<span class="normal"><a href="#__codelineno-29-59"> 59</a></span>
<span class="normal"><a href="#__codelineno-29-60"> 60</a></span>
<span class="normal"><a href="#__codelineno-29-61"> 61</a></span>
<span class="normal"><a href="#__codelineno-29-62"> 62</a></span>
<span class="normal"><a href="#__codelineno-29-63"> 63</a></span>
<span class="normal"><a href="#__codelineno-29-64"> 64</a></span>
<span class="normal"><a href="#__codelineno-29-65"> 65</a></span>
<span class="normal"><a href="#__codelineno-29-66"> 66</a></span>
<span class="normal"><a href="#__codelineno-29-67"> 67</a></span>
<span class="normal"><a href="#__codelineno-29-68"> 68</a></span>
<span class="normal"><a href="#__codelineno-29-69"> 69</a></span>
<span class="normal"><a href="#__codelineno-29-70"> 70</a></span>
<span class="normal"><a href="#__codelineno-29-71"> 71</a></span>
<span class="normal"><a href="#__codelineno-29-72"> 72</a></span>
<span class="normal"><a href="#__codelineno-29-73"> 73</a></span>
<span class="normal"><a href="#__codelineno-29-74"> 74</a></span>
<span class="normal"><a href="#__codelineno-29-75"> 75</a></span>
<span class="normal"><a href="#__codelineno-29-76"> 76</a></span>
<span class="normal"><a href="#__codelineno-29-77"> 77</a></span>
<span class="normal"><a href="#__codelineno-29-78"> 78</a></span>
<span class="normal"><a href="#__codelineno-29-79"> 79</a></span>
<span class="normal"><a href="#__codelineno-29-80"> 80</a></span>
<span class="normal"><a href="#__codelineno-29-81"> 81</a></span>
<span class="normal"><a href="#__codelineno-29-82"> 82</a></span>
<span class="normal"><a href="#__codelineno-29-83"> 83</a></span>
<span class="normal"><a href="#__codelineno-29-84"> 84</a></span>
<span class="normal"><a href="#__codelineno-29-85"> 85</a></span>
<span class="normal"><a href="#__codelineno-29-86"> 86</a></span>
<span class="normal"><a href="#__codelineno-29-87"> 87</a></span>
<span class="normal"><a href="#__codelineno-29-88"> 88</a></span>
<span class="normal"><a href="#__codelineno-29-89"> 89</a></span>
<span class="normal"><a href="#__codelineno-29-90"> 90</a></span>
<span class="normal"><a href="#__codelineno-29-91"> 91</a></span>
<span class="normal"><a href="#__codelineno-29-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-29-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-29-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-29-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-29-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-29-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-29-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-29-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-29-100">100</a></span>
<span class="normal"><a href="#__codelineno-29-101">101</a></span>
<span class="normal"><a href="#__codelineno-29-102">102</a></span>
<span class="normal"><a href="#__codelineno-29-103">103</a></span>
<span class="normal"><a href="#__codelineno-29-104">104</a></span>
<span class="normal"><a href="#__codelineno-29-105">105</a></span>
<span class="normal"><a href="#__codelineno-29-106">106</a></span>
<span class="normal"><a href="#__codelineno-29-107">107</a></span>
<span class="normal"><a href="#__codelineno-29-108">108</a></span>
<span class="normal"><a href="#__codelineno-29-109">109</a></span>
<span class="normal"><a href="#__codelineno-29-110">110</a></span>
<span class="normal"><a href="#__codelineno-29-111">111</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-29-1" name="__codelineno-29-1"></a><span class="k">import</span><span class="w"> </span><span class="s1">&#39;dart:convert&#39;</span><span class="p">;</span>
<a id="__codelineno-29-2" name="__codelineno-29-2"></a><span class="k">import</span><span class="w"> </span><span class="s1">&#39;package:flutter/material.dart&#39;</span><span class="p">;</span>
<a id="__codelineno-29-3" name="__codelineno-29-3"></a><span class="k">import</span><span class="w"> </span><span class="s1">&#39;package:flutter/services.dart&#39;</span><span class="p">;</span>
<a id="__codelineno-29-4" name="__codelineno-29-4"></a><span class="k">import</span><span class="w"> </span><span class="s1">&#39;package:shared_preferences/shared_preferences.dart&#39;</span><span class="p">;</span>
<a id="__codelineno-29-5" name="__codelineno-29-5"></a>
<a id="__codelineno-29-6" name="__codelineno-29-6"></a><span class="k">import</span><span class="w"> </span><span class="s1">&#39;../models/product.dart&#39;</span><span class="p">;</span>
<a id="__codelineno-29-7" name="__codelineno-29-7"></a>
<a id="__codelineno-29-8" name="__codelineno-29-8"></a><span class="hll"><span class="kd">class</span><span class="w"> </span><span class="nc">ProductsService</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">ChangeNotifier</span><span class="w"> </span><span class="p">{</span>
</span><a id="__codelineno-29-9" name="__codelineno-29-9"></a><span class="w">  </span><span class="c1">// Lista estática de productos</span>
<a id="__codelineno-29-10" name="__codelineno-29-10"></a><span class="hll"><span class="w">  </span><span class="kd">static</span><span class="w"> </span><span class="n">List</span><span class="o">&lt;</span><span class="n">Product</span><span class="o">&gt;</span><span class="w"> </span><span class="n">products</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[];</span>
</span><a id="__codelineno-29-11" name="__codelineno-29-11"></a>
<a id="__codelineno-29-12" name="__codelineno-29-12"></a><span class="w">  </span><span class="n">ProductsService</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-29-13" name="__codelineno-29-13"></a><span class="w">    </span><span class="c1">// Inicializa la lista de productos</span>
<a id="__codelineno-29-14" name="__codelineno-29-14"></a><span class="hll"><span class="w">    </span><span class="n">loadProducts</span><span class="p">().</span><span class="n">then</span><span class="p">((</span><span class="n">value</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><a id="__codelineno-29-15" name="__codelineno-29-15"></a><span class="w">      </span><span class="n">products</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">value</span><span class="p">;</span>
<a id="__codelineno-29-16" name="__codelineno-29-16"></a><span class="w">      </span><span class="n">notifyListeners</span><span class="p">();</span>
<a id="__codelineno-29-17" name="__codelineno-29-17"></a><span class="w">      </span><span class="c1">// Si no hay productos guardados en el almacenamiento local</span>
<a id="__codelineno-29-18" name="__codelineno-29-18"></a><span class="w">      </span><span class="c1">// se cargan desde el archivo JSON</span>
<a id="__codelineno-29-19" name="__codelineno-29-19"></a><span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">products</span><span class="p">.</span><span class="n">isEmpty</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-29-20" name="__codelineno-29-20"></a><span class="w">        </span><span class="n">readJsonFile</span><span class="p">().</span><span class="n">then</span><span class="p">((</span><span class="n">value</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-29-21" name="__codelineno-29-21"></a><span class="w">          </span><span class="n">products</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">value</span><span class="p">;</span>
<a id="__codelineno-29-22" name="__codelineno-29-22"></a><span class="w">          </span><span class="n">notifyListeners</span><span class="p">();</span>
<a id="__codelineno-29-23" name="__codelineno-29-23"></a><span class="w">        </span><span class="p">});</span>
<a id="__codelineno-29-24" name="__codelineno-29-24"></a><span class="w">      </span><span class="p">}</span>
<a id="__codelineno-29-25" name="__codelineno-29-25"></a><span class="w">    </span><span class="p">});</span>
<a id="__codelineno-29-26" name="__codelineno-29-26"></a><span class="w">  </span><span class="p">}</span>
<a id="__codelineno-29-27" name="__codelineno-29-27"></a>
<a id="__codelineno-29-28" name="__codelineno-29-28"></a><span class="w">  </span><span class="c1">// Carga un nuevo listado de productos</span>
<a id="__codelineno-29-29" name="__codelineno-29-29"></a><span class="hll"><span class="w">  </span><span class="kt">void</span><span class="w"> </span><span class="n">addProducts</span><span class="p">(</span><span class="n">List</span><span class="o">&lt;</span><span class="n">Product</span><span class="o">&gt;</span><span class="w"> </span><span class="n">products</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><a id="__codelineno-29-30" name="__codelineno-29-30"></a><span class="w">    </span><span class="n">products</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">products</span><span class="p">;</span>
<a id="__codelineno-29-31" name="__codelineno-29-31"></a><span class="w">    </span><span class="n">notifyListeners</span><span class="p">();</span>
<a id="__codelineno-29-32" name="__codelineno-29-32"></a><span class="w">  </span><span class="p">}</span>
<a id="__codelineno-29-33" name="__codelineno-29-33"></a>
<a id="__codelineno-29-34" name="__codelineno-29-34"></a><span class="w">  </span><span class="c1">// Añade un nuevo producto a la lista</span>
<a id="__codelineno-29-35" name="__codelineno-29-35"></a><span class="hll"><span class="w">  </span><span class="kt">void</span><span class="w"> </span><span class="n">addProduct</span><span class="p">(</span><span class="n">Product</span><span class="w"> </span><span class="n">product</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><a id="__codelineno-29-36" name="__codelineno-29-36"></a><span class="w">    </span><span class="n">products</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">product</span><span class="p">);</span>
<a id="__codelineno-29-37" name="__codelineno-29-37"></a><span class="w">    </span><span class="n">saveProducts</span><span class="p">(</span><span class="n">products</span><span class="p">);</span>
<a id="__codelineno-29-38" name="__codelineno-29-38"></a><span class="w">    </span><span class="n">notifyListeners</span><span class="p">();</span>
<a id="__codelineno-29-39" name="__codelineno-29-39"></a><span class="w">  </span><span class="p">}</span>
<a id="__codelineno-29-40" name="__codelineno-29-40"></a>
<a id="__codelineno-29-41" name="__codelineno-29-41"></a><span class="w">  </span><span class="c1">// Elimina un producto de la lista</span>
<a id="__codelineno-29-42" name="__codelineno-29-42"></a><span class="hll"><span class="w">  </span><span class="kt">void</span><span class="w"> </span><span class="n">removeProduct</span><span class="p">(</span><span class="n">Product</span><span class="w"> </span><span class="n">product</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><a id="__codelineno-29-43" name="__codelineno-29-43"></a><span class="w">    </span><span class="n">Product</span><span class="w"> </span><span class="n">toDelete</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">getProduct</span><span class="p">(</span><span class="n">product</span><span class="p">.</span><span class="n">id</span><span class="p">);</span>
<a id="__codelineno-29-44" name="__codelineno-29-44"></a><span class="w">    </span><span class="n">products</span><span class="p">.</span><span class="n">remove</span><span class="p">(</span><span class="n">toDelete</span><span class="p">);</span>
<a id="__codelineno-29-45" name="__codelineno-29-45"></a><span class="w">    </span><span class="n">saveProducts</span><span class="p">(</span><span class="n">products</span><span class="p">);</span>
<a id="__codelineno-29-46" name="__codelineno-29-46"></a><span class="w">    </span><span class="n">notifyListeners</span><span class="p">();</span>
<a id="__codelineno-29-47" name="__codelineno-29-47"></a><span class="w">  </span><span class="p">}</span>
<a id="__codelineno-29-48" name="__codelineno-29-48"></a>
<a id="__codelineno-29-49" name="__codelineno-29-49"></a><span class="w">  </span><span class="c1">// Obtiene un producto de la lista</span>
<a id="__codelineno-29-50" name="__codelineno-29-50"></a><span class="hll"><span class="w">  </span><span class="n">Product</span><span class="w"> </span><span class="n">getProduct</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">id</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><a id="__codelineno-29-51" name="__codelineno-29-51"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">products</span><span class="p">.</span><span class="n">firstWhere</span><span class="p">((</span><span class="n">element</span><span class="p">)</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">element</span><span class="p">.</span><span class="n">id</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">id</span><span class="p">);</span>
<a id="__codelineno-29-52" name="__codelineno-29-52"></a><span class="w">  </span><span class="p">}</span>
<a id="__codelineno-29-53" name="__codelineno-29-53"></a>
<a id="__codelineno-29-54" name="__codelineno-29-54"></a><span class="w">  </span><span class="c1">// Modifica un producto de la lista</span>
<a id="__codelineno-29-55" name="__codelineno-29-55"></a><span class="hll"><span class="w">  </span><span class="kt">void</span><span class="w"> </span><span class="n">modifyProduct</span><span class="p">(</span><span class="n">Product</span><span class="w"> </span><span class="n">product</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><a id="__codelineno-29-56" name="__codelineno-29-56"></a><span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">index</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">products</span><span class="p">.</span><span class="n">indexWhere</span><span class="p">((</span><span class="n">element</span><span class="p">)</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">element</span><span class="p">.</span><span class="n">id</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">product</span><span class="p">.</span><span class="n">id</span><span class="p">);</span>
<a id="__codelineno-29-57" name="__codelineno-29-57"></a><span class="w">    </span><span class="n">products</span><span class="p">[</span><span class="n">index</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">product</span><span class="p">;</span>
<a id="__codelineno-29-58" name="__codelineno-29-58"></a><span class="w">    </span><span class="n">saveProducts</span><span class="p">(</span><span class="n">products</span><span class="p">);</span>
<a id="__codelineno-29-59" name="__codelineno-29-59"></a><span class="w">    </span><span class="n">notifyListeners</span><span class="p">();</span>
<a id="__codelineno-29-60" name="__codelineno-29-60"></a><span class="w">  </span><span class="p">}</span>
<a id="__codelineno-29-61" name="__codelineno-29-61"></a>
<a id="__codelineno-29-62" name="__codelineno-29-62"></a><span class="w">  </span><span class="c1">// Lee el archivo JSON de productos</span>
<a id="__codelineno-29-63" name="__codelineno-29-63"></a><span class="w">  </span><span class="n">Future</span><span class="o">&lt;</span><span class="n">List</span><span class="o">&lt;</span><span class="n">Product</span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">readJsonFile</span><span class="p">()</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-29-64" name="__codelineno-29-64"></a><span class="w">    </span><span class="kt">String</span><span class="w"> </span><span class="n">jsonString</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">await</span><span class="w"> </span><span class="n">rootBundle</span><span class="p">.</span><span class="n">loadString</span><span class="p">(</span><span class="s1">&#39;assets/products.json&#39;</span><span class="p">);</span>
<a id="__codelineno-29-65" name="__codelineno-29-65"></a>
<a id="__codelineno-29-66" name="__codelineno-29-66"></a><span class="w">    </span><span class="n">List</span><span class="w"> </span><span class="n">jsonList</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">jsonDecode</span><span class="p">(</span><span class="n">jsonString</span><span class="p">);</span>
<a id="__codelineno-29-67" name="__codelineno-29-67"></a>
<a id="__codelineno-29-68" name="__codelineno-29-68"></a><span class="w">    </span><span class="n">List</span><span class="o">&lt;</span><span class="n">Product</span><span class="o">&gt;</span><span class="w"> </span><span class="n">products</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[];</span>
<a id="__codelineno-29-69" name="__codelineno-29-69"></a><span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kd">var</span><span class="w"> </span><span class="n">item</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">jsonList</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-29-70" name="__codelineno-29-70"></a><span class="w">      </span><span class="n">Product</span><span class="w"> </span><span class="n">product</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Product</span><span class="p">.</span><span class="n">fromJson</span><span class="p">(</span><span class="n">item</span><span class="p">);</span>
<a id="__codelineno-29-71" name="__codelineno-29-71"></a><span class="w">      </span><span class="n">products</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">product</span><span class="p">);</span>
<a id="__codelineno-29-72" name="__codelineno-29-72"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-29-73" name="__codelineno-29-73"></a>
<a id="__codelineno-29-74" name="__codelineno-29-74"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">products</span><span class="p">;</span>
<a id="__codelineno-29-75" name="__codelineno-29-75"></a><span class="w">  </span><span class="p">}</span>
<a id="__codelineno-29-76" name="__codelineno-29-76"></a>
<a id="__codelineno-29-77" name="__codelineno-29-77"></a><span class="w">  </span><span class="c1">// Guarda los productos en el almacenamiento local</span>
<a id="__codelineno-29-78" name="__codelineno-29-78"></a><span class="hll"><span class="w">  </span><span class="n">Future</span><span class="w"> </span><span class="n">saveProducts</span><span class="p">(</span><span class="n">List</span><span class="o">&lt;</span><span class="n">Product</span><span class="o">&gt;</span><span class="w"> </span><span class="n">products</span><span class="p">)</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="p">{</span>
</span><a id="__codelineno-29-79" name="__codelineno-29-79"></a><span class="w">    </span><span class="n">SharedPreferences</span><span class="w"> </span><span class="n">prefs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">await</span><span class="w"> </span><span class="n">SharedPreferences</span><span class="p">.</span><span class="n">getInstance</span><span class="p">();</span>
<a id="__codelineno-29-80" name="__codelineno-29-80"></a><span class="w">    </span><span class="kd">await</span><span class="w"> </span><span class="n">prefs</span><span class="p">.</span><span class="n">setString</span><span class="p">(</span><span class="s1">&#39;products&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">convertToJSON</span><span class="p">(</span><span class="n">products</span><span class="p">));</span>
<a id="__codelineno-29-81" name="__codelineno-29-81"></a><span class="w">  </span><span class="p">}</span>
<a id="__codelineno-29-82" name="__codelineno-29-82"></a>
<a id="__codelineno-29-83" name="__codelineno-29-83"></a><span class="w">  </span><span class="c1">// Carga los productos del almacenamiento local</span>
<a id="__codelineno-29-84" name="__codelineno-29-84"></a><span class="hll"><span class="w">  </span><span class="n">Future</span><span class="o">&lt;</span><span class="n">List</span><span class="o">&lt;</span><span class="n">Product</span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">loadProducts</span><span class="p">()</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="p">{</span>
</span><a id="__codelineno-29-85" name="__codelineno-29-85"></a><span class="w">    </span><span class="n">SharedPreferences</span><span class="w"> </span><span class="n">prefs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">await</span><span class="w"> </span><span class="n">SharedPreferences</span><span class="p">.</span><span class="n">getInstance</span><span class="p">();</span>
<a id="__codelineno-29-86" name="__codelineno-29-86"></a><span class="w">    </span><span class="kt">String</span><span class="o">?</span><span class="w"> </span><span class="n">jsonString</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">prefs</span><span class="p">.</span><span class="n">getString</span><span class="p">(</span><span class="s1">&#39;products&#39;</span><span class="p">);</span>
<a id="__codelineno-29-87" name="__codelineno-29-87"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">jsonString</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">null</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">jsonString</span><span class="p">.</span><span class="n">isNotEmpty</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-29-88" name="__codelineno-29-88"></a><span class="w">      </span><span class="n">List</span><span class="w"> </span><span class="n">jsonList</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">jsonDecode</span><span class="p">(</span><span class="n">jsonString</span><span class="p">);</span>
<a id="__codelineno-29-89" name="__codelineno-29-89"></a><span class="w">      </span><span class="n">List</span><span class="o">&lt;</span><span class="n">Product</span><span class="o">&gt;</span><span class="w"> </span><span class="n">products</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[];</span>
<a id="__codelineno-29-90" name="__codelineno-29-90"></a><span class="w">      </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kd">var</span><span class="w"> </span><span class="n">item</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">jsonList</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-29-91" name="__codelineno-29-91"></a><span class="w">        </span><span class="n">Product</span><span class="w"> </span><span class="n">product</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Product</span><span class="p">.</span><span class="n">fromJson</span><span class="p">(</span><span class="n">item</span><span class="p">);</span>
<a id="__codelineno-29-92" name="__codelineno-29-92"></a><span class="w">        </span><span class="n">products</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">product</span><span class="p">);</span>
<a id="__codelineno-29-93" name="__codelineno-29-93"></a><span class="w">      </span><span class="p">}</span>
<a id="__codelineno-29-94" name="__codelineno-29-94"></a><span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="n">products</span><span class="p">;</span>
<a id="__codelineno-29-95" name="__codelineno-29-95"></a><span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-29-96" name="__codelineno-29-96"></a><span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="p">[];</span>
<a id="__codelineno-29-97" name="__codelineno-29-97"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-29-98" name="__codelineno-29-98"></a><span class="w">  </span><span class="p">}</span>
<a id="__codelineno-29-99" name="__codelineno-29-99"></a>
<a id="__codelineno-29-100" name="__codelineno-29-100"></a><span class="w">  </span><span class="c1">// Elimina todos los productos del almacenamiento local</span>
<a id="__codelineno-29-101" name="__codelineno-29-101"></a><span class="hll"><span class="w">  </span><span class="n">Future</span><span class="w"> </span><span class="n">clearProducts</span><span class="p">()</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="p">{</span>
</span><a id="__codelineno-29-102" name="__codelineno-29-102"></a><span class="w">    </span><span class="n">SharedPreferences</span><span class="w"> </span><span class="n">prefs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">await</span><span class="w"> </span><span class="n">SharedPreferences</span><span class="p">.</span><span class="n">getInstance</span><span class="p">();</span>
<a id="__codelineno-29-103" name="__codelineno-29-103"></a><span class="w">    </span><span class="kd">await</span><span class="w"> </span><span class="n">prefs</span><span class="p">.</span><span class="n">remove</span><span class="p">(</span><span class="s1">&#39;products&#39;</span><span class="p">);</span>
<a id="__codelineno-29-104" name="__codelineno-29-104"></a><span class="w">    </span><span class="n">products</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[];</span>
<a id="__codelineno-29-105" name="__codelineno-29-105"></a><span class="w">    </span><span class="n">notifyListeners</span><span class="p">();</span>
<a id="__codelineno-29-106" name="__codelineno-29-106"></a><span class="w">  </span><span class="p">}</span>
<a id="__codelineno-29-107" name="__codelineno-29-107"></a>
<a id="__codelineno-29-108" name="__codelineno-29-108"></a><span class="w">  </span><span class="kt">String</span><span class="w"> </span><span class="n">convertToJSON</span><span class="p">(</span><span class="n">List</span><span class="o">&lt;</span><span class="n">Product</span><span class="o">&gt;</span><span class="w"> </span><span class="n">products</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-29-109" name="__codelineno-29-109"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">jsonEncode</span><span class="p">(</span><span class="n">products</span><span class="p">);</span>
<a id="__codelineno-29-110" name="__codelineno-29-110"></a><span class="w">  </span><span class="p">}</span>
<a id="__codelineno-29-111" name="__codelineno-29-111"></a><span class="p">}</span>
</code></pre></div></td></tr></table></div>
<p>En el constructor de <code>ProductsService</code> se carga la lista de productos del almacenamiento local. Si no hay productos guardados, se cargan desde el archivo JSON.</p>
<p>Para guardar los productos en el almacenamiento local se utiliza el método <code>saveProducts</code> y para obtener los productos se utiliza el método <code>loadProducts</code>.</p>
<p>Ahora se va a modificar la vista principal para que cargue los productos desde <code>ProductsService</code>. En el método <code>initState</code> se crea una instancia de <code>ProductsService</code> y se añade un <code>Consumer</code> para escuchar los cambios en la lista de productos.</p>
<div class="highlight"><span class="filename">lib/main.dart</span><pre><span></span><code><a id="__codelineno-30-1" name="__codelineno-30-1" href="#__codelineno-30-1"></a><span class="p">...</span>
<a id="__codelineno-30-2" name="__codelineno-30-2" href="#__codelineno-30-2"></a><span class="kd">class</span><span class="w"> </span><span class="nc">_ProductsState</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">State</span><span class="o">&lt;</span><span class="n">Products</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-30-3" name="__codelineno-30-3" href="#__codelineno-30-3"></a><span class="hll"><span class="w">  </span><span class="kd">final</span><span class="w"> </span><span class="n">ProductsService</span><span class="w"> </span><span class="n">productsNotifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ProductsService</span><span class="p">();</span>
</span><a id="__codelineno-30-4" name="__codelineno-30-4" href="#__codelineno-30-4"></a>
<a id="__codelineno-30-5" name="__codelineno-30-5" href="#__codelineno-30-5"></a><span class="w">  </span><span class="nd">@override</span>
<a id="__codelineno-30-6" name="__codelineno-30-6" href="#__codelineno-30-6"></a><span class="w">  </span><span class="n">Widget</span><span class="w"> </span><span class="n">build</span><span class="p">(</span><span class="n">BuildContext</span><span class="w"> </span><span class="n">context</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-30-7" name="__codelineno-30-7" href="#__codelineno-30-7"></a><span class="hll"><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">ChangeNotifierProvider</span><span class="p">(</span>
</span><a id="__codelineno-30-8" name="__codelineno-30-8" href="#__codelineno-30-8"></a><span class="hll"><span class="w">        </span><span class="nl">create:</span><span class="w"> </span><span class="p">(</span><span class="n">_</span><span class="p">)</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">ProductsService</span><span class="p">(),</span>
</span><a id="__codelineno-30-9" name="__codelineno-30-9" href="#__codelineno-30-9"></a><span class="hll"><span class="w">        </span><span class="nl">builder:</span><span class="w"> </span><span class="p">(</span><span class="n">context</span><span class="p">,</span><span class="w"> </span><span class="n">provider</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><a id="__codelineno-30-10" name="__codelineno-30-10" href="#__codelineno-30-10"></a><span class="hll"><span class="w">          </span><span class="k">return</span><span class="w"> </span><span class="n">Consumer</span><span class="o">&lt;</span><span class="n">ProductsService</span><span class="o">&gt;</span><span class="p">(</span><span class="nl">builder:</span><span class="w"> </span><span class="p">(</span><span class="n">context</span><span class="p">,</span><span class="w"> </span><span class="n">notifier</span><span class="p">,</span><span class="w"> </span><span class="n">child</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><a id="__codelineno-30-11" name="__codelineno-30-11" href="#__codelineno-30-11"></a><span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">Scaffold</span><span class="p">(</span>
<a id="__codelineno-30-12" name="__codelineno-30-12" href="#__codelineno-30-12"></a><span class="w">                </span><span class="nl">appBar:</span><span class="w"> </span><span class="n">AppBar</span><span class="p">(</span>
<a id="__codelineno-30-13" name="__codelineno-30-13" href="#__codelineno-30-13"></a><span class="w">                  </span><span class="nl">title:</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span><span class="s1">&#39;Productos&#39;</span><span class="p">),</span>
<a id="__codelineno-30-14" name="__codelineno-30-14" href="#__codelineno-30-14"></a><span class="w">                </span><span class="p">),</span>
<a id="__codelineno-30-15" name="__codelineno-30-15" href="#__codelineno-30-15"></a><span class="w">                </span><span class="nl">body:</span><span class="w"> </span><span class="n">ListView</span><span class="p">.</span><span class="n">builder</span><span class="p">(</span>
<a id="__codelineno-30-16" name="__codelineno-30-16" href="#__codelineno-30-16"></a><span class="hll"><span class="w">                  </span><span class="nl">itemCount:</span><span class="w"> </span><span class="n">ProductsService</span><span class="p">.</span><span class="n">products</span><span class="p">.</span><span class="n">length</span><span class="p">,</span>
</span><a id="__codelineno-30-17" name="__codelineno-30-17" href="#__codelineno-30-17"></a><span class="w">                  </span><span class="nl">itemBuilder:</span><span class="w"> </span><span class="p">(</span><span class="n">context</span><span class="p">,</span><span class="w"> </span><span class="n">index</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-30-18" name="__codelineno-30-18" href="#__codelineno-30-18"></a><span class="hll"><span class="w">                    </span><span class="kd">final</span><span class="w"> </span><span class="n">product</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ProductsService</span><span class="p">.</span><span class="n">products</span><span class="p">[</span><span class="n">index</span><span class="p">];</span>
</span><a id="__codelineno-30-19" name="__codelineno-30-19" href="#__codelineno-30-19"></a><span class="w">                    </span><span class="k">return</span><span class="w"> </span><span class="n">ListTile</span><span class="p">(</span>
<a id="__codelineno-30-20" name="__codelineno-30-20" href="#__codelineno-30-20"></a><span class="w">                      </span><span class="nl">onTap:</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="p">},</span>
<a id="__codelineno-30-21" name="__codelineno-30-21" href="#__codelineno-30-21"></a><span class="w">                      </span><span class="nl">leading:</span><span class="w"> </span><span class="n">product</span><span class="p">.</span><span class="n">imageUrl</span><span class="p">.</span><span class="n">isNotEmpty</span>
<a id="__codelineno-30-22" name="__codelineno-30-22" href="#__codelineno-30-22"></a><span class="w">                          </span><span class="o">?</span><span class="w"> </span><span class="p">(</span><span class="n">Uri</span><span class="p">.</span><span class="n">parse</span><span class="p">(</span><span class="n">product</span><span class="p">.</span><span class="n">imageUrl</span><span class="p">).</span><span class="n">isAbsolute</span>
<a id="__codelineno-30-23" name="__codelineno-30-23" href="#__codelineno-30-23"></a><span class="w">                              </span><span class="o">?</span><span class="w"> </span><span class="n">Image</span><span class="p">.</span><span class="n">network</span><span class="p">(</span><span class="n">product</span><span class="p">.</span><span class="n">imageUrl</span><span class="p">,</span>
<a id="__codelineno-30-24" name="__codelineno-30-24" href="#__codelineno-30-24"></a><span class="w">                                  </span><span class="nl">fit:</span><span class="w"> </span><span class="n">BoxFit</span><span class="p">.</span><span class="n">cover</span><span class="p">,</span><span class="w"> </span><span class="nl">width:</span><span class="w"> </span><span class="m">50</span><span class="p">,</span><span class="w"> </span><span class="nl">height:</span><span class="w"> </span><span class="m">50</span><span class="p">)</span>
<a id="__codelineno-30-25" name="__codelineno-30-25" href="#__codelineno-30-25"></a><span class="w">                              </span><span class="o">:</span><span class="w"> </span><span class="n">Image</span><span class="p">.</span><span class="n">file</span><span class="p">(</span><span class="n">File</span><span class="p">(</span><span class="n">product</span><span class="p">.</span><span class="n">imageUrl</span><span class="p">),</span>
<a id="__codelineno-30-26" name="__codelineno-30-26" href="#__codelineno-30-26"></a><span class="w">                                  </span><span class="nl">fit:</span><span class="w"> </span><span class="n">BoxFit</span><span class="p">.</span><span class="n">cover</span><span class="p">,</span><span class="w"> </span><span class="nl">width:</span><span class="w"> </span><span class="m">50</span><span class="p">,</span><span class="w"> </span><span class="nl">height:</span><span class="w"> </span><span class="m">50</span><span class="p">))</span>
<a id="__codelineno-30-27" name="__codelineno-30-27" href="#__codelineno-30-27"></a><span class="w">                          </span><span class="o">:</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">Icon</span><span class="p">(</span><span class="n">Icons</span><span class="p">.</span><span class="n">image_outlined</span><span class="p">,</span><span class="w"> </span><span class="nl">size:</span><span class="w"> </span><span class="m">50</span><span class="p">),</span>
<a id="__codelineno-30-28" name="__codelineno-30-28" href="#__codelineno-30-28"></a><span class="w">                      </span><span class="nl">title:</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span><span class="n">product</span><span class="p">.</span><span class="n">description</span><span class="p">),</span>
<a id="__codelineno-30-29" name="__codelineno-30-29" href="#__codelineno-30-29"></a><span class="w">                      </span><span class="nl">subtitle:</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span><span class="n">product</span><span class="p">.</span><span class="n">price</span><span class="p">.</span><span class="n">toString</span><span class="p">()),</span>
<a id="__codelineno-30-30" name="__codelineno-30-30" href="#__codelineno-30-30"></a><span class="w">                      </span><span class="nl">trailing:</span><span class="w"> </span><span class="n">Row</span><span class="p">(</span>
<a id="__codelineno-30-31" name="__codelineno-30-31" href="#__codelineno-30-31"></a><span class="w">                        </span><span class="nl">mainAxisSize:</span><span class="w"> </span><span class="n">MainAxisSize</span><span class="p">.</span><span class="n">min</span><span class="p">,</span>
<a id="__codelineno-30-32" name="__codelineno-30-32" href="#__codelineno-30-32"></a><span class="w">                        </span><span class="nl">children:</span><span class="w"> </span><span class="p">[</span>
<a id="__codelineno-30-33" name="__codelineno-30-33" href="#__codelineno-30-33"></a><span class="w">                          </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kd">var</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">product</span><span class="p">.</span><span class="n">rating</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span>
<a id="__codelineno-30-34" name="__codelineno-30-34" href="#__codelineno-30-34"></a><span class="w">                            </span><span class="k">const</span><span class="w"> </span><span class="n">Icon</span><span class="p">(</span><span class="n">Icons</span><span class="p">.</span><span class="n">star</span><span class="p">,</span>
<a id="__codelineno-30-35" name="__codelineno-30-35" href="#__codelineno-30-35"></a><span class="w">                                </span><span class="nl">color:</span><span class="w"> </span><span class="n">Colors</span><span class="p">.</span><span class="n">amber</span><span class="p">,</span><span class="w"> </span><span class="nl">size:</span><span class="w"> </span><span class="m">14</span><span class="p">),</span>
<a id="__codelineno-30-36" name="__codelineno-30-36" href="#__codelineno-30-36"></a><span class="w">                          </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kd">var</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="m">5</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">product</span><span class="p">.</span><span class="n">rating</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span>
<a id="__codelineno-30-37" name="__codelineno-30-37" href="#__codelineno-30-37"></a><span class="w">                            </span><span class="k">const</span><span class="w"> </span><span class="n">Icon</span><span class="p">(</span><span class="n">Icons</span><span class="p">.</span><span class="n">star</span><span class="p">,</span>
<a id="__codelineno-30-38" name="__codelineno-30-38" href="#__codelineno-30-38"></a><span class="w">                                </span><span class="nl">color:</span><span class="w"> </span><span class="n">Colors</span><span class="p">.</span><span class="n">grey</span><span class="p">,</span><span class="w"> </span><span class="nl">size:</span><span class="w"> </span><span class="m">14</span><span class="p">),</span>
<a id="__codelineno-30-39" name="__codelineno-30-39" href="#__codelineno-30-39"></a><span class="w">                        </span><span class="p">],</span>
<a id="__codelineno-30-40" name="__codelineno-30-40" href="#__codelineno-30-40"></a><span class="w">                      </span><span class="p">),</span>
<a id="__codelineno-30-41" name="__codelineno-30-41" href="#__codelineno-30-41"></a><span class="w">                    </span><span class="p">);</span>
<a id="__codelineno-30-42" name="__codelineno-30-42" href="#__codelineno-30-42"></a><span class="w">                  </span><span class="p">},</span>
<a id="__codelineno-30-43" name="__codelineno-30-43" href="#__codelineno-30-43"></a><span class="w">                </span><span class="p">));</span>
<a id="__codelineno-30-44" name="__codelineno-30-44" href="#__codelineno-30-44"></a><span class="w">          </span><span class="p">});</span>
<a id="__codelineno-30-45" name="__codelineno-30-45" href="#__codelineno-30-45"></a><span class="w">        </span><span class="p">});</span>
<a id="__codelineno-30-46" name="__codelineno-30-46" href="#__codelineno-30-46"></a><span class="w">  </span><span class="p">}</span>
<a id="__codelineno-30-47" name="__codelineno-30-47" href="#__codelineno-30-47"></a><span class="p">}</span>
</code></pre></div>
<h3 id="anadir-un-nuevo-producto">Añadir un nuevo producto<a class="headerlink" href="#anadir-un-nuevo-producto" title="Permanent link">&para;</a></h3>
<p>Para añadir un nuevo producto se va a crear una nueva vista <code>ProductAdd</code> en <code>pages/product_add.dart</code>. Utiliza el paquete <code>image_picker</code> para seleccionar una imagen, por lo que deberemos importarlo previamente:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-31-1" name="__codelineno-31-1" href="#__codelineno-31-1"></a>flutter<span class="w"> </span>pub<span class="w"> </span>add<span class="w"> </span>image_picker
<a id="__codelineno-31-2" name="__codelineno-31-2" href="#__codelineno-31-2"></a>flutter<span class="w"> </span>pub<span class="w"> </span>get
</code></pre></div>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">lib/pages/product_add.dart</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-32-1">  1</a></span>
<span class="normal"><a href="#__codelineno-32-2">  2</a></span>
<span class="normal"><a href="#__codelineno-32-3">  3</a></span>
<span class="normal"><a href="#__codelineno-32-4">  4</a></span>
<span class="normal"><a href="#__codelineno-32-5">  5</a></span>
<span class="normal"><a href="#__codelineno-32-6">  6</a></span>
<span class="normal"><a href="#__codelineno-32-7">  7</a></span>
<span class="normal"><a href="#__codelineno-32-8">  8</a></span>
<span class="normal"><a href="#__codelineno-32-9">  9</a></span>
<span class="normal"><a href="#__codelineno-32-10"> 10</a></span>
<span class="normal"><a href="#__codelineno-32-11"> 11</a></span>
<span class="normal"><a href="#__codelineno-32-12"> 12</a></span>
<span class="normal"><a href="#__codelineno-32-13"> 13</a></span>
<span class="normal"><a href="#__codelineno-32-14"> 14</a></span>
<span class="normal"><a href="#__codelineno-32-15"> 15</a></span>
<span class="normal"><a href="#__codelineno-32-16"> 16</a></span>
<span class="normal"><a href="#__codelineno-32-17"> 17</a></span>
<span class="normal"><a href="#__codelineno-32-18"> 18</a></span>
<span class="normal"><a href="#__codelineno-32-19"> 19</a></span>
<span class="normal"><a href="#__codelineno-32-20"> 20</a></span>
<span class="normal"><a href="#__codelineno-32-21"> 21</a></span>
<span class="normal"><a href="#__codelineno-32-22"> 22</a></span>
<span class="normal"><a href="#__codelineno-32-23"> 23</a></span>
<span class="normal"><a href="#__codelineno-32-24"> 24</a></span>
<span class="normal"><a href="#__codelineno-32-25"> 25</a></span>
<span class="normal"><a href="#__codelineno-32-26"> 26</a></span>
<span class="normal"><a href="#__codelineno-32-27"> 27</a></span>
<span class="normal"><a href="#__codelineno-32-28"> 28</a></span>
<span class="normal"><a href="#__codelineno-32-29"> 29</a></span>
<span class="normal"><a href="#__codelineno-32-30"> 30</a></span>
<span class="normal"><a href="#__codelineno-32-31"> 31</a></span>
<span class="normal"><a href="#__codelineno-32-32"> 32</a></span>
<span class="normal"><a href="#__codelineno-32-33"> 33</a></span>
<span class="normal"><a href="#__codelineno-32-34"> 34</a></span>
<span class="normal"><a href="#__codelineno-32-35"> 35</a></span>
<span class="normal"><a href="#__codelineno-32-36"> 36</a></span>
<span class="normal"><a href="#__codelineno-32-37"> 37</a></span>
<span class="normal"><a href="#__codelineno-32-38"> 38</a></span>
<span class="normal"><a href="#__codelineno-32-39"> 39</a></span>
<span class="normal"><a href="#__codelineno-32-40"> 40</a></span>
<span class="normal"><a href="#__codelineno-32-41"> 41</a></span>
<span class="normal"><a href="#__codelineno-32-42"> 42</a></span>
<span class="normal"><a href="#__codelineno-32-43"> 43</a></span>
<span class="normal"><a href="#__codelineno-32-44"> 44</a></span>
<span class="normal"><a href="#__codelineno-32-45"> 45</a></span>
<span class="normal"><a href="#__codelineno-32-46"> 46</a></span>
<span class="normal"><a href="#__codelineno-32-47"> 47</a></span>
<span class="normal"><a href="#__codelineno-32-48"> 48</a></span>
<span class="normal"><a href="#__codelineno-32-49"> 49</a></span>
<span class="normal"><a href="#__codelineno-32-50"> 50</a></span>
<span class="normal"><a href="#__codelineno-32-51"> 51</a></span>
<span class="normal"><a href="#__codelineno-32-52"> 52</a></span>
<span class="normal"><a href="#__codelineno-32-53"> 53</a></span>
<span class="normal"><a href="#__codelineno-32-54"> 54</a></span>
<span class="normal"><a href="#__codelineno-32-55"> 55</a></span>
<span class="normal"><a href="#__codelineno-32-56"> 56</a></span>
<span class="normal"><a href="#__codelineno-32-57"> 57</a></span>
<span class="normal"><a href="#__codelineno-32-58"> 58</a></span>
<span class="normal"><a href="#__codelineno-32-59"> 59</a></span>
<span class="normal"><a href="#__codelineno-32-60"> 60</a></span>
<span class="normal"><a href="#__codelineno-32-61"> 61</a></span>
<span class="normal"><a href="#__codelineno-32-62"> 62</a></span>
<span class="normal"><a href="#__codelineno-32-63"> 63</a></span>
<span class="normal"><a href="#__codelineno-32-64"> 64</a></span>
<span class="normal"><a href="#__codelineno-32-65"> 65</a></span>
<span class="normal"><a href="#__codelineno-32-66"> 66</a></span>
<span class="normal"><a href="#__codelineno-32-67"> 67</a></span>
<span class="normal"><a href="#__codelineno-32-68"> 68</a></span>
<span class="normal"><a href="#__codelineno-32-69"> 69</a></span>
<span class="normal"><a href="#__codelineno-32-70"> 70</a></span>
<span class="normal"><a href="#__codelineno-32-71"> 71</a></span>
<span class="normal"><a href="#__codelineno-32-72"> 72</a></span>
<span class="normal"><a href="#__codelineno-32-73"> 73</a></span>
<span class="normal"><a href="#__codelineno-32-74"> 74</a></span>
<span class="normal"><a href="#__codelineno-32-75"> 75</a></span>
<span class="normal"><a href="#__codelineno-32-76"> 76</a></span>
<span class="normal"><a href="#__codelineno-32-77"> 77</a></span>
<span class="normal"><a href="#__codelineno-32-78"> 78</a></span>
<span class="normal"><a href="#__codelineno-32-79"> 79</a></span>
<span class="normal"><a href="#__codelineno-32-80"> 80</a></span>
<span class="normal"><a href="#__codelineno-32-81"> 81</a></span>
<span class="normal"><a href="#__codelineno-32-82"> 82</a></span>
<span class="normal"><a href="#__codelineno-32-83"> 83</a></span>
<span class="normal"><a href="#__codelineno-32-84"> 84</a></span>
<span class="normal"><a href="#__codelineno-32-85"> 85</a></span>
<span class="normal"><a href="#__codelineno-32-86"> 86</a></span>
<span class="normal"><a href="#__codelineno-32-87"> 87</a></span>
<span class="normal"><a href="#__codelineno-32-88"> 88</a></span>
<span class="normal"><a href="#__codelineno-32-89"> 89</a></span>
<span class="normal"><a href="#__codelineno-32-90"> 90</a></span>
<span class="normal"><a href="#__codelineno-32-91"> 91</a></span>
<span class="normal"><a href="#__codelineno-32-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-32-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-32-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-32-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-32-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-32-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-32-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-32-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-32-100">100</a></span>
<span class="normal"><a href="#__codelineno-32-101">101</a></span>
<span class="normal"><a href="#__codelineno-32-102">102</a></span>
<span class="normal"><a href="#__codelineno-32-103">103</a></span>
<span class="normal"><a href="#__codelineno-32-104">104</a></span>
<span class="normal"><a href="#__codelineno-32-105">105</a></span>
<span class="normal"><a href="#__codelineno-32-106">106</a></span>
<span class="normal"><a href="#__codelineno-32-107">107</a></span>
<span class="normal"><a href="#__codelineno-32-108">108</a></span>
<span class="normal"><a href="#__codelineno-32-109">109</a></span>
<span class="normal"><a href="#__codelineno-32-110">110</a></span>
<span class="normal"><a href="#__codelineno-32-111">111</a></span>
<span class="normal"><a href="#__codelineno-32-112">112</a></span>
<span class="normal"><a href="#__codelineno-32-113">113</a></span>
<span class="normal"><a href="#__codelineno-32-114">114</a></span>
<span class="normal"><a href="#__codelineno-32-115">115</a></span>
<span class="normal"><a href="#__codelineno-32-116">116</a></span>
<span class="normal"><a href="#__codelineno-32-117">117</a></span>
<span class="normal"><a href="#__codelineno-32-118">118</a></span>
<span class="normal"><a href="#__codelineno-32-119">119</a></span>
<span class="normal"><a href="#__codelineno-32-120">120</a></span>
<span class="normal"><a href="#__codelineno-32-121">121</a></span>
<span class="normal"><a href="#__codelineno-32-122">122</a></span>
<span class="normal"><a href="#__codelineno-32-123">123</a></span>
<span class="normal"><a href="#__codelineno-32-124">124</a></span>
<span class="normal"><a href="#__codelineno-32-125">125</a></span>
<span class="normal"><a href="#__codelineno-32-126">126</a></span>
<span class="normal"><a href="#__codelineno-32-127">127</a></span>
<span class="normal"><a href="#__codelineno-32-128">128</a></span>
<span class="normal"><a href="#__codelineno-32-129">129</a></span>
<span class="normal"><a href="#__codelineno-32-130">130</a></span>
<span class="normal"><a href="#__codelineno-32-131">131</a></span>
<span class="normal"><a href="#__codelineno-32-132">132</a></span>
<span class="normal"><a href="#__codelineno-32-133">133</a></span>
<span class="normal"><a href="#__codelineno-32-134">134</a></span>
<span class="normal"><a href="#__codelineno-32-135">135</a></span>
<span class="normal"><a href="#__codelineno-32-136">136</a></span>
<span class="normal"><a href="#__codelineno-32-137">137</a></span>
<span class="normal"><a href="#__codelineno-32-138">138</a></span>
<span class="normal"><a href="#__codelineno-32-139">139</a></span>
<span class="normal"><a href="#__codelineno-32-140">140</a></span>
<span class="normal"><a href="#__codelineno-32-141">141</a></span>
<span class="normal"><a href="#__codelineno-32-142">142</a></span>
<span class="normal"><a href="#__codelineno-32-143">143</a></span>
<span class="normal"><a href="#__codelineno-32-144">144</a></span>
<span class="normal"><a href="#__codelineno-32-145">145</a></span>
<span class="normal"><a href="#__codelineno-32-146">146</a></span>
<span class="normal"><a href="#__codelineno-32-147">147</a></span>
<span class="normal"><a href="#__codelineno-32-148">148</a></span>
<span class="normal"><a href="#__codelineno-32-149">149</a></span>
<span class="normal"><a href="#__codelineno-32-150">150</a></span>
<span class="normal"><a href="#__codelineno-32-151">151</a></span>
<span class="normal"><a href="#__codelineno-32-152">152</a></span>
<span class="normal"><a href="#__codelineno-32-153">153</a></span>
<span class="normal"><a href="#__codelineno-32-154">154</a></span>
<span class="normal"><a href="#__codelineno-32-155">155</a></span>
<span class="normal"><a href="#__codelineno-32-156">156</a></span>
<span class="normal"><a href="#__codelineno-32-157">157</a></span>
<span class="normal"><a href="#__codelineno-32-158">158</a></span>
<span class="normal"><a href="#__codelineno-32-159">159</a></span>
<span class="normal"><a href="#__codelineno-32-160">160</a></span>
<span class="normal"><a href="#__codelineno-32-161">161</a></span>
<span class="normal"><a href="#__codelineno-32-162">162</a></span>
<span class="normal"><a href="#__codelineno-32-163">163</a></span>
<span class="normal"><a href="#__codelineno-32-164">164</a></span>
<span class="normal"><a href="#__codelineno-32-165">165</a></span>
<span class="normal"><a href="#__codelineno-32-166">166</a></span>
<span class="normal"><a href="#__codelineno-32-167">167</a></span>
<span class="normal"><a href="#__codelineno-32-168">168</a></span>
<span class="normal"><a href="#__codelineno-32-169">169</a></span>
<span class="normal"><a href="#__codelineno-32-170">170</a></span>
<span class="normal"><a href="#__codelineno-32-171">171</a></span>
<span class="normal"><a href="#__codelineno-32-172">172</a></span>
<span class="normal"><a href="#__codelineno-32-173">173</a></span>
<span class="normal"><a href="#__codelineno-32-174">174</a></span>
<span class="normal"><a href="#__codelineno-32-175">175</a></span>
<span class="normal"><a href="#__codelineno-32-176">176</a></span>
<span class="normal"><a href="#__codelineno-32-177">177</a></span>
<span class="normal"><a href="#__codelineno-32-178">178</a></span>
<span class="normal"><a href="#__codelineno-32-179">179</a></span>
<span class="normal"><a href="#__codelineno-32-180">180</a></span>
<span class="normal"><a href="#__codelineno-32-181">181</a></span>
<span class="normal"><a href="#__codelineno-32-182">182</a></span>
<span class="normal"><a href="#__codelineno-32-183">183</a></span>
<span class="normal"><a href="#__codelineno-32-184">184</a></span>
<span class="normal"><a href="#__codelineno-32-185">185</a></span>
<span class="normal"><a href="#__codelineno-32-186">186</a></span>
<span class="normal"><a href="#__codelineno-32-187">187</a></span>
<span class="normal"><a href="#__codelineno-32-188">188</a></span>
<span class="normal"><a href="#__codelineno-32-189">189</a></span>
<span class="normal"><a href="#__codelineno-32-190">190</a></span>
<span class="normal"><a href="#__codelineno-32-191">191</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-32-1" name="__codelineno-32-1"></a><span class="k">import</span><span class="w"> </span><span class="s1">&#39;package:flutter/material.dart&#39;</span><span class="p">;</span>
<a id="__codelineno-32-2" name="__codelineno-32-2"></a><span class="k">import</span><span class="w"> </span><span class="s1">&#39;dart:io&#39;</span><span class="p">;</span>
<a id="__codelineno-32-3" name="__codelineno-32-3"></a><span class="k">import</span><span class="w"> </span><span class="s1">&#39;package:flutter/services.dart&#39;</span><span class="p">;</span>
<a id="__codelineno-32-4" name="__codelineno-32-4"></a><span class="k">import</span><span class="w"> </span><span class="s1">&#39;package:image_picker/image_picker.dart&#39;</span><span class="p">;</span>
<a id="__codelineno-32-5" name="__codelineno-32-5"></a><span class="k">import</span><span class="w"> </span><span class="s1">&#39;package:intl/intl.dart&#39;</span><span class="p">;</span>
<a id="__codelineno-32-6" name="__codelineno-32-6"></a>
<a id="__codelineno-32-7" name="__codelineno-32-7"></a><span class="k">import</span><span class="w"> </span><span class="s1">&#39;../models/product.dart&#39;</span><span class="p">;</span>
<a id="__codelineno-32-8" name="__codelineno-32-8"></a><span class="k">import</span><span class="w"> </span><span class="s1">&#39;../provider/products_service.dart&#39;</span><span class="p">;</span>
<a id="__codelineno-32-9" name="__codelineno-32-9"></a>
<a id="__codelineno-32-10" name="__codelineno-32-10"></a><span class="kd">class</span><span class="w"> </span><span class="nc">ProductAdd</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">StatefulWidget</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-32-11" name="__codelineno-32-11"></a><span class="w">  </span><span class="k">const</span><span class="w"> </span><span class="n">ProductAdd</span><span class="p">({</span><span class="k">super</span><span class="p">.</span><span class="n">key</span><span class="p">});</span>
<a id="__codelineno-32-12" name="__codelineno-32-12"></a>
<a id="__codelineno-32-13" name="__codelineno-32-13"></a><span class="w">  </span><span class="nd">@override</span>
<a id="__codelineno-32-14" name="__codelineno-32-14"></a><span class="w">  </span><span class="n">State</span><span class="o">&lt;</span><span class="n">ProductAdd</span><span class="o">&gt;</span><span class="w"> </span><span class="n">createState</span><span class="p">()</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">_ProductAddState</span><span class="p">();</span>
<a id="__codelineno-32-15" name="__codelineno-32-15"></a><span class="p">}</span>
<a id="__codelineno-32-16" name="__codelineno-32-16"></a>
<a id="__codelineno-32-17" name="__codelineno-32-17"></a><span class="kd">class</span><span class="w"> </span><span class="nc">_ProductAddState</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">State</span><span class="o">&lt;</span><span class="n">ProductAdd</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-32-18" name="__codelineno-32-18"></a><span class="w">  </span><span class="kd">final</span><span class="w"> </span><span class="n">ProductsService</span><span class="w"> </span><span class="n">productsNotifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ProductsService</span><span class="p">();</span>
<a id="__codelineno-32-19" name="__codelineno-32-19"></a>
<a id="__codelineno-32-20" name="__codelineno-32-20"></a><span class="w">  </span><span class="kd">final</span><span class="w"> </span><span class="n">_formKey</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">GlobalKey</span><span class="o">&lt;</span><span class="n">FormState</span><span class="o">&gt;</span><span class="p">();</span>
<a id="__codelineno-32-21" name="__codelineno-32-21"></a><span class="w">  </span><span class="kd">final</span><span class="w"> </span><span class="n">TextEditingController</span><span class="w"> </span><span class="n">_descriptionController</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TextEditingController</span><span class="p">();</span>
<a id="__codelineno-32-22" name="__codelineno-32-22"></a><span class="w">  </span><span class="kd">final</span><span class="w"> </span><span class="n">TextEditingController</span><span class="w"> </span><span class="n">_priceController</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TextEditingController</span><span class="p">();</span>
<a id="__codelineno-32-23" name="__codelineno-32-23"></a><span class="w">  </span><span class="kd">final</span><span class="w"> </span><span class="n">TextEditingController</span><span class="w"> </span><span class="n">_availableController</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TextEditingController</span><span class="p">();</span>
<a id="__codelineno-32-24" name="__codelineno-32-24"></a><span class="w">  </span><span class="kd">final</span><span class="w"> </span><span class="n">TextEditingController</span><span class="w"> </span><span class="n">_imageUrlController</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TextEditingController</span><span class="p">();</span>
<a id="__codelineno-32-25" name="__codelineno-32-25"></a><span class="w">  </span><span class="kd">final</span><span class="w"> </span><span class="n">TextEditingController</span><span class="w"> </span><span class="n">_ratingController</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TextEditingController</span><span class="p">();</span>
<a id="__codelineno-32-26" name="__codelineno-32-26"></a>
<a id="__codelineno-32-27" name="__codelineno-32-27"></a><span class="w">  </span><span class="nd">@override</span>
<a id="__codelineno-32-28" name="__codelineno-32-28"></a><span class="w">  </span><span class="kt">void</span><span class="w"> </span><span class="n">dispose</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-32-29" name="__codelineno-32-29"></a><span class="w">    </span><span class="k">super</span><span class="p">.</span><span class="n">dispose</span><span class="p">();</span>
<a id="__codelineno-32-30" name="__codelineno-32-30"></a><span class="w">    </span><span class="n">_descriptionController</span><span class="p">.</span><span class="n">dispose</span><span class="p">();</span>
<a id="__codelineno-32-31" name="__codelineno-32-31"></a><span class="w">    </span><span class="n">_priceController</span><span class="p">.</span><span class="n">dispose</span><span class="p">();</span>
<a id="__codelineno-32-32" name="__codelineno-32-32"></a><span class="w">    </span><span class="n">_availableController</span><span class="p">.</span><span class="n">dispose</span><span class="p">();</span>
<a id="__codelineno-32-33" name="__codelineno-32-33"></a><span class="w">    </span><span class="n">_imageUrlController</span><span class="p">.</span><span class="n">dispose</span><span class="p">();</span>
<a id="__codelineno-32-34" name="__codelineno-32-34"></a><span class="w">    </span><span class="n">_ratingController</span><span class="p">.</span><span class="n">dispose</span><span class="p">();</span>
<a id="__codelineno-32-35" name="__codelineno-32-35"></a><span class="w">  </span><span class="p">}</span>
<a id="__codelineno-32-36" name="__codelineno-32-36"></a>
<a id="__codelineno-32-37" name="__codelineno-32-37"></a><span class="w">  </span><span class="nd">@override</span>
<a id="__codelineno-32-38" name="__codelineno-32-38"></a><span class="w">  </span><span class="n">Widget</span><span class="w"> </span><span class="n">build</span><span class="p">(</span><span class="n">BuildContext</span><span class="w"> </span><span class="n">context</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-32-39" name="__codelineno-32-39"></a><span class="w">    </span><span class="n">File</span><span class="o">?</span><span class="w"> </span><span class="n">image</span><span class="p">;</span>
<a id="__codelineno-32-40" name="__codelineno-32-40"></a>
<a id="__codelineno-32-41" name="__codelineno-32-41"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">Scaffold</span><span class="p">(</span>
<a id="__codelineno-32-42" name="__codelineno-32-42"></a><span class="w">      </span><span class="nl">appBar:</span><span class="w"> </span><span class="n">AppBar</span><span class="p">(</span>
<a id="__codelineno-32-43" name="__codelineno-32-43"></a><span class="w">        </span><span class="nl">title:</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span>
<a id="__codelineno-32-44" name="__codelineno-32-44"></a><span class="w">          </span><span class="s1">&#39;Nuevo Producto&#39;</span><span class="p">,</span>
<a id="__codelineno-32-45" name="__codelineno-32-45"></a><span class="w">        </span><span class="p">),</span>
<a id="__codelineno-32-46" name="__codelineno-32-46"></a><span class="w">      </span><span class="p">),</span>
<a id="__codelineno-32-47" name="__codelineno-32-47"></a><span class="w">      </span><span class="nl">body:</span><span class="w"> </span><span class="n">Form</span><span class="p">(</span>
<a id="__codelineno-32-48" name="__codelineno-32-48"></a><span class="w">        </span><span class="nl">key:</span><span class="w"> </span><span class="n">_formKey</span><span class="p">,</span>
<a id="__codelineno-32-49" name="__codelineno-32-49"></a><span class="hll"><span class="w">        </span><span class="nl">child:</span><span class="w"> </span><span class="n">SingleChildScrollView</span><span class="p">(</span>
</span><a id="__codelineno-32-50" name="__codelineno-32-50"></a><span class="w">          </span><span class="nl">padding:</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">EdgeInsets</span><span class="p">.</span><span class="n">all</span><span class="p">(</span><span class="m">30</span><span class="p">),</span>
<a id="__codelineno-32-51" name="__codelineno-32-51"></a><span class="w">          </span><span class="nl">child:</span><span class="w"> </span><span class="n">Column</span><span class="p">(</span>
<a id="__codelineno-32-52" name="__codelineno-32-52"></a><span class="w">            </span><span class="nl">children:</span><span class="w"> </span><span class="p">[</span>
<a id="__codelineno-32-53" name="__codelineno-32-53"></a><span class="w">              </span><span class="n">TextFormField</span><span class="p">(</span>
<a id="__codelineno-32-54" name="__codelineno-32-54"></a><span class="w">                </span><span class="nl">controller:</span><span class="w"> </span><span class="n">_descriptionController</span><span class="p">,</span>
<a id="__codelineno-32-55" name="__codelineno-32-55"></a><span class="w">                </span><span class="nl">decoration:</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">InputDecoration</span><span class="p">(</span>
<a id="__codelineno-32-56" name="__codelineno-32-56"></a><span class="w">                  </span><span class="nl">icon:</span><span class="w"> </span><span class="n">Icon</span><span class="p">(</span><span class="n">Icons</span><span class="p">.</span><span class="n">description_outlined</span><span class="p">),</span>
<a id="__codelineno-32-57" name="__codelineno-32-57"></a><span class="w">                  </span><span class="nl">labelText:</span><span class="w"> </span><span class="s1">&#39;Descripción&#39;</span><span class="p">,</span>
<a id="__codelineno-32-58" name="__codelineno-32-58"></a><span class="w">                </span><span class="p">),</span>
<a id="__codelineno-32-59" name="__codelineno-32-59"></a><span class="w">                </span><span class="nl">validator:</span><span class="w"> </span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-32-60" name="__codelineno-32-60"></a><span class="w">                  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">value</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="kc">null</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">value</span><span class="p">.</span><span class="n">isEmpty</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-32-61" name="__codelineno-32-61"></a><span class="w">                    </span><span class="k">return</span><span class="w"> </span><span class="s1">&#39;Introduzca una descripción&#39;</span><span class="p">;</span>
<a id="__codelineno-32-62" name="__codelineno-32-62"></a><span class="w">                  </span><span class="p">}</span>
<a id="__codelineno-32-63" name="__codelineno-32-63"></a><span class="w">                  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">value</span><span class="p">.</span><span class="n">length</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="m">5</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-32-64" name="__codelineno-32-64"></a><span class="w">                    </span><span class="k">return</span><span class="w"> </span><span class="s1">&#39;La descripción debe tener al menos 5 caracteres&#39;</span><span class="p">;</span>
<a id="__codelineno-32-65" name="__codelineno-32-65"></a><span class="w">                  </span><span class="p">}</span>
<a id="__codelineno-32-66" name="__codelineno-32-66"></a><span class="w">                  </span><span class="k">return</span><span class="w"> </span><span class="kc">null</span><span class="p">;</span>
<a id="__codelineno-32-67" name="__codelineno-32-67"></a><span class="w">                </span><span class="p">},</span>
<a id="__codelineno-32-68" name="__codelineno-32-68"></a><span class="w">              </span><span class="p">),</span>
<a id="__codelineno-32-69" name="__codelineno-32-69"></a><span class="w">              </span><span class="n">TextFormField</span><span class="p">(</span>
<a id="__codelineno-32-70" name="__codelineno-32-70"></a><span class="w">                </span><span class="nl">controller:</span><span class="w"> </span><span class="n">_priceController</span><span class="p">,</span>
<a id="__codelineno-32-71" name="__codelineno-32-71"></a><span class="w">                </span><span class="nl">decoration:</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">InputDecoration</span><span class="p">(</span>
<a id="__codelineno-32-72" name="__codelineno-32-72"></a><span class="w">                  </span><span class="nl">icon:</span><span class="w"> </span><span class="n">Icon</span><span class="p">(</span><span class="n">Icons</span><span class="p">.</span><span class="n">attach_money_outlined</span><span class="p">),</span>
<a id="__codelineno-32-73" name="__codelineno-32-73"></a><span class="w">                  </span><span class="nl">labelText:</span><span class="w"> </span><span class="s1">&#39;Precio&#39;</span><span class="p">,</span>
<a id="__codelineno-32-74" name="__codelineno-32-74"></a><span class="w">                </span><span class="p">),</span>
<a id="__codelineno-32-75" name="__codelineno-32-75"></a><span class="w">                </span><span class="nl">keyboardType:</span><span class="w"> </span><span class="n">TextInputType</span><span class="p">.</span><span class="n">number</span><span class="p">,</span>
<a id="__codelineno-32-76" name="__codelineno-32-76"></a><span class="w">                </span><span class="nl">validator:</span><span class="w"> </span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-32-77" name="__codelineno-32-77"></a><span class="w">                  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">value</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="kc">null</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">value</span><span class="p">.</span><span class="n">isEmpty</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-32-78" name="__codelineno-32-78"></a><span class="w">                    </span><span class="k">return</span><span class="w"> </span><span class="s1">&#39;Introduzca un precio&#39;</span><span class="p">;</span>
<a id="__codelineno-32-79" name="__codelineno-32-79"></a><span class="w">                  </span><span class="p">}</span>
<a id="__codelineno-32-80" name="__codelineno-32-80"></a><span class="w">                  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="kt">double</span><span class="p">.</span><span class="n">tryParse</span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-32-81" name="__codelineno-32-81"></a><span class="w">                    </span><span class="k">return</span><span class="w"> </span><span class="s1">&#39;Introduzca un valor numérico&#39;</span><span class="p">;</span>
<a id="__codelineno-32-82" name="__codelineno-32-82"></a><span class="w">                  </span><span class="p">}</span>
<a id="__codelineno-32-83" name="__codelineno-32-83"></a><span class="w">                  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="kt">double</span><span class="p">.</span><span class="n">tryParse</span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="o">!</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="m">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-32-84" name="__codelineno-32-84"></a><span class="w">                    </span><span class="k">return</span><span class="w"> </span><span class="s1">&#39;Introduzca un valor mayor que 0&#39;</span><span class="p">;</span>
<a id="__codelineno-32-85" name="__codelineno-32-85"></a><span class="w">                  </span><span class="p">}</span>
<a id="__codelineno-32-86" name="__codelineno-32-86"></a><span class="w">                  </span><span class="k">return</span><span class="w"> </span><span class="kc">null</span><span class="p">;</span>
<a id="__codelineno-32-87" name="__codelineno-32-87"></a><span class="w">                </span><span class="p">},</span>
<a id="__codelineno-32-88" name="__codelineno-32-88"></a><span class="w">              </span><span class="p">),</span>
<a id="__codelineno-32-89" name="__codelineno-32-89"></a><span class="w">              </span><span class="n">TextFormField</span><span class="p">(</span>
<a id="__codelineno-32-90" name="__codelineno-32-90"></a><span class="w">                </span><span class="nl">controller:</span><span class="w"> </span><span class="n">_availableController</span><span class="p">,</span>
<a id="__codelineno-32-91" name="__codelineno-32-91"></a><span class="w">                </span><span class="nl">decoration:</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">InputDecoration</span><span class="p">(</span>
<a id="__codelineno-32-92" name="__codelineno-32-92"></a><span class="w">                  </span><span class="nl">icon:</span><span class="w"> </span><span class="n">Icon</span><span class="p">(</span><span class="n">Icons</span><span class="p">.</span><span class="n">calendar_today</span><span class="p">),</span>
<a id="__codelineno-32-93" name="__codelineno-32-93"></a><span class="w">                  </span><span class="nl">labelText:</span><span class="w"> </span><span class="s1">&#39;Disponible&#39;</span><span class="p">,</span>
<a id="__codelineno-32-94" name="__codelineno-32-94"></a><span class="w">                </span><span class="p">),</span>
<a id="__codelineno-32-95" name="__codelineno-32-95"></a><span class="w">                </span><span class="nl">readOnly:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<a id="__codelineno-32-96" name="__codelineno-32-96"></a><span class="w">                </span><span class="nl">onTap:</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-32-97" name="__codelineno-32-97"></a><span class="w">                  </span><span class="kd">final</span><span class="w"> </span><span class="n">DateTime</span><span class="o">?</span><span class="w"> </span><span class="n">picked</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">await</span><span class="w"> </span><span class="n">showDatePicker</span><span class="p">(</span>
<a id="__codelineno-32-98" name="__codelineno-32-98"></a><span class="w">                    </span><span class="nl">context:</span><span class="w"> </span><span class="n">context</span><span class="p">,</span>
<a id="__codelineno-32-99" name="__codelineno-32-99"></a><span class="w">                    </span><span class="nl">initialDate:</span><span class="w"> </span><span class="n">DateTime</span><span class="p">.</span><span class="n">now</span><span class="p">(),</span>
<a id="__codelineno-32-100" name="__codelineno-32-100"></a><span class="w">                    </span><span class="nl">firstDate:</span><span class="w"> </span><span class="n">DateTime</span><span class="p">(</span><span class="m">2000</span><span class="p">),</span>
<a id="__codelineno-32-101" name="__codelineno-32-101"></a><span class="w">                    </span><span class="nl">lastDate:</span><span class="w"> </span><span class="n">DateTime</span><span class="p">(</span><span class="m">2100</span><span class="p">),</span>
<a id="__codelineno-32-102" name="__codelineno-32-102"></a><span class="w">                  </span><span class="p">);</span>
<a id="__codelineno-32-103" name="__codelineno-32-103"></a><span class="w">                  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">picked</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-32-104" name="__codelineno-32-104"></a><span class="w">                    </span><span class="n">setState</span><span class="p">(()</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-32-105" name="__codelineno-32-105"></a><span class="w">                      </span><span class="n">_availableController</span><span class="p">.</span><span class="n">text</span><span class="w"> </span><span class="o">=</span>
<a id="__codelineno-32-106" name="__codelineno-32-106"></a><span class="w">                          </span><span class="n">DateFormat</span><span class="p">(</span><span class="s1">&#39;yyyy-MM-dd&#39;</span><span class="p">).</span><span class="n">format</span><span class="p">(</span><span class="n">picked</span><span class="p">);</span>
<a id="__codelineno-32-107" name="__codelineno-32-107"></a><span class="w">                    </span><span class="p">});</span>
<a id="__codelineno-32-108" name="__codelineno-32-108"></a><span class="w">                  </span><span class="p">}</span>
<a id="__codelineno-32-109" name="__codelineno-32-109"></a><span class="w">                </span><span class="p">},</span>
<a id="__codelineno-32-110" name="__codelineno-32-110"></a><span class="w">              </span><span class="p">),</span>
<a id="__codelineno-32-111" name="__codelineno-32-111"></a><span class="w">              </span><span class="n">TextFormField</span><span class="p">(</span>
<a id="__codelineno-32-112" name="__codelineno-32-112"></a><span class="w">                </span><span class="nl">controller:</span><span class="w"> </span><span class="n">_imageUrlController</span><span class="p">,</span>
<a id="__codelineno-32-113" name="__codelineno-32-113"></a><span class="w">                </span><span class="nl">decoration:</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">InputDecoration</span><span class="p">(</span>
<a id="__codelineno-32-114" name="__codelineno-32-114"></a><span class="w">                  </span><span class="nl">icon:</span><span class="w"> </span><span class="n">Icon</span><span class="p">(</span><span class="n">Icons</span><span class="p">.</span><span class="n">image_outlined</span><span class="p">),</span>
<a id="__codelineno-32-115" name="__codelineno-32-115"></a><span class="w">                  </span><span class="nl">labelText:</span><span class="w"> </span><span class="s1">&#39;Image URL&#39;</span><span class="p">,</span>
<a id="__codelineno-32-116" name="__codelineno-32-116"></a><span class="w">                </span><span class="p">),</span>
<a id="__codelineno-32-117" name="__codelineno-32-117"></a><span class="w">                </span><span class="nl">keyboardType:</span><span class="w"> </span><span class="n">TextInputType</span><span class="p">.</span><span class="n">url</span><span class="p">,</span>
<a id="__codelineno-32-118" name="__codelineno-32-118"></a><span class="w">                </span><span class="nl">readOnly:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<a id="__codelineno-32-119" name="__codelineno-32-119"></a><span class="w">                </span><span class="nl">onTap:</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-32-120" name="__codelineno-32-120"></a><span class="hll"><span class="w">                  </span><span class="n">XFile</span><span class="o">?</span><span class="w"> </span><span class="n">pickedImage</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">await</span><span class="w"> </span><span class="n">pickImage</span><span class="p">();</span>
</span><a id="__codelineno-32-121" name="__codelineno-32-121"></a><span class="w">                  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">pickedImage</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-32-122" name="__codelineno-32-122"></a><span class="w">                    </span><span class="n">image</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">File</span><span class="p">(</span><span class="n">pickedImage</span><span class="p">.</span><span class="n">path</span><span class="p">);</span>
<a id="__codelineno-32-123" name="__codelineno-32-123"></a><span class="w">                    </span><span class="n">setState</span><span class="p">(()</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-32-124" name="__codelineno-32-124"></a><span class="w">                      </span><span class="n">_imageUrlController</span><span class="p">.</span><span class="n">text</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">image</span><span class="o">!</span><span class="p">.</span><span class="n">path</span><span class="p">;</span>
<a id="__codelineno-32-125" name="__codelineno-32-125"></a><span class="w">                    </span><span class="p">});</span>
<a id="__codelineno-32-126" name="__codelineno-32-126"></a><span class="w">                  </span><span class="p">}</span>
<a id="__codelineno-32-127" name="__codelineno-32-127"></a><span class="w">                </span><span class="p">},</span>
<a id="__codelineno-32-128" name="__codelineno-32-128"></a><span class="w">              </span><span class="p">),</span>
<a id="__codelineno-32-129" name="__codelineno-32-129"></a><span class="w">              </span><span class="n">TextFormField</span><span class="p">(</span>
<a id="__codelineno-32-130" name="__codelineno-32-130"></a><span class="w">                </span><span class="nl">controller:</span><span class="w"> </span><span class="n">_ratingController</span><span class="p">,</span>
<a id="__codelineno-32-131" name="__codelineno-32-131"></a><span class="w">                </span><span class="nl">decoration:</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">InputDecoration</span><span class="p">(</span>
<a id="__codelineno-32-132" name="__codelineno-32-132"></a><span class="w">                  </span><span class="nl">icon:</span><span class="w"> </span><span class="n">Icon</span><span class="p">(</span><span class="n">Icons</span><span class="p">.</span><span class="n">star_outline</span><span class="p">),</span>
<a id="__codelineno-32-133" name="__codelineno-32-133"></a><span class="w">                  </span><span class="nl">labelText:</span><span class="w"> </span><span class="s1">&#39;Rating&#39;</span><span class="p">,</span>
<a id="__codelineno-32-134" name="__codelineno-32-134"></a><span class="w">                </span><span class="p">),</span>
<a id="__codelineno-32-135" name="__codelineno-32-135"></a><span class="w">                </span><span class="nl">keyboardType:</span><span class="w"> </span><span class="n">TextInputType</span><span class="p">.</span><span class="n">number</span><span class="p">,</span>
<a id="__codelineno-32-136" name="__codelineno-32-136"></a><span class="w">                </span><span class="nl">validator:</span><span class="w"> </span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-32-137" name="__codelineno-32-137"></a><span class="w">                  </span><span class="kd">final</span><span class="w"> </span><span class="n">regex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">RegExp</span><span class="p">(</span><span class="s1">&#39;[0-5]&#39;</span><span class="p">);</span>
<a id="__codelineno-32-138" name="__codelineno-32-138"></a><span class="w">                  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">value</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">null</span><span class="w"> </span><span class="o">&amp;&amp;</span>
<a id="__codelineno-32-139" name="__codelineno-32-139"></a><span class="w">                      </span><span class="n">value</span><span class="p">.</span><span class="n">isNotEmpty</span><span class="w"> </span><span class="o">&amp;&amp;</span>
<a id="__codelineno-32-140" name="__codelineno-32-140"></a><span class="w">                      </span><span class="o">!</span><span class="n">regex</span><span class="p">.</span><span class="n">hasMatch</span><span class="p">(</span><span class="n">value</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-32-141" name="__codelineno-32-141"></a><span class="w">                    </span><span class="k">return</span><span class="w"> </span><span class="s1">&#39;El valor debe estar entre 0 y 5&#39;</span><span class="p">;</span>
<a id="__codelineno-32-142" name="__codelineno-32-142"></a><span class="w">                  </span><span class="p">}</span>
<a id="__codelineno-32-143" name="__codelineno-32-143"></a><span class="w">                  </span><span class="k">return</span><span class="w"> </span><span class="kc">null</span><span class="p">;</span>
<a id="__codelineno-32-144" name="__codelineno-32-144"></a><span class="w">                </span><span class="p">},</span>
<a id="__codelineno-32-145" name="__codelineno-32-145"></a><span class="w">              </span><span class="p">),</span>
<a id="__codelineno-32-146" name="__codelineno-32-146"></a><span class="w">              </span><span class="n">Container</span><span class="p">(</span>
<a id="__codelineno-32-147" name="__codelineno-32-147"></a><span class="w">                </span><span class="nl">padding:</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">EdgeInsets</span><span class="p">.</span><span class="n">only</span><span class="p">(</span><span class="nl">top:</span><span class="w"> </span><span class="m">20</span><span class="p">),</span>
<a id="__codelineno-32-148" name="__codelineno-32-148"></a><span class="w">                </span><span class="nl">child:</span><span class="w"> </span><span class="n">ElevatedButton</span><span class="p">(</span>
<a id="__codelineno-32-149" name="__codelineno-32-149"></a><span class="w">                  </span><span class="nl">onPressed:</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-32-150" name="__codelineno-32-150"></a><span class="hll"><span class="w">                    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">_formKey</span><span class="p">.</span><span class="n">currentState</span><span class="o">!</span><span class="p">.</span><span class="n">validate</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
</span><a id="__codelineno-32-151" name="__codelineno-32-151"></a><span class="w">                      </span><span class="n">ScaffoldMessenger</span><span class="p">.</span><span class="n">of</span><span class="p">(</span><span class="n">context</span><span class="p">).</span><span class="n">showSnackBar</span><span class="p">(</span>
<a id="__codelineno-32-152" name="__codelineno-32-152"></a><span class="w">                        </span><span class="k">const</span><span class="w"> </span><span class="n">SnackBar</span><span class="p">(</span><span class="nl">content:</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span><span class="s1">&#39;Producto añadido&#39;</span><span class="p">)),</span>
<a id="__codelineno-32-153" name="__codelineno-32-153"></a><span class="w">                      </span><span class="p">);</span>
<a id="__codelineno-32-154" name="__codelineno-32-154"></a><span class="hll"><span class="w">                      </span><span class="n">productsNotifier</span><span class="p">.</span><span class="n">addProduct</span><span class="p">(</span><span class="n">Product</span><span class="p">(</span>
</span><a id="__codelineno-32-155" name="__codelineno-32-155"></a><span class="w">                          </span><span class="nl">id:</span><span class="w"> </span><span class="n">_descriptionController</span><span class="p">.</span><span class="n">text</span><span class="p">.</span><span class="n">hashCode</span><span class="p">,</span>
<a id="__codelineno-32-156" name="__codelineno-32-156"></a><span class="w">                          </span><span class="nl">description:</span><span class="w"> </span><span class="n">_descriptionController</span><span class="p">.</span><span class="n">text</span><span class="p">,</span>
<a id="__codelineno-32-157" name="__codelineno-32-157"></a><span class="w">                          </span><span class="nl">price:</span><span class="w"> </span><span class="kt">double</span><span class="p">.</span><span class="n">tryParse</span><span class="p">(</span><span class="n">_priceController</span><span class="p">.</span><span class="n">text</span><span class="p">)</span><span class="o">!</span><span class="p">,</span>
<a id="__codelineno-32-158" name="__codelineno-32-158"></a><span class="w">                          </span><span class="nl">available:</span><span class="w"> </span><span class="n">_availableController</span><span class="p">.</span><span class="n">text</span><span class="p">.</span><span class="n">isNotEmpty</span>
<a id="__codelineno-32-159" name="__codelineno-32-159"></a><span class="w">                              </span><span class="o">?</span><span class="w"> </span><span class="n">DateTime</span><span class="p">.</span><span class="n">parse</span><span class="p">(</span><span class="n">_availableController</span><span class="p">.</span><span class="n">text</span><span class="p">)</span>
<a id="__codelineno-32-160" name="__codelineno-32-160"></a><span class="w">                              </span><span class="o">:</span><span class="w"> </span><span class="n">DateTime</span><span class="p">.</span><span class="n">now</span><span class="p">(),</span>
<a id="__codelineno-32-161" name="__codelineno-32-161"></a><span class="w">                          </span><span class="nl">imageUrl:</span><span class="w"> </span><span class="n">_imageUrlController</span><span class="p">.</span><span class="n">text</span><span class="p">,</span>
<a id="__codelineno-32-162" name="__codelineno-32-162"></a><span class="w">                          </span><span class="nl">rating:</span><span class="w"> </span><span class="n">_ratingController</span><span class="p">.</span><span class="n">text</span><span class="p">.</span><span class="n">isNotEmpty</span>
<a id="__codelineno-32-163" name="__codelineno-32-163"></a><span class="w">                              </span><span class="o">?</span><span class="w"> </span><span class="kt">int</span><span class="p">.</span><span class="n">parse</span><span class="p">(</span><span class="n">_ratingController</span><span class="p">.</span><span class="n">text</span><span class="p">)</span>
<a id="__codelineno-32-164" name="__codelineno-32-164"></a><span class="w">                              </span><span class="o">:</span><span class="w"> </span><span class="m">0</span><span class="p">));</span>
<a id="__codelineno-32-165" name="__codelineno-32-165"></a><span class="hll"><span class="w">                      </span><span class="n">Navigator</span><span class="p">.</span><span class="n">pop</span><span class="p">(</span><span class="n">context</span><span class="p">);</span>
</span><a id="__codelineno-32-166" name="__codelineno-32-166"></a><span class="w">                    </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-32-167" name="__codelineno-32-167"></a><span class="w">                      </span><span class="n">ScaffoldMessenger</span><span class="p">.</span><span class="n">of</span><span class="p">(</span><span class="n">context</span><span class="p">).</span><span class="n">showSnackBar</span><span class="p">(</span>
<a id="__codelineno-32-168" name="__codelineno-32-168"></a><span class="w">                        </span><span class="k">const</span><span class="w"> </span><span class="n">SnackBar</span><span class="p">(</span><span class="nl">content:</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span><span class="s1">&#39;Revise los datos&#39;</span><span class="p">)),</span>
<a id="__codelineno-32-169" name="__codelineno-32-169"></a><span class="w">                      </span><span class="p">);</span>
<a id="__codelineno-32-170" name="__codelineno-32-170"></a><span class="w">                    </span><span class="p">}</span>
<a id="__codelineno-32-171" name="__codelineno-32-171"></a><span class="w">                  </span><span class="p">},</span>
<a id="__codelineno-32-172" name="__codelineno-32-172"></a><span class="w">                  </span><span class="nl">child:</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span><span class="s1">&#39;Crear&#39;</span><span class="p">),</span>
<a id="__codelineno-32-173" name="__codelineno-32-173"></a><span class="w">                </span><span class="p">),</span>
<a id="__codelineno-32-174" name="__codelineno-32-174"></a><span class="w">              </span><span class="p">),</span>
<a id="__codelineno-32-175" name="__codelineno-32-175"></a><span class="w">            </span><span class="p">],</span>
<a id="__codelineno-32-176" name="__codelineno-32-176"></a><span class="w">          </span><span class="p">),</span>
<a id="__codelineno-32-177" name="__codelineno-32-177"></a><span class="w">        </span><span class="p">),</span>
<a id="__codelineno-32-178" name="__codelineno-32-178"></a><span class="w">      </span><span class="p">),</span>
<a id="__codelineno-32-179" name="__codelineno-32-179"></a><span class="w">    </span><span class="p">);</span>
<a id="__codelineno-32-180" name="__codelineno-32-180"></a><span class="w">  </span><span class="p">}</span>
<a id="__codelineno-32-181" name="__codelineno-32-181"></a>
<a id="__codelineno-32-182" name="__codelineno-32-182"></a><span class="hll"><span class="w">  </span><span class="n">Future</span><span class="w"> </span><span class="n">pickImage</span><span class="p">()</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="p">{</span>
</span><a id="__codelineno-32-183" name="__codelineno-32-183"></a><span class="w">    </span><span class="kd">final</span><span class="w"> </span><span class="n">XFile</span><span class="o">?</span><span class="w"> </span><span class="n">image</span><span class="p">;</span>
<a id="__codelineno-32-184" name="__codelineno-32-184"></a><span class="w">    </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-32-185" name="__codelineno-32-185"></a><span class="hll"><span class="w">      </span><span class="n">image</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">await</span><span class="w"> </span><span class="n">ImagePicker</span><span class="p">().</span><span class="n">pickImage</span><span class="p">(</span><span class="k">source</span><span class="o">:</span><span class="w"> </span><span class="n">ImageSource</span><span class="p">.</span><span class="n">gallery</span><span class="p">);</span>
</span><a id="__codelineno-32-186" name="__codelineno-32-186"></a><span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="n">image</span><span class="p">;</span>
<a id="__codelineno-32-187" name="__codelineno-32-187"></a><span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="kd">on</span><span class="w"> </span><span class="n">PlatformException</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-32-188" name="__codelineno-32-188"></a><span class="w">      </span><span class="n">print</span><span class="p">(</span><span class="s1">&#39;Failed to pick image: </span><span class="si">$</span><span class="n">e</span><span class="s1">&#39;</span><span class="p">);</span>
<a id="__codelineno-32-189" name="__codelineno-32-189"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-32-190" name="__codelineno-32-190"></a><span class="w">  </span><span class="p">}</span>
<a id="__codelineno-32-191" name="__codelineno-32-191"></a><span class="p">}</span>
</code></pre></div></td></tr></table></div>
<ul>
<li>
<p>Se utiliza un <code>SingleChildScrollView</code> para que el contenido se pueda desplazar si no cabe en la pantalla.</p>
</li>
<li>
<p>En el método <code>pickImage</code> se utiliza el paquete <code>image_picker</code> para seleccionar una imagen de la galería. Para ello, se utiliza el método <code>pickImage</code> que devuelve un <code>XFile</code> con la ruta de la imagen seleccionada.</p>
</li>
<li>
<p>Se llama al método <code>addProduct</code> de <code>ProductsService</code> para añadir un nuevo producto a la lista y se navega a la vista anterior.</p>
</li>
</ul>
<p><img alt="Nuevo producto" src="../assets/ud5_6_3.png" /></p>
<h3 id="vista-detalle">Vista detalle<a class="headerlink" href="#vista-detalle" title="Permanent link">&para;</a></h3>
<p>Para implementar la vista de detalle de un producto, se crea <code>ProductDetail</code> en <code>pages/product_detail.dart</code>. Se añaden dos iconos en la <code>AppBar</code> para editar y eliminar el producto.</p>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">lib/pages/product_detail.dart</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-33-1">  1</a></span>
<span class="normal"><a href="#__codelineno-33-2">  2</a></span>
<span class="normal"><a href="#__codelineno-33-3">  3</a></span>
<span class="normal"><a href="#__codelineno-33-4">  4</a></span>
<span class="normal"><a href="#__codelineno-33-5">  5</a></span>
<span class="normal"><a href="#__codelineno-33-6">  6</a></span>
<span class="normal"><a href="#__codelineno-33-7">  7</a></span>
<span class="normal"><a href="#__codelineno-33-8">  8</a></span>
<span class="normal"><a href="#__codelineno-33-9">  9</a></span>
<span class="normal"><a href="#__codelineno-33-10"> 10</a></span>
<span class="normal"><a href="#__codelineno-33-11"> 11</a></span>
<span class="normal"><a href="#__codelineno-33-12"> 12</a></span>
<span class="normal"><a href="#__codelineno-33-13"> 13</a></span>
<span class="normal"><a href="#__codelineno-33-14"> 14</a></span>
<span class="normal"><a href="#__codelineno-33-15"> 15</a></span>
<span class="normal"><a href="#__codelineno-33-16"> 16</a></span>
<span class="normal"><a href="#__codelineno-33-17"> 17</a></span>
<span class="normal"><a href="#__codelineno-33-18"> 18</a></span>
<span class="normal"><a href="#__codelineno-33-19"> 19</a></span>
<span class="normal"><a href="#__codelineno-33-20"> 20</a></span>
<span class="normal"><a href="#__codelineno-33-21"> 21</a></span>
<span class="normal"><a href="#__codelineno-33-22"> 22</a></span>
<span class="normal"><a href="#__codelineno-33-23"> 23</a></span>
<span class="normal"><a href="#__codelineno-33-24"> 24</a></span>
<span class="normal"><a href="#__codelineno-33-25"> 25</a></span>
<span class="normal"><a href="#__codelineno-33-26"> 26</a></span>
<span class="normal"><a href="#__codelineno-33-27"> 27</a></span>
<span class="normal"><a href="#__codelineno-33-28"> 28</a></span>
<span class="normal"><a href="#__codelineno-33-29"> 29</a></span>
<span class="normal"><a href="#__codelineno-33-30"> 30</a></span>
<span class="normal"><a href="#__codelineno-33-31"> 31</a></span>
<span class="normal"><a href="#__codelineno-33-32"> 32</a></span>
<span class="normal"><a href="#__codelineno-33-33"> 33</a></span>
<span class="normal"><a href="#__codelineno-33-34"> 34</a></span>
<span class="normal"><a href="#__codelineno-33-35"> 35</a></span>
<span class="normal"><a href="#__codelineno-33-36"> 36</a></span>
<span class="normal"><a href="#__codelineno-33-37"> 37</a></span>
<span class="normal"><a href="#__codelineno-33-38"> 38</a></span>
<span class="normal"><a href="#__codelineno-33-39"> 39</a></span>
<span class="normal"><a href="#__codelineno-33-40"> 40</a></span>
<span class="normal"><a href="#__codelineno-33-41"> 41</a></span>
<span class="normal"><a href="#__codelineno-33-42"> 42</a></span>
<span class="normal"><a href="#__codelineno-33-43"> 43</a></span>
<span class="normal"><a href="#__codelineno-33-44"> 44</a></span>
<span class="normal"><a href="#__codelineno-33-45"> 45</a></span>
<span class="normal"><a href="#__codelineno-33-46"> 46</a></span>
<span class="normal"><a href="#__codelineno-33-47"> 47</a></span>
<span class="normal"><a href="#__codelineno-33-48"> 48</a></span>
<span class="normal"><a href="#__codelineno-33-49"> 49</a></span>
<span class="normal"><a href="#__codelineno-33-50"> 50</a></span>
<span class="normal"><a href="#__codelineno-33-51"> 51</a></span>
<span class="normal"><a href="#__codelineno-33-52"> 52</a></span>
<span class="normal"><a href="#__codelineno-33-53"> 53</a></span>
<span class="normal"><a href="#__codelineno-33-54"> 54</a></span>
<span class="normal"><a href="#__codelineno-33-55"> 55</a></span>
<span class="normal"><a href="#__codelineno-33-56"> 56</a></span>
<span class="normal"><a href="#__codelineno-33-57"> 57</a></span>
<span class="normal"><a href="#__codelineno-33-58"> 58</a></span>
<span class="normal"><a href="#__codelineno-33-59"> 59</a></span>
<span class="normal"><a href="#__codelineno-33-60"> 60</a></span>
<span class="normal"><a href="#__codelineno-33-61"> 61</a></span>
<span class="normal"><a href="#__codelineno-33-62"> 62</a></span>
<span class="normal"><a href="#__codelineno-33-63"> 63</a></span>
<span class="normal"><a href="#__codelineno-33-64"> 64</a></span>
<span class="normal"><a href="#__codelineno-33-65"> 65</a></span>
<span class="normal"><a href="#__codelineno-33-66"> 66</a></span>
<span class="normal"><a href="#__codelineno-33-67"> 67</a></span>
<span class="normal"><a href="#__codelineno-33-68"> 68</a></span>
<span class="normal"><a href="#__codelineno-33-69"> 69</a></span>
<span class="normal"><a href="#__codelineno-33-70"> 70</a></span>
<span class="normal"><a href="#__codelineno-33-71"> 71</a></span>
<span class="normal"><a href="#__codelineno-33-72"> 72</a></span>
<span class="normal"><a href="#__codelineno-33-73"> 73</a></span>
<span class="normal"><a href="#__codelineno-33-74"> 74</a></span>
<span class="normal"><a href="#__codelineno-33-75"> 75</a></span>
<span class="normal"><a href="#__codelineno-33-76"> 76</a></span>
<span class="normal"><a href="#__codelineno-33-77"> 77</a></span>
<span class="normal"><a href="#__codelineno-33-78"> 78</a></span>
<span class="normal"><a href="#__codelineno-33-79"> 79</a></span>
<span class="normal"><a href="#__codelineno-33-80"> 80</a></span>
<span class="normal"><a href="#__codelineno-33-81"> 81</a></span>
<span class="normal"><a href="#__codelineno-33-82"> 82</a></span>
<span class="normal"><a href="#__codelineno-33-83"> 83</a></span>
<span class="normal"><a href="#__codelineno-33-84"> 84</a></span>
<span class="normal"><a href="#__codelineno-33-85"> 85</a></span>
<span class="normal"><a href="#__codelineno-33-86"> 86</a></span>
<span class="normal"><a href="#__codelineno-33-87"> 87</a></span>
<span class="normal"><a href="#__codelineno-33-88"> 88</a></span>
<span class="normal"><a href="#__codelineno-33-89"> 89</a></span>
<span class="normal"><a href="#__codelineno-33-90"> 90</a></span>
<span class="normal"><a href="#__codelineno-33-91"> 91</a></span>
<span class="normal"><a href="#__codelineno-33-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-33-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-33-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-33-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-33-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-33-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-33-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-33-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-33-100">100</a></span>
<span class="normal"><a href="#__codelineno-33-101">101</a></span>
<span class="normal"><a href="#__codelineno-33-102">102</a></span>
<span class="normal"><a href="#__codelineno-33-103">103</a></span>
<span class="normal"><a href="#__codelineno-33-104">104</a></span>
<span class="normal"><a href="#__codelineno-33-105">105</a></span>
<span class="normal"><a href="#__codelineno-33-106">106</a></span>
<span class="normal"><a href="#__codelineno-33-107">107</a></span>
<span class="normal"><a href="#__codelineno-33-108">108</a></span>
<span class="normal"><a href="#__codelineno-33-109">109</a></span>
<span class="normal"><a href="#__codelineno-33-110">110</a></span>
<span class="normal"><a href="#__codelineno-33-111">111</a></span>
<span class="normal"><a href="#__codelineno-33-112">112</a></span>
<span class="normal"><a href="#__codelineno-33-113">113</a></span>
<span class="normal"><a href="#__codelineno-33-114">114</a></span>
<span class="normal"><a href="#__codelineno-33-115">115</a></span>
<span class="normal"><a href="#__codelineno-33-116">116</a></span>
<span class="normal"><a href="#__codelineno-33-117">117</a></span>
<span class="normal"><a href="#__codelineno-33-118">118</a></span>
<span class="normal"><a href="#__codelineno-33-119">119</a></span>
<span class="normal"><a href="#__codelineno-33-120">120</a></span>
<span class="normal"><a href="#__codelineno-33-121">121</a></span>
<span class="normal"><a href="#__codelineno-33-122">122</a></span>
<span class="normal"><a href="#__codelineno-33-123">123</a></span>
<span class="normal"><a href="#__codelineno-33-124">124</a></span>
<span class="normal"><a href="#__codelineno-33-125">125</a></span>
<span class="normal"><a href="#__codelineno-33-126">126</a></span>
<span class="normal"><a href="#__codelineno-33-127">127</a></span>
<span class="normal"><a href="#__codelineno-33-128">128</a></span>
<span class="normal"><a href="#__codelineno-33-129">129</a></span>
<span class="normal"><a href="#__codelineno-33-130">130</a></span>
<span class="normal"><a href="#__codelineno-33-131">131</a></span>
<span class="normal"><a href="#__codelineno-33-132">132</a></span>
<span class="normal"><a href="#__codelineno-33-133">133</a></span>
<span class="normal"><a href="#__codelineno-33-134">134</a></span>
<span class="normal"><a href="#__codelineno-33-135">135</a></span>
<span class="normal"><a href="#__codelineno-33-136">136</a></span>
<span class="normal"><a href="#__codelineno-33-137">137</a></span>
<span class="normal"><a href="#__codelineno-33-138">138</a></span>
<span class="normal"><a href="#__codelineno-33-139">139</a></span>
<span class="normal"><a href="#__codelineno-33-140">140</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-33-1" name="__codelineno-33-1"></a><span class="k">import</span><span class="w"> </span><span class="s1">&#39;dart:io&#39;</span><span class="p">;</span>
<a id="__codelineno-33-2" name="__codelineno-33-2"></a>
<a id="__codelineno-33-3" name="__codelineno-33-3"></a><span class="k">import</span><span class="w"> </span><span class="s1">&#39;package:flutter/material.dart&#39;</span><span class="p">;</span>
<a id="__codelineno-33-4" name="__codelineno-33-4"></a><span class="k">import</span><span class="w"> </span><span class="s1">&#39;package:flutter_products/pages/product_edit.dart&#39;</span><span class="p">;</span>
<a id="__codelineno-33-5" name="__codelineno-33-5"></a><span class="k">import</span><span class="w"> </span><span class="s1">&#39;package:flutter_products/provider/products_service.dart&#39;</span><span class="p">;</span>
<a id="__codelineno-33-6" name="__codelineno-33-6"></a><span class="k">import</span><span class="w"> </span><span class="s1">&#39;package:intl/intl.dart&#39;</span><span class="p">;</span>
<a id="__codelineno-33-7" name="__codelineno-33-7"></a><span class="k">import</span><span class="w"> </span><span class="s1">&#39;package:provider/provider.dart&#39;</span><span class="p">;</span>
<a id="__codelineno-33-8" name="__codelineno-33-8"></a>
<a id="__codelineno-33-9" name="__codelineno-33-9"></a><span class="k">import</span><span class="w"> </span><span class="s1">&#39;../models/product.dart&#39;</span><span class="p">;</span>
<a id="__codelineno-33-10" name="__codelineno-33-10"></a>
<a id="__codelineno-33-11" name="__codelineno-33-11"></a><span class="hll"><span class="kd">class</span><span class="w"> </span><span class="nc">ProductDetail</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">StatefulWidget</span><span class="w"> </span><span class="p">{</span>
</span><a id="__codelineno-33-12" name="__codelineno-33-12"></a><span class="hll"><span class="w">  </span><span class="kd">final</span><span class="w"> </span><span class="n">Product</span><span class="w"> </span><span class="n">product</span><span class="p">;</span>
</span><a id="__codelineno-33-13" name="__codelineno-33-13"></a><span class="w">  </span><span class="k">const</span><span class="w"> </span><span class="n">ProductDetail</span><span class="p">({</span><span class="k">super</span><span class="p">.</span><span class="n">key</span><span class="p">,</span><span class="w"> </span><span class="kd">required</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="n">product</span><span class="p">});</span>
<a id="__codelineno-33-14" name="__codelineno-33-14"></a>
<a id="__codelineno-33-15" name="__codelineno-33-15"></a><span class="w">  </span><span class="nd">@override</span>
<a id="__codelineno-33-16" name="__codelineno-33-16"></a><span class="w">  </span><span class="n">State</span><span class="o">&lt;</span><span class="n">ProductDetail</span><span class="o">&gt;</span><span class="w"> </span><span class="n">createState</span><span class="p">()</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">_ProductDetailState</span><span class="p">();</span>
<a id="__codelineno-33-17" name="__codelineno-33-17"></a><span class="p">}</span>
<a id="__codelineno-33-18" name="__codelineno-33-18"></a>
<a id="__codelineno-33-19" name="__codelineno-33-19"></a><span class="hll"><span class="kd">class</span><span class="w"> </span><span class="nc">_ProductDetailState</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">State</span><span class="o">&lt;</span><span class="n">ProductDetail</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
</span><a id="__codelineno-33-20" name="__codelineno-33-20"></a><span class="w">  </span><span class="kd">final</span><span class="w"> </span><span class="n">ProductsService</span><span class="w"> </span><span class="n">productsNotifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ProductsService</span><span class="p">();</span>
<a id="__codelineno-33-21" name="__codelineno-33-21"></a>
<a id="__codelineno-33-22" name="__codelineno-33-22"></a><span class="hll"><span class="w">  </span><span class="kd">late</span><span class="w"> </span><span class="n">Product</span><span class="w"> </span><span class="n">product</span><span class="p">;</span>
</span><a id="__codelineno-33-23" name="__codelineno-33-23"></a>
<a id="__codelineno-33-24" name="__codelineno-33-24"></a><span class="w">  </span><span class="nd">@override</span>
<a id="__codelineno-33-25" name="__codelineno-33-25"></a><span class="w">  </span><span class="kt">void</span><span class="w"> </span><span class="n">initState</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-33-26" name="__codelineno-33-26"></a><span class="w">    </span><span class="n">product</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">widget</span><span class="p">.</span><span class="n">product</span><span class="p">;</span>
<a id="__codelineno-33-27" name="__codelineno-33-27"></a><span class="w">    </span><span class="k">super</span><span class="p">.</span><span class="n">initState</span><span class="p">();</span>
<a id="__codelineno-33-28" name="__codelineno-33-28"></a><span class="w">  </span><span class="p">}</span>
<a id="__codelineno-33-29" name="__codelineno-33-29"></a>
<a id="__codelineno-33-30" name="__codelineno-33-30"></a><span class="w">  </span><span class="nd">@override</span>
<a id="__codelineno-33-31" name="__codelineno-33-31"></a><span class="w">  </span><span class="n">Widget</span><span class="w"> </span><span class="n">build</span><span class="p">(</span><span class="n">BuildContext</span><span class="w"> </span><span class="n">context</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-33-32" name="__codelineno-33-32"></a><span class="hll"><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">ChangeNotifierProvider</span><span class="p">(</span>
</span><a id="__codelineno-33-33" name="__codelineno-33-33"></a><span class="w">        </span><span class="nl">create:</span><span class="w"> </span><span class="p">(</span><span class="n">_</span><span class="p">)</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">ProductsService</span><span class="p">(),</span>
<a id="__codelineno-33-34" name="__codelineno-33-34"></a><span class="w">        </span><span class="nl">builder:</span><span class="w"> </span><span class="p">(</span><span class="n">context</span><span class="p">,</span><span class="w"> </span><span class="n">provider</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-33-35" name="__codelineno-33-35"></a><span class="w">          </span><span class="k">return</span><span class="w"> </span><span class="n">Consumer</span><span class="o">&lt;</span><span class="n">ProductsService</span><span class="o">&gt;</span><span class="p">(</span><span class="nl">builder:</span><span class="w"> </span><span class="p">(</span><span class="n">context</span><span class="p">,</span><span class="w"> </span><span class="n">notifier</span><span class="p">,</span><span class="w"> </span><span class="n">child</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-33-36" name="__codelineno-33-36"></a><span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">Scaffold</span><span class="p">(</span>
<a id="__codelineno-33-37" name="__codelineno-33-37"></a><span class="w">              </span><span class="nl">appBar:</span><span class="w"> </span><span class="n">AppBar</span><span class="p">(</span>
<a id="__codelineno-33-38" name="__codelineno-33-38"></a><span class="w">                </span><span class="nl">title:</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span>
<a id="__codelineno-33-39" name="__codelineno-33-39"></a><span class="w">                  </span><span class="n">product</span><span class="p">.</span><span class="n">description</span><span class="p">,</span>
<a id="__codelineno-33-40" name="__codelineno-33-40"></a><span class="w">                </span><span class="p">),</span>
<a id="__codelineno-33-41" name="__codelineno-33-41"></a><span class="w">                </span><span class="nl">actions:</span><span class="w"> </span><span class="p">[</span>
<a id="__codelineno-33-42" name="__codelineno-33-42"></a><span class="w">                  </span><span class="c1">// EDIT</span>
<a id="__codelineno-33-43" name="__codelineno-33-43"></a><span class="w">                  </span><span class="n">IconButton</span><span class="p">(</span>
<a id="__codelineno-33-44" name="__codelineno-33-44"></a><span class="w">                      </span><span class="nl">icon:</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">Icon</span><span class="p">(</span><span class="n">Icons</span><span class="p">.</span><span class="n">edit</span><span class="p">),</span>
<a id="__codelineno-33-45" name="__codelineno-33-45"></a><span class="w">                      </span><span class="nl">tooltip:</span><span class="w"> </span><span class="s1">&#39;Editar Producto&#39;</span><span class="p">,</span>
<a id="__codelineno-33-46" name="__codelineno-33-46"></a><span class="w">                      </span><span class="nl">onPressed:</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-33-47" name="__codelineno-33-47"></a><span class="w">                        </span><span class="n">Navigator</span><span class="p">.</span><span class="n">push</span><span class="p">(</span>
<a id="__codelineno-33-48" name="__codelineno-33-48"></a><span class="w">                          </span><span class="n">context</span><span class="p">,</span>
<a id="__codelineno-33-49" name="__codelineno-33-49"></a><span class="w">                          </span><span class="n">MaterialPageRoute</span><span class="p">(</span>
<a id="__codelineno-33-50" name="__codelineno-33-50"></a><span class="w">                              </span><span class="nl">builder:</span><span class="w"> </span><span class="p">(</span><span class="n">context</span><span class="p">)</span><span class="w"> </span><span class="o">=&gt;</span>
<a id="__codelineno-33-51" name="__codelineno-33-51"></a><span class="hll"><span class="w">                                  </span><span class="n">ProductEdit</span><span class="p">(</span><span class="nl">product:</span><span class="w"> </span><span class="n">product</span><span class="p">)),</span>
</span><a id="__codelineno-33-52" name="__codelineno-33-52"></a><span class="hll"><span class="w">                        </span><span class="p">).</span><span class="n">then</span><span class="p">((</span><span class="n">value</span><span class="p">)</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="p">{</span>
</span><a id="__codelineno-33-53" name="__codelineno-33-53"></a><span class="w">                              </span><span class="n">setState</span><span class="p">(()</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-33-54" name="__codelineno-33-54"></a><span class="w">                                </span><span class="n">product</span><span class="w"> </span><span class="o">=</span>
<a id="__codelineno-33-55" name="__codelineno-33-55"></a><span class="w">                                    </span><span class="n">productsNotifier</span><span class="p">.</span><span class="n">getProduct</span><span class="p">(</span><span class="n">product</span><span class="p">.</span><span class="n">id</span><span class="p">);</span>
<a id="__codelineno-33-56" name="__codelineno-33-56"></a><span class="w">                              </span><span class="p">})</span>
<a id="__codelineno-33-57" name="__codelineno-33-57"></a><span class="w">                            </span><span class="p">});</span><span class="err">###</span><span class="w"> </span><span class="n">Vista</span><span class="w"> </span><span class="n">lista</span>
<a id="__codelineno-33-58" name="__codelineno-33-58"></a>
<a id="__codelineno-33-59" name="__codelineno-33-59"></a><span class="w">                      </span><span class="p">}),</span>
<a id="__codelineno-33-60" name="__codelineno-33-60"></a><span class="w">                  </span><span class="c1">// DELETE</span>
<a id="__codelineno-33-61" name="__codelineno-33-61"></a><span class="w">                  </span><span class="n">IconButton</span><span class="p">(</span>
<a id="__codelineno-33-62" name="__codelineno-33-62"></a><span class="w">                      </span><span class="nl">icon:</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">Icon</span><span class="p">(</span><span class="n">Icons</span><span class="p">.</span><span class="n">delete</span><span class="p">),</span>
<a id="__codelineno-33-63" name="__codelineno-33-63"></a><span class="w">                      </span><span class="nl">tooltip:</span><span class="w"> </span><span class="s1">&#39;Eliminar Producto&#39;</span><span class="p">,</span>
<a id="__codelineno-33-64" name="__codelineno-33-64"></a><span class="w">                      </span><span class="nl">onPressed:</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-33-65" name="__codelineno-33-65"></a><span class="hll"><span class="w">                        </span><span class="c1">// delete confirm dialog</span>
</span><a id="__codelineno-33-66" name="__codelineno-33-66"></a><span class="w">                        </span><span class="n">showDialog</span><span class="p">(</span>
<a id="__codelineno-33-67" name="__codelineno-33-67"></a><span class="w">                          </span><span class="nl">context:</span><span class="w"> </span><span class="n">context</span><span class="p">,</span>
<a id="__codelineno-33-68" name="__codelineno-33-68"></a><span class="w">                          </span><span class="nl">builder:</span><span class="w"> </span><span class="p">(</span><span class="n">BuildContext</span><span class="w"> </span><span class="n">context</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-33-69" name="__codelineno-33-69"></a><span class="w">                            </span><span class="k">return</span><span class="w"> </span><span class="n">AlertDialog</span><span class="p">(</span>
<a id="__codelineno-33-70" name="__codelineno-33-70"></a><span class="w">                              </span><span class="nl">title:</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span><span class="s1">&#39;Confirmar&#39;</span><span class="p">),</span>
<a id="__codelineno-33-71" name="__codelineno-33-71"></a><span class="w">                              </span><span class="nl">content:</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span>
<a id="__codelineno-33-72" name="__codelineno-33-72"></a><span class="w">                                  </span><span class="s1">&#39;¿Está seguro de eliminar, &quot;</span><span class="si">${</span><span class="n">product</span><span class="p">.</span><span class="n">description</span><span class="si">}</span><span class="s1">&quot;?&#39;</span><span class="p">),</span>
<a id="__codelineno-33-73" name="__codelineno-33-73"></a><span class="w">                              </span><span class="nl">actions:</span><span class="w"> </span><span class="p">[</span>
<a id="__codelineno-33-74" name="__codelineno-33-74"></a><span class="w">                                </span><span class="n">TextButton</span><span class="p">(</span>
<a id="__codelineno-33-75" name="__codelineno-33-75"></a><span class="w">                                  </span><span class="nl">child:</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span><span class="s1">&#39;Cancelar&#39;</span><span class="p">),</span>
<a id="__codelineno-33-76" name="__codelineno-33-76"></a><span class="w">                                  </span><span class="nl">onPressed:</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-33-77" name="__codelineno-33-77"></a><span class="w">                                    </span><span class="n">Navigator</span><span class="p">.</span><span class="n">of</span><span class="p">(</span><span class="n">context</span><span class="p">).</span><span class="n">pop</span><span class="p">();</span>
<a id="__codelineno-33-78" name="__codelineno-33-78"></a><span class="w">                                  </span><span class="p">},</span>
<a id="__codelineno-33-79" name="__codelineno-33-79"></a><span class="w">                                </span><span class="p">),</span>
<a id="__codelineno-33-80" name="__codelineno-33-80"></a><span class="w">                                </span><span class="n">TextButton</span><span class="p">(</span>
<a id="__codelineno-33-81" name="__codelineno-33-81"></a><span class="w">                                  </span><span class="nl">child:</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span><span class="s1">&#39;Eliminar&#39;</span><span class="p">),</span>
<a id="__codelineno-33-82" name="__codelineno-33-82"></a><span class="hll"><span class="w">                                  </span><span class="nl">onPressed:</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><a id="__codelineno-33-83" name="__codelineno-33-83"></a><span class="w">                                    </span><span class="n">productsNotifier</span><span class="p">.</span><span class="n">removeProduct</span><span class="p">(</span><span class="n">product</span><span class="p">);</span>
<a id="__codelineno-33-84" name="__codelineno-33-84"></a><span class="w">                                    </span><span class="n">Navigator</span><span class="p">.</span><span class="n">of</span><span class="p">(</span><span class="n">context</span><span class="p">).</span><span class="n">pop</span><span class="p">();</span>
<a id="__codelineno-33-85" name="__codelineno-33-85"></a><span class="w">                                    </span><span class="n">Navigator</span><span class="p">.</span><span class="n">of</span><span class="p">(</span><span class="n">context</span><span class="p">).</span><span class="n">pop</span><span class="p">();</span>
<a id="__codelineno-33-86" name="__codelineno-33-86"></a><span class="w">                                  </span><span class="p">},</span>
<a id="__codelineno-33-87" name="__codelineno-33-87"></a><span class="w">                                </span><span class="p">),</span>
<a id="__codelineno-33-88" name="__codelineno-33-88"></a><span class="w">                              </span><span class="p">],</span>
<a id="__codelineno-33-89" name="__codelineno-33-89"></a><span class="w">                            </span><span class="p">);</span>
<a id="__codelineno-33-90" name="__codelineno-33-90"></a><span class="w">                          </span><span class="p">},</span>
<a id="__codelineno-33-91" name="__codelineno-33-91"></a><span class="w">                        </span><span class="p">);</span>
<a id="__codelineno-33-92" name="__codelineno-33-92"></a><span class="w">                      </span><span class="p">}),</span>
<a id="__codelineno-33-93" name="__codelineno-33-93"></a><span class="w">                </span><span class="p">],</span>
<a id="__codelineno-33-94" name="__codelineno-33-94"></a><span class="w">              </span><span class="p">),</span>
<a id="__codelineno-33-95" name="__codelineno-33-95"></a><span class="w">              </span><span class="nl">body:</span><span class="w"> </span><span class="n">SingleChildScrollView</span><span class="p">(</span>
<a id="__codelineno-33-96" name="__codelineno-33-96"></a><span class="w">                </span><span class="nl">padding:</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">EdgeInsets</span><span class="p">.</span><span class="n">all</span><span class="p">(</span><span class="m">30</span><span class="p">),</span>
<a id="__codelineno-33-97" name="__codelineno-33-97"></a><span class="w">                </span><span class="nl">child:</span><span class="w"> </span><span class="n">ConstrainedBox</span><span class="p">(</span>
<a id="__codelineno-33-98" name="__codelineno-33-98"></a><span class="w">                  </span><span class="nl">constraints:</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">BoxConstraints</span><span class="p">(</span><span class="nl">minWidth:</span><span class="w"> </span><span class="kt">double</span><span class="p">.</span><span class="n">infinity</span><span class="p">),</span>
<a id="__codelineno-33-99" name="__codelineno-33-99"></a><span class="w">                  </span><span class="nl">child:</span><span class="w"> </span><span class="n">Column</span><span class="p">(</span>
<a id="__codelineno-33-100" name="__codelineno-33-100"></a><span class="w">                    </span><span class="nl">mainAxisAlignment:</span><span class="w"> </span><span class="n">MainAxisAlignment</span><span class="p">.</span><span class="n">center</span><span class="p">,</span>
<a id="__codelineno-33-101" name="__codelineno-33-101"></a><span class="w">                    </span><span class="nl">crossAxisAlignment:</span><span class="w"> </span><span class="n">CrossAxisAlignment</span><span class="p">.</span><span class="n">center</span><span class="p">,</span>
<a id="__codelineno-33-102" name="__codelineno-33-102"></a><span class="w">                    </span><span class="nl">children:</span><span class="w"> </span><span class="p">[</span>
<a id="__codelineno-33-103" name="__codelineno-33-103"></a><span class="w">                      </span><span class="n">product</span><span class="p">.</span><span class="n">imageUrl</span><span class="p">.</span><span class="n">isNotEmpty</span>
<a id="__codelineno-33-104" name="__codelineno-33-104"></a><span class="w">                          </span><span class="o">?</span><span class="w"> </span><span class="p">(</span><span class="n">Uri</span><span class="p">.</span><span class="n">parse</span><span class="p">(</span><span class="n">product</span><span class="p">.</span><span class="n">imageUrl</span><span class="p">).</span><span class="n">isAbsolute</span>
<a id="__codelineno-33-105" name="__codelineno-33-105"></a><span class="w">                              </span><span class="o">?</span><span class="w"> </span><span class="n">Image</span><span class="p">.</span><span class="n">network</span><span class="p">(</span><span class="n">product</span><span class="p">.</span><span class="n">imageUrl</span><span class="p">,</span>
<a id="__codelineno-33-106" name="__codelineno-33-106"></a><span class="w">                                  </span><span class="nl">fit:</span><span class="w"> </span><span class="n">BoxFit</span><span class="p">.</span><span class="n">cover</span><span class="p">,</span><span class="w"> </span><span class="nl">width:</span><span class="w"> </span><span class="m">200</span><span class="p">,</span><span class="w"> </span><span class="nl">height:</span><span class="w"> </span><span class="m">200</span><span class="p">)</span>
<a id="__codelineno-33-107" name="__codelineno-33-107"></a><span class="w">                              </span><span class="o">:</span><span class="w"> </span><span class="n">Image</span><span class="p">.</span><span class="n">file</span><span class="p">(</span><span class="n">File</span><span class="p">(</span><span class="n">product</span><span class="p">.</span><span class="n">imageUrl</span><span class="p">),</span>
<a id="__codelineno-33-108" name="__codelineno-33-108"></a><span class="w">                                  </span><span class="nl">fit:</span><span class="w"> </span><span class="n">BoxFit</span><span class="p">.</span><span class="n">cover</span><span class="p">,</span><span class="w"> </span><span class="nl">width:</span><span class="w"> </span><span class="m">200</span><span class="p">,</span><span class="w"> </span><span class="nl">height:</span><span class="w"> </span><span class="m">200</span><span class="p">))</span>
<a id="__codelineno-33-109" name="__codelineno-33-109"></a><span class="w">                          </span><span class="o">:</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">Icon</span><span class="p">(</span><span class="n">Icons</span><span class="p">.</span><span class="n">image_outlined</span><span class="p">,</span>
<a id="__codelineno-33-110" name="__codelineno-33-110"></a><span class="w">                              </span><span class="nl">size:</span><span class="w"> </span><span class="m">200</span><span class="p">,</span><span class="w"> </span><span class="nl">color:</span><span class="w"> </span><span class="n">Colors</span><span class="p">.</span><span class="n">grey</span><span class="p">),</span>
<a id="__codelineno-33-111" name="__codelineno-33-111"></a><span class="w">                      </span><span class="k">const</span><span class="w"> </span><span class="n">SizedBox</span><span class="p">(</span><span class="nl">height:</span><span class="w"> </span><span class="m">20</span><span class="p">),</span>
<a id="__codelineno-33-112" name="__codelineno-33-112"></a><span class="w">                      </span><span class="n">Text</span><span class="p">(</span>
<a id="__codelineno-33-113" name="__codelineno-33-113"></a><span class="w">                        </span><span class="n">product</span><span class="p">.</span><span class="n">description</span><span class="p">,</span>
<a id="__codelineno-33-114" name="__codelineno-33-114"></a><span class="w">                        </span><span class="nl">style:</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">TextStyle</span><span class="p">(</span><span class="nl">fontSize:</span><span class="w"> </span><span class="m">20</span><span class="p">),</span>
<a id="__codelineno-33-115" name="__codelineno-33-115"></a><span class="w">                      </span><span class="p">),</span>
<a id="__codelineno-33-116" name="__codelineno-33-116"></a><span class="w">                      </span><span class="k">const</span><span class="w"> </span><span class="n">SizedBox</span><span class="p">(</span><span class="nl">height:</span><span class="w"> </span><span class="m">20</span><span class="p">),</span>
<a id="__codelineno-33-117" name="__codelineno-33-117"></a><span class="w">                      </span><span class="n">Text</span><span class="p">(</span>
<a id="__codelineno-33-118" name="__codelineno-33-118"></a><span class="w">                        </span><span class="n">NumberFormat</span><span class="p">.</span><span class="n">simpleCurrency</span><span class="p">(</span><span class="nl">locale:</span><span class="w"> </span><span class="s1">&#39;es&#39;</span><span class="p">)</span>
<a id="__codelineno-33-119" name="__codelineno-33-119"></a><span class="w">                            </span><span class="p">.</span><span class="n">format</span><span class="p">(</span><span class="n">product</span><span class="p">.</span><span class="n">price</span><span class="p">),</span>
<a id="__codelineno-33-120" name="__codelineno-33-120"></a><span class="w">                        </span><span class="nl">style:</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">TextStyle</span><span class="p">(</span><span class="nl">fontSize:</span><span class="w"> </span><span class="m">20</span><span class="p">),</span>
<a id="__codelineno-33-121" name="__codelineno-33-121"></a><span class="w">                      </span><span class="p">),</span>
<a id="__codelineno-33-122" name="__codelineno-33-122"></a><span class="w">                      </span><span class="k">const</span><span class="w"> </span><span class="n">SizedBox</span><span class="p">(</span><span class="nl">height:</span><span class="w"> </span><span class="m">20</span><span class="p">),</span>
<a id="__codelineno-33-123" name="__codelineno-33-123"></a><span class="w">                      </span><span class="n">Text</span><span class="p">(</span>
<a id="__codelineno-33-124" name="__codelineno-33-124"></a><span class="w">                        </span><span class="n">DateFormat</span><span class="p">(</span><span class="s1">&#39;dd/MM/yyyy&#39;</span><span class="p">).</span><span class="n">format</span><span class="p">(</span><span class="n">product</span><span class="p">.</span><span class="n">available</span><span class="p">),</span>
<a id="__codelineno-33-125" name="__codelineno-33-125"></a><span class="w">                        </span><span class="nl">style:</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">TextStyle</span><span class="p">(</span><span class="nl">fontSize:</span><span class="w"> </span><span class="m">20</span><span class="p">),</span>
<a id="__codelineno-33-126" name="__codelineno-33-126"></a><span class="w">                      </span><span class="p">),</span>
<a id="__codelineno-33-127" name="__codelineno-33-127"></a><span class="w">                      </span><span class="k">const</span><span class="w"> </span><span class="n">SizedBox</span><span class="p">(</span><span class="nl">height:</span><span class="w"> </span><span class="m">20</span><span class="p">),</span>
<a id="__codelineno-33-128" name="__codelineno-33-128"></a><span class="w">                      </span><span class="n">Text</span><span class="p">(</span>
<a id="__codelineno-33-129" name="__codelineno-33-129"></a><span class="w">                        </span><span class="s1">&#39;Rating: </span><span class="si">${</span><span class="n">product</span><span class="p">.</span><span class="n">rating</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span>
<a id="__codelineno-33-130" name="__codelineno-33-130"></a><span class="w">                        </span><span class="nl">style:</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">TextStyle</span><span class="p">(</span><span class="nl">fontSize:</span><span class="w"> </span><span class="m">20</span><span class="p">),</span>
<a id="__codelineno-33-131" name="__codelineno-33-131"></a><span class="w">                      </span><span class="p">),</span>
<a id="__codelineno-33-132" name="__codelineno-33-132"></a><span class="w">                    </span><span class="p">],</span>
<a id="__codelineno-33-133" name="__codelineno-33-133"></a><span class="w">                  </span><span class="p">),</span>
<a id="__codelineno-33-134" name="__codelineno-33-134"></a><span class="w">                </span><span class="p">),</span>
<a id="__codelineno-33-135" name="__codelineno-33-135"></a><span class="w">              </span><span class="p">),</span>
<a id="__codelineno-33-136" name="__codelineno-33-136"></a><span class="w">            </span><span class="p">);</span>
<a id="__codelineno-33-137" name="__codelineno-33-137"></a><span class="w">          </span><span class="p">});</span>
<a id="__codelineno-33-138" name="__codelineno-33-138"></a><span class="w">        </span><span class="p">});</span>
<a id="__codelineno-33-139" name="__codelineno-33-139"></a><span class="w">  </span><span class="p">}</span>
<a id="__codelineno-33-140" name="__codelineno-33-140"></a><span class="p">}</span>
</code></pre></div></td></tr></table></div>
<ul>
<li>Se utiliza un <code>SingleChildScrollView</code> para que el contenido se pueda desplazar si no cabe en la pantalla.</li>
<li>Se utiliza un <code>ConstrainedBox</code> para que el contenido ocupe todo el ancho disponible.</li>
<li>Se utiliza <code>showDialog</code> para mostrar un diálogo de confirmación antes de eliminar un producto.</li>
<li>Se utiliza <code>Navigator.push</code> con <code>then</code> para actualizar la vista cuando se vuelve de la vista de edición.</li>
</ul>
<p>Para poder abrir la vista de detalle desde la vista principal, se debe añadir un <code>onTap</code> en el <code>ListTile</code>;</p>
<div class="highlight"><span class="filename">lib/main.dart</span><pre><span></span><code><a id="__codelineno-34-1" name="__codelineno-34-1" href="#__codelineno-34-1"></a><span class="p">...</span>
<a id="__codelineno-34-2" name="__codelineno-34-2" href="#__codelineno-34-2"></a><span class="w">                    </span><span class="k">return</span><span class="w"> </span><span class="n">ListTile</span><span class="p">(</span>
<a id="__codelineno-34-3" name="__codelineno-34-3" href="#__codelineno-34-3"></a><span class="hll"><span class="w">                      </span><span class="nl">onTap:</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="p">{</span>
</span><a id="__codelineno-34-4" name="__codelineno-34-4" href="#__codelineno-34-4"></a><span class="w">                        </span><span class="n">Navigator</span><span class="p">.</span><span class="n">push</span><span class="p">(</span>
<a id="__codelineno-34-5" name="__codelineno-34-5" href="#__codelineno-34-5"></a><span class="w">                          </span><span class="n">context</span><span class="p">,</span>
<a id="__codelineno-34-6" name="__codelineno-34-6" href="#__codelineno-34-6"></a><span class="w">                          </span><span class="n">MaterialPageRoute</span><span class="p">(</span>
<a id="__codelineno-34-7" name="__codelineno-34-7" href="#__codelineno-34-7"></a><span class="w">                              </span><span class="nl">builder:</span><span class="w"> </span><span class="p">(</span><span class="n">context</span><span class="p">)</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">ProductDetail</span><span class="p">(</span>
<a id="__codelineno-34-8" name="__codelineno-34-8" href="#__codelineno-34-8"></a><span class="w">                                    </span><span class="nl">product:</span><span class="w"> </span><span class="n">product</span><span class="p">,</span>
<a id="__codelineno-34-9" name="__codelineno-34-9" href="#__codelineno-34-9"></a><span class="w">                                  </span><span class="p">)),</span>
<a id="__codelineno-34-10" name="__codelineno-34-10" href="#__codelineno-34-10"></a><span class="hll"><span class="w">                        </span><span class="p">).</span><span class="n">then</span><span class="p">((</span><span class="n">value</span><span class="p">)</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="p">{</span><span class="n">setState</span><span class="p">(()</span><span class="w"> </span><span class="p">{})})</span>
</span><a id="__codelineno-34-11" name="__codelineno-34-11" href="#__codelineno-34-11"></a><span class="w">                      </span><span class="p">},</span>
<a id="__codelineno-34-12" name="__codelineno-34-12" href="#__codelineno-34-12"></a><span class="p">...</span>
</code></pre></div>
<ul>
<li>Utiliza <code>Navigator.push</code> con <code>then</code> para actualizar la vista cuando se vuelve de la vista de detalle.</li>
<li>Se llama a <code>setState</code> para actualizar la vista cuando se vuelve de la vista de detalle, ya que puede haberse editado o borrado el producto.</li>
</ul>
<p><img alt="Detalle producto" src="../assets/ud5_6_4.png" /></p>
<h3 id="vista-edicion">Vista edición<a class="headerlink" href="#vista-edicion" title="Permanent link">&para;</a></h3>
<p>Para implementar la vista de edición de un producto, se crea <code>ProductEdit</code> en <code>pages/product_edit.dart</code>. Se utiliza el mismo formulario que en la vista de creación, pero se inicializan los campos con los valores del producto.</p>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">lib/pages/product_edit.dart</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-35-1">  1</a></span>
<span class="normal"><a href="#__codelineno-35-2">  2</a></span>
<span class="normal"><a href="#__codelineno-35-3">  3</a></span>
<span class="normal"><a href="#__codelineno-35-4">  4</a></span>
<span class="normal"><a href="#__codelineno-35-5">  5</a></span>
<span class="normal"><a href="#__codelineno-35-6">  6</a></span>
<span class="normal"><a href="#__codelineno-35-7">  7</a></span>
<span class="normal"><a href="#__codelineno-35-8">  8</a></span>
<span class="normal"><a href="#__codelineno-35-9">  9</a></span>
<span class="normal"><a href="#__codelineno-35-10"> 10</a></span>
<span class="normal"><a href="#__codelineno-35-11"> 11</a></span>
<span class="normal"><a href="#__codelineno-35-12"> 12</a></span>
<span class="normal"><a href="#__codelineno-35-13"> 13</a></span>
<span class="normal"><a href="#__codelineno-35-14"> 14</a></span>
<span class="normal"><a href="#__codelineno-35-15"> 15</a></span>
<span class="normal"><a href="#__codelineno-35-16"> 16</a></span>
<span class="normal"><a href="#__codelineno-35-17"> 17</a></span>
<span class="normal"><a href="#__codelineno-35-18"> 18</a></span>
<span class="normal"><a href="#__codelineno-35-19"> 19</a></span>
<span class="normal"><a href="#__codelineno-35-20"> 20</a></span>
<span class="normal"><a href="#__codelineno-35-21"> 21</a></span>
<span class="normal"><a href="#__codelineno-35-22"> 22</a></span>
<span class="normal"><a href="#__codelineno-35-23"> 23</a></span>
<span class="normal"><a href="#__codelineno-35-24"> 24</a></span>
<span class="normal"><a href="#__codelineno-35-25"> 25</a></span>
<span class="normal"><a href="#__codelineno-35-26"> 26</a></span>
<span class="normal"><a href="#__codelineno-35-27"> 27</a></span>
<span class="normal"><a href="#__codelineno-35-28"> 28</a></span>
<span class="normal"><a href="#__codelineno-35-29"> 29</a></span>
<span class="normal"><a href="#__codelineno-35-30"> 30</a></span>
<span class="normal"><a href="#__codelineno-35-31"> 31</a></span>
<span class="normal"><a href="#__codelineno-35-32"> 32</a></span>
<span class="normal"><a href="#__codelineno-35-33"> 33</a></span>
<span class="normal"><a href="#__codelineno-35-34"> 34</a></span>
<span class="normal"><a href="#__codelineno-35-35"> 35</a></span>
<span class="normal"><a href="#__codelineno-35-36"> 36</a></span>
<span class="normal"><a href="#__codelineno-35-37"> 37</a></span>
<span class="normal"><a href="#__codelineno-35-38"> 38</a></span>
<span class="normal"><a href="#__codelineno-35-39"> 39</a></span>
<span class="normal"><a href="#__codelineno-35-40"> 40</a></span>
<span class="normal"><a href="#__codelineno-35-41"> 41</a></span>
<span class="normal"><a href="#__codelineno-35-42"> 42</a></span>
<span class="normal"><a href="#__codelineno-35-43"> 43</a></span>
<span class="normal"><a href="#__codelineno-35-44"> 44</a></span>
<span class="normal"><a href="#__codelineno-35-45"> 45</a></span>
<span class="normal"><a href="#__codelineno-35-46"> 46</a></span>
<span class="normal"><a href="#__codelineno-35-47"> 47</a></span>
<span class="normal"><a href="#__codelineno-35-48"> 48</a></span>
<span class="normal"><a href="#__codelineno-35-49"> 49</a></span>
<span class="normal"><a href="#__codelineno-35-50"> 50</a></span>
<span class="normal"><a href="#__codelineno-35-51"> 51</a></span>
<span class="normal"><a href="#__codelineno-35-52"> 52</a></span>
<span class="normal"><a href="#__codelineno-35-53"> 53</a></span>
<span class="normal"><a href="#__codelineno-35-54"> 54</a></span>
<span class="normal"><a href="#__codelineno-35-55"> 55</a></span>
<span class="normal"><a href="#__codelineno-35-56"> 56</a></span>
<span class="normal"><a href="#__codelineno-35-57"> 57</a></span>
<span class="normal"><a href="#__codelineno-35-58"> 58</a></span>
<span class="normal"><a href="#__codelineno-35-59"> 59</a></span>
<span class="normal"><a href="#__codelineno-35-60"> 60</a></span>
<span class="normal"><a href="#__codelineno-35-61"> 61</a></span>
<span class="normal"><a href="#__codelineno-35-62"> 62</a></span>
<span class="normal"><a href="#__codelineno-35-63"> 63</a></span>
<span class="normal"><a href="#__codelineno-35-64"> 64</a></span>
<span class="normal"><a href="#__codelineno-35-65"> 65</a></span>
<span class="normal"><a href="#__codelineno-35-66"> 66</a></span>
<span class="normal"><a href="#__codelineno-35-67"> 67</a></span>
<span class="normal"><a href="#__codelineno-35-68"> 68</a></span>
<span class="normal"><a href="#__codelineno-35-69"> 69</a></span>
<span class="normal"><a href="#__codelineno-35-70"> 70</a></span>
<span class="normal"><a href="#__codelineno-35-71"> 71</a></span>
<span class="normal"><a href="#__codelineno-35-72"> 72</a></span>
<span class="normal"><a href="#__codelineno-35-73"> 73</a></span>
<span class="normal"><a href="#__codelineno-35-74"> 74</a></span>
<span class="normal"><a href="#__codelineno-35-75"> 75</a></span>
<span class="normal"><a href="#__codelineno-35-76"> 76</a></span>
<span class="normal"><a href="#__codelineno-35-77"> 77</a></span>
<span class="normal"><a href="#__codelineno-35-78"> 78</a></span>
<span class="normal"><a href="#__codelineno-35-79"> 79</a></span>
<span class="normal"><a href="#__codelineno-35-80"> 80</a></span>
<span class="normal"><a href="#__codelineno-35-81"> 81</a></span>
<span class="normal"><a href="#__codelineno-35-82"> 82</a></span>
<span class="normal"><a href="#__codelineno-35-83"> 83</a></span>
<span class="normal"><a href="#__codelineno-35-84"> 84</a></span>
<span class="normal"><a href="#__codelineno-35-85"> 85</a></span>
<span class="normal"><a href="#__codelineno-35-86"> 86</a></span>
<span class="normal"><a href="#__codelineno-35-87"> 87</a></span>
<span class="normal"><a href="#__codelineno-35-88"> 88</a></span>
<span class="normal"><a href="#__codelineno-35-89"> 89</a></span>
<span class="normal"><a href="#__codelineno-35-90"> 90</a></span>
<span class="normal"><a href="#__codelineno-35-91"> 91</a></span>
<span class="normal"><a href="#__codelineno-35-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-35-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-35-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-35-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-35-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-35-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-35-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-35-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-35-100">100</a></span>
<span class="normal"><a href="#__codelineno-35-101">101</a></span>
<span class="normal"><a href="#__codelineno-35-102">102</a></span>
<span class="normal"><a href="#__codelineno-35-103">103</a></span>
<span class="normal"><a href="#__codelineno-35-104">104</a></span>
<span class="normal"><a href="#__codelineno-35-105">105</a></span>
<span class="normal"><a href="#__codelineno-35-106">106</a></span>
<span class="normal"><a href="#__codelineno-35-107">107</a></span>
<span class="normal"><a href="#__codelineno-35-108">108</a></span>
<span class="normal"><a href="#__codelineno-35-109">109</a></span>
<span class="normal"><a href="#__codelineno-35-110">110</a></span>
<span class="normal"><a href="#__codelineno-35-111">111</a></span>
<span class="normal"><a href="#__codelineno-35-112">112</a></span>
<span class="normal"><a href="#__codelineno-35-113">113</a></span>
<span class="normal"><a href="#__codelineno-35-114">114</a></span>
<span class="normal"><a href="#__codelineno-35-115">115</a></span>
<span class="normal"><a href="#__codelineno-35-116">116</a></span>
<span class="normal"><a href="#__codelineno-35-117">117</a></span>
<span class="normal"><a href="#__codelineno-35-118">118</a></span>
<span class="normal"><a href="#__codelineno-35-119">119</a></span>
<span class="normal"><a href="#__codelineno-35-120">120</a></span>
<span class="normal"><a href="#__codelineno-35-121">121</a></span>
<span class="normal"><a href="#__codelineno-35-122">122</a></span>
<span class="normal"><a href="#__codelineno-35-123">123</a></span>
<span class="normal"><a href="#__codelineno-35-124">124</a></span>
<span class="normal"><a href="#__codelineno-35-125">125</a></span>
<span class="normal"><a href="#__codelineno-35-126">126</a></span>
<span class="normal"><a href="#__codelineno-35-127">127</a></span>
<span class="normal"><a href="#__codelineno-35-128">128</a></span>
<span class="normal"><a href="#__codelineno-35-129">129</a></span>
<span class="normal"><a href="#__codelineno-35-130">130</a></span>
<span class="normal"><a href="#__codelineno-35-131">131</a></span>
<span class="normal"><a href="#__codelineno-35-132">132</a></span>
<span class="normal"><a href="#__codelineno-35-133">133</a></span>
<span class="normal"><a href="#__codelineno-35-134">134</a></span>
<span class="normal"><a href="#__codelineno-35-135">135</a></span>
<span class="normal"><a href="#__codelineno-35-136">136</a></span>
<span class="normal"><a href="#__codelineno-35-137">137</a></span>
<span class="normal"><a href="#__codelineno-35-138">138</a></span>
<span class="normal"><a href="#__codelineno-35-139">139</a></span>
<span class="normal"><a href="#__codelineno-35-140">140</a></span>
<span class="normal"><a href="#__codelineno-35-141">141</a></span>
<span class="normal"><a href="#__codelineno-35-142">142</a></span>
<span class="normal"><a href="#__codelineno-35-143">143</a></span>
<span class="normal"><a href="#__codelineno-35-144">144</a></span>
<span class="normal"><a href="#__codelineno-35-145">145</a></span>
<span class="normal"><a href="#__codelineno-35-146">146</a></span>
<span class="normal"><a href="#__codelineno-35-147">147</a></span>
<span class="normal"><a href="#__codelineno-35-148">148</a></span>
<span class="normal"><a href="#__codelineno-35-149">149</a></span>
<span class="normal"><a href="#__codelineno-35-150">150</a></span>
<span class="normal"><a href="#__codelineno-35-151">151</a></span>
<span class="normal"><a href="#__codelineno-35-152">152</a></span>
<span class="normal"><a href="#__codelineno-35-153">153</a></span>
<span class="normal"><a href="#__codelineno-35-154">154</a></span>
<span class="normal"><a href="#__codelineno-35-155">155</a></span>
<span class="normal"><a href="#__codelineno-35-156">156</a></span>
<span class="normal"><a href="#__codelineno-35-157">157</a></span>
<span class="normal"><a href="#__codelineno-35-158">158</a></span>
<span class="normal"><a href="#__codelineno-35-159">159</a></span>
<span class="normal"><a href="#__codelineno-35-160">160</a></span>
<span class="normal"><a href="#__codelineno-35-161">161</a></span>
<span class="normal"><a href="#__codelineno-35-162">162</a></span>
<span class="normal"><a href="#__codelineno-35-163">163</a></span>
<span class="normal"><a href="#__codelineno-35-164">164</a></span>
<span class="normal"><a href="#__codelineno-35-165">165</a></span>
<span class="normal"><a href="#__codelineno-35-166">166</a></span>
<span class="normal"><a href="#__codelineno-35-167">167</a></span>
<span class="normal"><a href="#__codelineno-35-168">168</a></span>
<span class="normal"><a href="#__codelineno-35-169">169</a></span>
<span class="normal"><a href="#__codelineno-35-170">170</a></span>
<span class="normal"><a href="#__codelineno-35-171">171</a></span>
<span class="normal"><a href="#__codelineno-35-172">172</a></span>
<span class="normal"><a href="#__codelineno-35-173">173</a></span>
<span class="normal"><a href="#__codelineno-35-174">174</a></span>
<span class="normal"><a href="#__codelineno-35-175">175</a></span>
<span class="normal"><a href="#__codelineno-35-176">176</a></span>
<span class="normal"><a href="#__codelineno-35-177">177</a></span>
<span class="normal"><a href="#__codelineno-35-178">178</a></span>
<span class="normal"><a href="#__codelineno-35-179">179</a></span>
<span class="normal"><a href="#__codelineno-35-180">180</a></span>
<span class="normal"><a href="#__codelineno-35-181">181</a></span>
<span class="normal"><a href="#__codelineno-35-182">182</a></span>
<span class="normal"><a href="#__codelineno-35-183">183</a></span>
<span class="normal"><a href="#__codelineno-35-184">184</a></span>
<span class="normal"><a href="#__codelineno-35-185">185</a></span>
<span class="normal"><a href="#__codelineno-35-186">186</a></span>
<span class="normal"><a href="#__codelineno-35-187">187</a></span>
<span class="normal"><a href="#__codelineno-35-188">188</a></span>
<span class="normal"><a href="#__codelineno-35-189">189</a></span>
<span class="normal"><a href="#__codelineno-35-190">190</a></span>
<span class="normal"><a href="#__codelineno-35-191">191</a></span>
<span class="normal"><a href="#__codelineno-35-192">192</a></span>
<span class="normal"><a href="#__codelineno-35-193">193</a></span>
<span class="normal"><a href="#__codelineno-35-194">194</a></span>
<span class="normal"><a href="#__codelineno-35-195">195</a></span>
<span class="normal"><a href="#__codelineno-35-196">196</a></span>
<span class="normal"><a href="#__codelineno-35-197">197</a></span>
<span class="normal"><a href="#__codelineno-35-198">198</a></span>
<span class="normal"><a href="#__codelineno-35-199">199</a></span>
<span class="normal"><a href="#__codelineno-35-200">200</a></span>
<span class="normal"><a href="#__codelineno-35-201">201</a></span>
<span class="normal"><a href="#__codelineno-35-202">202</a></span>
<span class="normal"><a href="#__codelineno-35-203">203</a></span>
<span class="normal"><a href="#__codelineno-35-204">204</a></span>
<span class="normal"><a href="#__codelineno-35-205">205</a></span>
<span class="normal"><a href="#__codelineno-35-206">206</a></span>
<span class="normal"><a href="#__codelineno-35-207">207</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-35-1" name="__codelineno-35-1"></a><span class="k">import</span><span class="w"> </span><span class="s1">&#39;package:flutter/material.dart&#39;</span><span class="p">;</span>
<a id="__codelineno-35-2" name="__codelineno-35-2"></a>
<a id="__codelineno-35-3" name="__codelineno-35-3"></a><span class="k">import</span><span class="w"> </span><span class="s1">&#39;dart:io&#39;</span><span class="p">;</span>
<a id="__codelineno-35-4" name="__codelineno-35-4"></a><span class="k">import</span><span class="w"> </span><span class="s1">&#39;package:flutter/services.dart&#39;</span><span class="p">;</span>
<a id="__codelineno-35-5" name="__codelineno-35-5"></a><span class="k">import</span><span class="w"> </span><span class="s1">&#39;package:image_picker/image_picker.dart&#39;</span><span class="p">;</span>
<a id="__codelineno-35-6" name="__codelineno-35-6"></a><span class="k">import</span><span class="w"> </span><span class="s1">&#39;package:intl/intl.dart&#39;</span><span class="p">;</span>
<a id="__codelineno-35-7" name="__codelineno-35-7"></a>
<a id="__codelineno-35-8" name="__codelineno-35-8"></a><span class="k">import</span><span class="w"> </span><span class="s1">&#39;../models/product.dart&#39;</span><span class="p">;</span>
<a id="__codelineno-35-9" name="__codelineno-35-9"></a><span class="k">import</span><span class="w"> </span><span class="s1">&#39;../provider/products_service.dart&#39;</span><span class="p">;</span>
<a id="__codelineno-35-10" name="__codelineno-35-10"></a>
<a id="__codelineno-35-11" name="__codelineno-35-11"></a><span class="kd">class</span><span class="w"> </span><span class="nc">ProductEdit</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">StatefulWidget</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-35-12" name="__codelineno-35-12"></a><span class="w">  </span><span class="kd">final</span><span class="w"> </span><span class="n">Product</span><span class="w"> </span><span class="n">product</span><span class="p">;</span>
<a id="__codelineno-35-13" name="__codelineno-35-13"></a><span class="w">  </span><span class="k">const</span><span class="w"> </span><span class="n">ProductEdit</span><span class="p">({</span><span class="k">super</span><span class="p">.</span><span class="n">key</span><span class="p">,</span><span class="w"> </span><span class="kd">required</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="n">product</span><span class="p">});</span>
<a id="__codelineno-35-14" name="__codelineno-35-14"></a>
<a id="__codelineno-35-15" name="__codelineno-35-15"></a><span class="w">  </span><span class="nd">@override</span>
<a id="__codelineno-35-16" name="__codelineno-35-16"></a><span class="w">  </span><span class="n">State</span><span class="o">&lt;</span><span class="n">ProductEdit</span><span class="o">&gt;</span><span class="w"> </span><span class="n">createState</span><span class="p">()</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">_ProductEditState</span><span class="p">();</span>
<a id="__codelineno-35-17" name="__codelineno-35-17"></a><span class="p">}</span>
<a id="__codelineno-35-18" name="__codelineno-35-18"></a>
<a id="__codelineno-35-19" name="__codelineno-35-19"></a><span class="kd">class</span><span class="w"> </span><span class="nc">_ProductEditState</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">State</span><span class="o">&lt;</span><span class="n">ProductEdit</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-35-20" name="__codelineno-35-20"></a><span class="w">  </span><span class="kd">final</span><span class="w"> </span><span class="n">ProductsService</span><span class="w"> </span><span class="n">productsNotifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ProductsService</span><span class="p">();</span>
<a id="__codelineno-35-21" name="__codelineno-35-21"></a>
<a id="__codelineno-35-22" name="__codelineno-35-22"></a><span class="w">  </span><span class="kd">final</span><span class="w"> </span><span class="n">_formKey</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">GlobalKey</span><span class="o">&lt;</span><span class="n">FormState</span><span class="o">&gt;</span><span class="p">();</span>
<a id="__codelineno-35-23" name="__codelineno-35-23"></a><span class="w">  </span><span class="kd">final</span><span class="w"> </span><span class="n">TextEditingController</span><span class="w"> </span><span class="n">_descriptionController</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TextEditingController</span><span class="p">();</span>
<a id="__codelineno-35-24" name="__codelineno-35-24"></a><span class="w">  </span><span class="kd">final</span><span class="w"> </span><span class="n">TextEditingController</span><span class="w"> </span><span class="n">_priceController</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TextEditingController</span><span class="p">();</span>
<a id="__codelineno-35-25" name="__codelineno-35-25"></a><span class="w">  </span><span class="kd">final</span><span class="w"> </span><span class="n">TextEditingController</span><span class="w"> </span><span class="n">_availableController</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TextEditingController</span><span class="p">();</span>
<a id="__codelineno-35-26" name="__codelineno-35-26"></a><span class="w">  </span><span class="kd">final</span><span class="w"> </span><span class="n">TextEditingController</span><span class="w"> </span><span class="n">_imageUrlController</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TextEditingController</span><span class="p">();</span>
<a id="__codelineno-35-27" name="__codelineno-35-27"></a><span class="w">  </span><span class="kd">final</span><span class="w"> </span><span class="n">TextEditingController</span><span class="w"> </span><span class="n">_ratingController</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TextEditingController</span><span class="p">();</span>
<a id="__codelineno-35-28" name="__codelineno-35-28"></a>
<a id="__codelineno-35-29" name="__codelineno-35-29"></a><span class="w">  </span><span class="kd">late</span><span class="w"> </span><span class="n">Product</span><span class="w"> </span><span class="n">product</span><span class="p">;</span>
<a id="__codelineno-35-30" name="__codelineno-35-30"></a>
<a id="__codelineno-35-31" name="__codelineno-35-31"></a><span class="w">  </span><span class="nd">@override</span>
<a id="__codelineno-35-32" name="__codelineno-35-32"></a><span class="hll"><span class="w">  </span><span class="kt">void</span><span class="w"> </span><span class="n">initState</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><a id="__codelineno-35-33" name="__codelineno-35-33"></a><span class="w">    </span><span class="n">product</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">widget</span><span class="p">.</span><span class="n">product</span><span class="p">;</span>
<a id="__codelineno-35-34" name="__codelineno-35-34"></a><span class="w">    </span><span class="n">_descriptionController</span><span class="p">.</span><span class="n">text</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">product</span><span class="p">.</span><span class="n">description</span><span class="p">;</span>
<a id="__codelineno-35-35" name="__codelineno-35-35"></a><span class="w">    </span><span class="n">_priceController</span><span class="p">.</span><span class="n">text</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">product</span><span class="p">.</span><span class="n">price</span><span class="p">.</span><span class="n">toString</span><span class="p">();</span>
<a id="__codelineno-35-36" name="__codelineno-35-36"></a><span class="w">    </span><span class="n">_availableController</span><span class="p">.</span><span class="n">text</span><span class="w"> </span><span class="o">=</span>
<a id="__codelineno-35-37" name="__codelineno-35-37"></a><span class="w">        </span><span class="n">DateFormat</span><span class="p">(</span><span class="s1">&#39;yyyy-MM-dd&#39;</span><span class="p">).</span><span class="n">format</span><span class="p">(</span><span class="n">product</span><span class="p">.</span><span class="n">available</span><span class="p">);</span>
<a id="__codelineno-35-38" name="__codelineno-35-38"></a><span class="w">    </span><span class="n">_imageUrlController</span><span class="p">.</span><span class="n">text</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">product</span><span class="p">.</span><span class="n">imageUrl</span><span class="p">;</span>
<a id="__codelineno-35-39" name="__codelineno-35-39"></a><span class="w">    </span><span class="n">_ratingController</span><span class="p">.</span><span class="n">text</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">product</span><span class="p">.</span><span class="n">rating</span><span class="p">.</span><span class="n">toString</span><span class="p">();</span>
<a id="__codelineno-35-40" name="__codelineno-35-40"></a><span class="w">    </span><span class="k">super</span><span class="p">.</span><span class="n">initState</span><span class="p">();</span>
<a id="__codelineno-35-41" name="__codelineno-35-41"></a><span class="w">  </span><span class="p">}</span>
<a id="__codelineno-35-42" name="__codelineno-35-42"></a>
<a id="__codelineno-35-43" name="__codelineno-35-43"></a><span class="w">  </span><span class="nd">@override</span>
<a id="__codelineno-35-44" name="__codelineno-35-44"></a><span class="w">  </span><span class="kt">void</span><span class="w"> </span><span class="n">dispose</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-35-45" name="__codelineno-35-45"></a><span class="w">    </span><span class="k">super</span><span class="p">.</span><span class="n">dispose</span><span class="p">();</span>
<a id="__codelineno-35-46" name="__codelineno-35-46"></a><span class="w">    </span><span class="n">_descriptionController</span><span class="p">.</span><span class="n">dispose</span><span class="p">();</span>
<a id="__codelineno-35-47" name="__codelineno-35-47"></a><span class="w">    </span><span class="n">_priceController</span><span class="p">.</span><span class="n">dispose</span><span class="p">();</span>
<a id="__codelineno-35-48" name="__codelineno-35-48"></a><span class="w">    </span><span class="n">_availableController</span><span class="p">.</span><span class="n">dispose</span><span class="p">();</span>
<a id="__codelineno-35-49" name="__codelineno-35-49"></a><span class="w">    </span><span class="n">_imageUrlController</span><span class="p">.</span><span class="n">dispose</span><span class="p">();</span>
<a id="__codelineno-35-50" name="__codelineno-35-50"></a><span class="w">    </span><span class="n">_ratingController</span><span class="p">.</span><span class="n">dispose</span><span class="p">();</span>
<a id="__codelineno-35-51" name="__codelineno-35-51"></a><span class="w">  </span><span class="p">}</span>
<a id="__codelineno-35-52" name="__codelineno-35-52"></a>
<a id="__codelineno-35-53" name="__codelineno-35-53"></a><span class="w">  </span><span class="nd">@override</span>
<a id="__codelineno-35-54" name="__codelineno-35-54"></a><span class="w">  </span><span class="n">Widget</span><span class="w"> </span><span class="n">build</span><span class="p">(</span><span class="n">BuildContext</span><span class="w"> </span><span class="n">context</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-35-55" name="__codelineno-35-55"></a><span class="w">    </span><span class="n">File</span><span class="o">?</span><span class="w"> </span><span class="n">image</span><span class="p">;</span>
<a id="__codelineno-35-56" name="__codelineno-35-56"></a>
<a id="__codelineno-35-57" name="__codelineno-35-57"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">Scaffold</span><span class="p">(</span>
<a id="__codelineno-35-58" name="__codelineno-35-58"></a><span class="w">      </span><span class="nl">appBar:</span><span class="w"> </span><span class="n">AppBar</span><span class="p">(</span>
<a id="__codelineno-35-59" name="__codelineno-35-59"></a><span class="w">        </span><span class="nl">title:</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span>
<a id="__codelineno-35-60" name="__codelineno-35-60"></a><span class="w">          </span><span class="n">product</span><span class="p">.</span><span class="n">description</span><span class="p">,</span>
<a id="__codelineno-35-61" name="__codelineno-35-61"></a><span class="w">        </span><span class="p">),</span>
<a id="__codelineno-35-62" name="__codelineno-35-62"></a><span class="w">      </span><span class="p">),</span>
<a id="__codelineno-35-63" name="__codelineno-35-63"></a><span class="w">      </span><span class="nl">body:</span><span class="w"> </span><span class="n">Form</span><span class="p">(</span>
<a id="__codelineno-35-64" name="__codelineno-35-64"></a><span class="w">        </span><span class="nl">key:</span><span class="w"> </span><span class="n">_formKey</span><span class="p">,</span>
<a id="__codelineno-35-65" name="__codelineno-35-65"></a><span class="w">        </span><span class="nl">child:</span><span class="w"> </span><span class="n">SingleChildScrollView</span><span class="p">(</span>
<a id="__codelineno-35-66" name="__codelineno-35-66"></a><span class="w">          </span><span class="nl">padding:</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">EdgeInsets</span><span class="p">.</span><span class="n">all</span><span class="p">(</span><span class="m">30</span><span class="p">),</span>
<a id="__codelineno-35-67" name="__codelineno-35-67"></a><span class="w">          </span><span class="nl">child:</span><span class="w"> </span><span class="n">Column</span><span class="p">(</span>
<a id="__codelineno-35-68" name="__codelineno-35-68"></a><span class="w">            </span><span class="nl">children:</span><span class="w"> </span><span class="p">[</span>
<a id="__codelineno-35-69" name="__codelineno-35-69"></a><span class="w">              </span><span class="n">TextFormField</span><span class="p">(</span>
<a id="__codelineno-35-70" name="__codelineno-35-70"></a><span class="w">                </span><span class="nl">controller:</span><span class="w"> </span><span class="n">_descriptionController</span><span class="p">,</span>
<a id="__codelineno-35-71" name="__codelineno-35-71"></a><span class="w">                </span><span class="nl">decoration:</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">InputDecoration</span><span class="p">(</span>
<a id="__codelineno-35-72" name="__codelineno-35-72"></a><span class="w">                  </span><span class="nl">icon:</span><span class="w"> </span><span class="n">Icon</span><span class="p">(</span><span class="n">Icons</span><span class="p">.</span><span class="n">description_outlined</span><span class="p">),</span>
<a id="__codelineno-35-73" name="__codelineno-35-73"></a><span class="w">                  </span><span class="nl">labelText:</span><span class="w"> </span><span class="s1">&#39;Descripción&#39;</span><span class="p">,</span>
<a id="__codelineno-35-74" name="__codelineno-35-74"></a><span class="w">                </span><span class="p">),</span>
<a id="__codelineno-35-75" name="__codelineno-35-75"></a><span class="w">                </span><span class="nl">validator:</span><span class="w"> </span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-35-76" name="__codelineno-35-76"></a><span class="w">                  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">value</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="kc">null</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">value</span><span class="p">.</span><span class="n">isEmpty</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-35-77" name="__codelineno-35-77"></a><span class="w">                    </span><span class="k">return</span><span class="w"> </span><span class="s1">&#39;Introduzca una descripción&#39;</span><span class="p">;</span>
<a id="__codelineno-35-78" name="__codelineno-35-78"></a><span class="w">                  </span><span class="p">}</span>
<a id="__codelineno-35-79" name="__codelineno-35-79"></a><span class="w">                  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">value</span><span class="p">.</span><span class="n">length</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="m">5</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-35-80" name="__codelineno-35-80"></a><span class="w">                    </span><span class="k">return</span><span class="w"> </span><span class="s1">&#39;La descripción debe tener al menos 5 caracteres&#39;</span><span class="p">;</span>
<a id="__codelineno-35-81" name="__codelineno-35-81"></a><span class="w">                  </span><span class="p">}</span>
<a id="__codelineno-35-82" name="__codelineno-35-82"></a><span class="w">                  </span><span class="k">return</span><span class="w"> </span><span class="kc">null</span><span class="p">;</span>
<a id="__codelineno-35-83" name="__codelineno-35-83"></a><span class="w">                </span><span class="p">},</span>
<a id="__codelineno-35-84" name="__codelineno-35-84"></a><span class="w">              </span><span class="p">),</span>
<a id="__codelineno-35-85" name="__codelineno-35-85"></a><span class="w">              </span><span class="n">TextFormField</span><span class="p">(</span>
<a id="__codelineno-35-86" name="__codelineno-35-86"></a><span class="w">                </span><span class="nl">controller:</span><span class="w"> </span><span class="n">_priceController</span><span class="p">,</span>
<a id="__codelineno-35-87" name="__codelineno-35-87"></a><span class="w">                </span><span class="nl">decoration:</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">InputDecoration</span><span class="p">(</span>
<a id="__codelineno-35-88" name="__codelineno-35-88"></a><span class="w">                  </span><span class="nl">icon:</span><span class="w"> </span><span class="n">Icon</span><span class="p">(</span><span class="n">Icons</span><span class="p">.</span><span class="n">attach_money_outlined</span><span class="p">),</span>
<a id="__codelineno-35-89" name="__codelineno-35-89"></a><span class="w">                  </span><span class="nl">labelText:</span><span class="w"> </span><span class="s1">&#39;Precio&#39;</span><span class="p">,</span>
<a id="__codelineno-35-90" name="__codelineno-35-90"></a><span class="w">                </span><span class="p">),</span>
<a id="__codelineno-35-91" name="__codelineno-35-91"></a><span class="w">                </span><span class="nl">keyboardType:</span><span class="w"> </span><span class="n">TextInputType</span><span class="p">.</span><span class="n">number</span><span class="p">,</span>
<a id="__codelineno-35-92" name="__codelineno-35-92"></a><span class="w">                </span><span class="nl">validator:</span><span class="w"> </span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-35-93" name="__codelineno-35-93"></a><span class="w">                  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">value</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="kc">null</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">value</span><span class="p">.</span><span class="n">isEmpty</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-35-94" name="__codelineno-35-94"></a><span class="w">                    </span><span class="k">return</span><span class="w"> </span><span class="s1">&#39;Introduzca un precio&#39;</span><span class="p">;</span>
<a id="__codelineno-35-95" name="__codelineno-35-95"></a><span class="w">                  </span><span class="p">}</span>
<a id="__codelineno-35-96" name="__codelineno-35-96"></a><span class="w">                  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="kt">double</span><span class="p">.</span><span class="n">tryParse</span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-35-97" name="__codelineno-35-97"></a><span class="w">                    </span><span class="k">return</span><span class="w"> </span><span class="s1">&#39;Introduzca un valor numérico&#39;</span><span class="p">;</span>
<a id="__codelineno-35-98" name="__codelineno-35-98"></a><span class="w">                  </span><span class="p">}</span>
<a id="__codelineno-35-99" name="__codelineno-35-99"></a><span class="w">                  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="kt">double</span><span class="p">.</span><span class="n">tryParse</span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="o">!</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="m">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-35-100" name="__codelineno-35-100"></a><span class="w">                    </span><span class="k">return</span><span class="w"> </span><span class="s1">&#39;Introduzca un valor mayor que 0&#39;</span><span class="p">;</span>
<a id="__codelineno-35-101" name="__codelineno-35-101"></a><span class="w">                  </span><span class="p">}</span>
<a id="__codelineno-35-102" name="__codelineno-35-102"></a><span class="w">                  </span><span class="k">return</span><span class="w"> </span><span class="kc">null</span><span class="p">;</span>
<a id="__codelineno-35-103" name="__codelineno-35-103"></a><span class="w">                </span><span class="p">},</span>
<a id="__codelineno-35-104" name="__codelineno-35-104"></a><span class="w">              </span><span class="p">),</span>
<a id="__codelineno-35-105" name="__codelineno-35-105"></a><span class="w">              </span><span class="n">TextFormField</span><span class="p">(</span>
<a id="__codelineno-35-106" name="__codelineno-35-106"></a><span class="w">                </span><span class="nl">controller:</span><span class="w"> </span><span class="n">_availableController</span><span class="p">,</span>
<a id="__codelineno-35-107" name="__codelineno-35-107"></a><span class="w">                </span><span class="nl">decoration:</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">InputDecoration</span><span class="p">(</span>
<a id="__codelineno-35-108" name="__codelineno-35-108"></a><span class="w">                  </span><span class="nl">icon:</span><span class="w"> </span><span class="n">Icon</span><span class="p">(</span><span class="n">Icons</span><span class="p">.</span><span class="n">calendar_today</span><span class="p">),</span>
<a id="__codelineno-35-109" name="__codelineno-35-109"></a><span class="w">                  </span><span class="nl">labelText:</span><span class="w"> </span><span class="s1">&#39;Disponible&#39;</span><span class="p">,</span>
<a id="__codelineno-35-110" name="__codelineno-35-110"></a><span class="w">                </span><span class="p">),</span>
<a id="__codelineno-35-111" name="__codelineno-35-111"></a><span class="w">                </span><span class="nl">readOnly:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<a id="__codelineno-35-112" name="__codelineno-35-112"></a><span class="w">                </span><span class="nl">onTap:</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-35-113" name="__codelineno-35-113"></a><span class="w">                  </span><span class="kd">final</span><span class="w"> </span><span class="n">DateTime</span><span class="o">?</span><span class="w"> </span><span class="n">picked</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">await</span><span class="w"> </span><span class="n">showDatePicker</span><span class="p">(</span>
<a id="__codelineno-35-114" name="__codelineno-35-114"></a><span class="w">                    </span><span class="nl">context:</span><span class="w"> </span><span class="n">context</span><span class="p">,</span>
<a id="__codelineno-35-115" name="__codelineno-35-115"></a><span class="w">                    </span><span class="nl">initialDate:</span><span class="w"> </span><span class="n">DateTime</span><span class="p">.</span><span class="n">now</span><span class="p">(),</span>
<a id="__codelineno-35-116" name="__codelineno-35-116"></a><span class="w">                    </span><span class="nl">firstDate:</span><span class="w"> </span><span class="n">DateTime</span><span class="p">(</span><span class="m">2000</span><span class="p">),</span>
<a id="__codelineno-35-117" name="__codelineno-35-117"></a><span class="w">                    </span><span class="nl">lastDate:</span><span class="w"> </span><span class="n">DateTime</span><span class="p">(</span><span class="m">2100</span><span class="p">),</span>
<a id="__codelineno-35-118" name="__codelineno-35-118"></a><span class="w">                  </span><span class="p">);</span>
<a id="__codelineno-35-119" name="__codelineno-35-119"></a><span class="w">                  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">picked</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-35-120" name="__codelineno-35-120"></a><span class="w">                    </span><span class="n">setState</span><span class="p">(()</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-35-121" name="__codelineno-35-121"></a><span class="w">                      </span><span class="n">_availableController</span><span class="p">.</span><span class="n">text</span><span class="w"> </span><span class="o">=</span>
<a id="__codelineno-35-122" name="__codelineno-35-122"></a><span class="w">                          </span><span class="n">DateFormat</span><span class="p">(</span><span class="s1">&#39;yyyy-MM-dd&#39;</span><span class="p">).</span><span class="n">format</span><span class="p">(</span><span class="n">picked</span><span class="p">);</span>
<a id="__codelineno-35-123" name="__codelineno-35-123"></a><span class="w">                    </span><span class="p">});</span>
<a id="__codelineno-35-124" name="__codelineno-35-124"></a><span class="w">                  </span><span class="p">}</span>
<a id="__codelineno-35-125" name="__codelineno-35-125"></a><span class="w">                </span><span class="p">},</span>
<a id="__codelineno-35-126" name="__codelineno-35-126"></a><span class="w">              </span><span class="p">),</span>
<a id="__codelineno-35-127" name="__codelineno-35-127"></a><span class="w">              </span><span class="n">TextFormField</span><span class="p">(</span>
<a id="__codelineno-35-128" name="__codelineno-35-128"></a><span class="w">                </span><span class="nl">controller:</span><span class="w"> </span><span class="n">_imageUrlController</span><span class="p">,</span>
<a id="__codelineno-35-129" name="__codelineno-35-129"></a><span class="w">                </span><span class="nl">decoration:</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">InputDecoration</span><span class="p">(</span>
<a id="__codelineno-35-130" name="__codelineno-35-130"></a><span class="w">                  </span><span class="nl">icon:</span><span class="w"> </span><span class="n">Icon</span><span class="p">(</span><span class="n">Icons</span><span class="p">.</span><span class="n">image_outlined</span><span class="p">),</span>
<a id="__codelineno-35-131" name="__codelineno-35-131"></a><span class="w">                  </span><span class="nl">labelText:</span><span class="w"> </span><span class="s1">&#39;Image URL&#39;</span><span class="p">,</span>
<a id="__codelineno-35-132" name="__codelineno-35-132"></a><span class="w">                </span><span class="p">),</span>
<a id="__codelineno-35-133" name="__codelineno-35-133"></a><span class="w">                </span><span class="nl">keyboardType:</span><span class="w"> </span><span class="n">TextInputType</span><span class="p">.</span><span class="n">url</span><span class="p">,</span>
<a id="__codelineno-35-134" name="__codelineno-35-134"></a><span class="w">                </span><span class="nl">readOnly:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<a id="__codelineno-35-135" name="__codelineno-35-135"></a><span class="w">                </span><span class="nl">onTap:</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-35-136" name="__codelineno-35-136"></a><span class="w">                  </span><span class="n">XFile</span><span class="o">?</span><span class="w"> </span><span class="n">pickedImage</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">await</span><span class="w"> </span><span class="n">pickImage</span><span class="p">();</span>
<a id="__codelineno-35-137" name="__codelineno-35-137"></a><span class="w">                  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">pickedImage</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-35-138" name="__codelineno-35-138"></a><span class="w">                    </span><span class="n">image</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">File</span><span class="p">(</span><span class="n">pickedImage</span><span class="p">.</span><span class="n">path</span><span class="p">);</span>
<a id="__codelineno-35-139" name="__codelineno-35-139"></a><span class="w">                    </span><span class="n">setState</span><span class="p">(()</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-35-140" name="__codelineno-35-140"></a><span class="w">                      </span><span class="n">_imageUrlController</span><span class="p">.</span><span class="n">text</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">image</span><span class="o">!</span><span class="p">.</span><span class="n">path</span><span class="p">;</span>
<a id="__codelineno-35-141" name="__codelineno-35-141"></a><span class="w">                    </span><span class="p">});</span>
<a id="__codelineno-35-142" name="__codelineno-35-142"></a><span class="w">                  </span><span class="p">}</span>
<a id="__codelineno-35-143" name="__codelineno-35-143"></a><span class="w">                </span><span class="p">},</span>
<a id="__codelineno-35-144" name="__codelineno-35-144"></a><span class="w">              </span><span class="p">),</span>
<a id="__codelineno-35-145" name="__codelineno-35-145"></a><span class="w">              </span><span class="n">TextFormField</span><span class="p">(</span>
<a id="__codelineno-35-146" name="__codelineno-35-146"></a><span class="w">                </span><span class="nl">controller:</span><span class="w"> </span><span class="n">_ratingController</span><span class="p">,</span>
<a id="__codelineno-35-147" name="__codelineno-35-147"></a><span class="w">                </span><span class="nl">decoration:</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">InputDecoration</span><span class="p">(</span>
<a id="__codelineno-35-148" name="__codelineno-35-148"></a><span class="w">                  </span><span class="nl">icon:</span><span class="w"> </span><span class="n">Icon</span><span class="p">(</span><span class="n">Icons</span><span class="p">.</span><span class="n">star_outline</span><span class="p">),</span>
<a id="__codelineno-35-149" name="__codelineno-35-149"></a><span class="w">                  </span><span class="nl">labelText:</span><span class="w"> </span><span class="s1">&#39;Rating&#39;</span><span class="p">,</span>
<a id="__codelineno-35-150" name="__codelineno-35-150"></a><span class="w">                </span><span class="p">),</span>
<a id="__codelineno-35-151" name="__codelineno-35-151"></a><span class="w">                </span><span class="nl">keyboardType:</span><span class="w"> </span><span class="n">TextInputType</span><span class="p">.</span><span class="n">number</span><span class="p">,</span>
<a id="__codelineno-35-152" name="__codelineno-35-152"></a><span class="w">                </span><span class="nl">validator:</span><span class="w"> </span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-35-153" name="__codelineno-35-153"></a><span class="w">                  </span><span class="kd">final</span><span class="w"> </span><span class="n">regex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">RegExp</span><span class="p">(</span><span class="s1">&#39;[0-5]&#39;</span><span class="p">);</span>
<a id="__codelineno-35-154" name="__codelineno-35-154"></a><span class="w">                  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">value</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">null</span><span class="w"> </span><span class="o">&amp;&amp;</span>
<a id="__codelineno-35-155" name="__codelineno-35-155"></a><span class="w">                      </span><span class="n">value</span><span class="p">.</span><span class="n">isNotEmpty</span><span class="w"> </span><span class="o">&amp;&amp;</span>
<a id="__codelineno-35-156" name="__codelineno-35-156"></a><span class="w">                      </span><span class="o">!</span><span class="n">regex</span><span class="p">.</span><span class="n">hasMatch</span><span class="p">(</span><span class="n">value</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-35-157" name="__codelineno-35-157"></a><span class="w">                    </span><span class="k">return</span><span class="w"> </span><span class="s1">&#39;El valor debe estar entre 0 y 5&#39;</span><span class="p">;</span>
<a id="__codelineno-35-158" name="__codelineno-35-158"></a><span class="w">                  </span><span class="p">}</span>
<a id="__codelineno-35-159" name="__codelineno-35-159"></a><span class="w">                  </span><span class="k">return</span><span class="w"> </span><span class="kc">null</span><span class="p">;</span>
<a id="__codelineno-35-160" name="__codelineno-35-160"></a><span class="w">                </span><span class="p">},</span>
<a id="__codelineno-35-161" name="__codelineno-35-161"></a><span class="w">              </span><span class="p">),</span>
<a id="__codelineno-35-162" name="__codelineno-35-162"></a><span class="w">              </span><span class="n">Container</span><span class="p">(</span>
<a id="__codelineno-35-163" name="__codelineno-35-163"></a><span class="w">                </span><span class="nl">padding:</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">EdgeInsets</span><span class="p">.</span><span class="n">only</span><span class="p">(</span><span class="nl">top:</span><span class="w"> </span><span class="m">20</span><span class="p">),</span>
<a id="__codelineno-35-164" name="__codelineno-35-164"></a><span class="w">                </span><span class="nl">child:</span><span class="w"> </span><span class="n">ElevatedButton</span><span class="p">(</span>
<a id="__codelineno-35-165" name="__codelineno-35-165"></a><span class="w">                  </span><span class="nl">onPressed:</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-35-166" name="__codelineno-35-166"></a><span class="w">                    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">_formKey</span><span class="p">.</span><span class="n">currentState</span><span class="o">!</span><span class="p">.</span><span class="n">validate</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-35-167" name="__codelineno-35-167"></a><span class="w">                      </span><span class="n">ScaffoldMessenger</span><span class="p">.</span><span class="n">of</span><span class="p">(</span><span class="n">context</span><span class="p">).</span><span class="n">showSnackBar</span><span class="p">(</span>
<a id="__codelineno-35-168" name="__codelineno-35-168"></a><span class="w">                        </span><span class="k">const</span><span class="w"> </span><span class="n">SnackBar</span><span class="p">(</span><span class="nl">content:</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span><span class="s1">&#39;Producto modificado&#39;</span><span class="p">)),</span>
<a id="__codelineno-35-169" name="__codelineno-35-169"></a><span class="w">                      </span><span class="p">);</span>
<a id="__codelineno-35-170" name="__codelineno-35-170"></a><span class="hll"><span class="w">                      </span><span class="n">productsNotifier</span><span class="p">.</span><span class="n">modifyProduct</span><span class="p">(</span><span class="n">Product</span><span class="p">(</span>
</span><a id="__codelineno-35-171" name="__codelineno-35-171"></a><span class="w">                          </span><span class="nl">id:</span><span class="w"> </span><span class="n">product</span><span class="p">.</span><span class="n">id</span><span class="p">,</span>
<a id="__codelineno-35-172" name="__codelineno-35-172"></a><span class="w">                          </span><span class="nl">description:</span><span class="w"> </span><span class="n">_descriptionController</span><span class="p">.</span><span class="n">text</span><span class="p">,</span>
<a id="__codelineno-35-173" name="__codelineno-35-173"></a><span class="w">                          </span><span class="nl">price:</span><span class="w"> </span><span class="kt">double</span><span class="p">.</span><span class="n">tryParse</span><span class="p">(</span><span class="n">_priceController</span><span class="p">.</span><span class="n">text</span><span class="p">)</span><span class="o">!</span><span class="p">,</span>
<a id="__codelineno-35-174" name="__codelineno-35-174"></a><span class="w">                          </span><span class="nl">available:</span><span class="w"> </span><span class="n">_availableController</span><span class="p">.</span><span class="n">text</span><span class="p">.</span><span class="n">isNotEmpty</span>
<a id="__codelineno-35-175" name="__codelineno-35-175"></a><span class="w">                              </span><span class="o">?</span><span class="w"> </span><span class="n">DateTime</span><span class="p">.</span><span class="n">parse</span><span class="p">(</span><span class="n">_availableController</span><span class="p">.</span><span class="n">text</span><span class="p">)</span>
<a id="__codelineno-35-176" name="__codelineno-35-176"></a><span class="w">                              </span><span class="o">:</span><span class="w"> </span><span class="n">DateTime</span><span class="p">.</span><span class="n">now</span><span class="p">(),</span>
<a id="__codelineno-35-177" name="__codelineno-35-177"></a><span class="w">                          </span><span class="nl">imageUrl:</span><span class="w"> </span><span class="n">_imageUrlController</span><span class="p">.</span><span class="n">text</span><span class="p">,</span>
<a id="__codelineno-35-178" name="__codelineno-35-178"></a><span class="w">                          </span><span class="nl">rating:</span><span class="w"> </span><span class="n">_ratingController</span><span class="p">.</span><span class="n">text</span><span class="p">.</span><span class="n">isNotEmpty</span>
<a id="__codelineno-35-179" name="__codelineno-35-179"></a><span class="w">                              </span><span class="o">?</span><span class="w"> </span><span class="kt">int</span><span class="p">.</span><span class="n">parse</span><span class="p">(</span><span class="n">_ratingController</span><span class="p">.</span><span class="n">text</span><span class="p">)</span>
<a id="__codelineno-35-180" name="__codelineno-35-180"></a><span class="w">                              </span><span class="o">:</span><span class="w"> </span><span class="m">0</span><span class="p">));</span>
<a id="__codelineno-35-181" name="__codelineno-35-181"></a><span class="hll"><span class="w">                      </span><span class="n">Navigator</span><span class="p">.</span><span class="n">pop</span><span class="p">(</span><span class="n">context</span><span class="p">);</span>
</span><a id="__codelineno-35-182" name="__codelineno-35-182"></a><span class="w">                    </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-35-183" name="__codelineno-35-183"></a><span class="w">                      </span><span class="n">ScaffoldMessenger</span><span class="p">.</span><span class="n">of</span><span class="p">(</span><span class="n">context</span><span class="p">).</span><span class="n">showSnackBar</span><span class="p">(</span>
<a id="__codelineno-35-184" name="__codelineno-35-184"></a><span class="w">                        </span><span class="k">const</span><span class="w"> </span><span class="n">SnackBar</span><span class="p">(</span><span class="nl">content:</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span><span class="s1">&#39;Revise los datos&#39;</span><span class="p">)),</span>
<a id="__codelineno-35-185" name="__codelineno-35-185"></a><span class="w">                      </span><span class="p">);</span>
<a id="__codelineno-35-186" name="__codelineno-35-186"></a><span class="w">                    </span><span class="p">}</span>
<a id="__codelineno-35-187" name="__codelineno-35-187"></a><span class="w">                  </span><span class="p">},</span>
<a id="__codelineno-35-188" name="__codelineno-35-188"></a><span class="w">                  </span><span class="nl">child:</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span><span class="s1">&#39;Guardar cambios&#39;</span><span class="p">),</span>
<a id="__codelineno-35-189" name="__codelineno-35-189"></a><span class="w">                </span><span class="p">),</span>
<a id="__codelineno-35-190" name="__codelineno-35-190"></a><span class="w">              </span><span class="p">),</span>
<a id="__codelineno-35-191" name="__codelineno-35-191"></a><span class="w">            </span><span class="p">],</span>
<a id="__codelineno-35-192" name="__codelineno-35-192"></a><span class="w">          </span><span class="p">),</span>
<a id="__codelineno-35-193" name="__codelineno-35-193"></a><span class="w">        </span><span class="p">),</span>
<a id="__codelineno-35-194" name="__codelineno-35-194"></a><span class="w">      </span><span class="p">),</span>
<a id="__codelineno-35-195" name="__codelineno-35-195"></a><span class="w">    </span><span class="p">);</span>
<a id="__codelineno-35-196" name="__codelineno-35-196"></a><span class="w">  </span><span class="p">}</span>
<a id="__codelineno-35-197" name="__codelineno-35-197"></a>
<a id="__codelineno-35-198" name="__codelineno-35-198"></a><span class="w">  </span><span class="n">Future</span><span class="w"> </span><span class="n">pickImage</span><span class="p">()</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-35-199" name="__codelineno-35-199"></a><span class="w">    </span><span class="kd">final</span><span class="w"> </span><span class="n">XFile</span><span class="o">?</span><span class="w"> </span><span class="n">image</span><span class="p">;</span>
<a id="__codelineno-35-200" name="__codelineno-35-200"></a><span class="w">    </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-35-201" name="__codelineno-35-201"></a><span class="w">      </span><span class="n">image</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">await</span><span class="w"> </span><span class="n">ImagePicker</span><span class="p">().</span><span class="n">pickImage</span><span class="p">(</span><span class="k">source</span><span class="o">:</span><span class="w"> </span><span class="n">ImageSource</span><span class="p">.</span><span class="n">gallery</span><span class="p">);</span>
<a id="__codelineno-35-202" name="__codelineno-35-202"></a><span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="n">image</span><span class="p">;</span>
<a id="__codelineno-35-203" name="__codelineno-35-203"></a><span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="kd">on</span><span class="w"> </span><span class="n">PlatformException</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-35-204" name="__codelineno-35-204"></a><span class="w">      </span><span class="n">print</span><span class="p">(</span><span class="s1">&#39;Failed to pick image: </span><span class="si">$</span><span class="n">e</span><span class="s1">&#39;</span><span class="p">);</span>
<a id="__codelineno-35-205" name="__codelineno-35-205"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-35-206" name="__codelineno-35-206"></a><span class="w">  </span><span class="p">}</span>
<a id="__codelineno-35-207" name="__codelineno-35-207"></a><span class="p">}</span>
</code></pre></div></td></tr></table></div>
<p>Con esto hemos visto cómo utilizar JSON para almacenar datos en Flutter. En la siguiente unidad utilizaremos llamadas HTTP para obtener datos de un servidor.</p>





                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var tab,labels=set.querySelector(".tabbed-labels");for(tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
            
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
            Volver al principio
          </button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://github.com/jsanvil/din2023" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 480 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M186.1 328.7c0 20.9-10.9 55.1-36.7 55.1s-36.7-34.2-36.7-55.1 10.9-55.1 36.7-55.1 36.7 34.2 36.7 55.1zM480 278.2c0 31.9-3.2 65.7-17.5 95-37.9 76.6-142.1 74.8-216.7 74.8-75.8 0-186.2 2.7-225.6-74.8-14.6-29-20.2-63.1-20.2-95 0-41.9 13.9-81.5 41.5-113.6-5.2-15.8-7.7-32.4-7.7-48.8 0-21.5 4.9-32.3 14.6-51.8 45.3 0 74.3 9 108.8 36 29-6.9 58.8-10 88.7-10 27 0 54.2 2.9 80.4 9.2 34-26.7 63-35.2 107.8-35.2 9.8 19.5 14.6 30.3 14.6 51.8 0 16.4-2.6 32.7-7.7 48.2 27.5 32.4 39 72.3 39 114.2zm-64.3 50.5c0-43.9-26.7-82.6-73.5-82.6-18.9 0-37 3.4-56 6-14.9 2.3-29.8 3.2-45.1 3.2-15.2 0-30.1-.9-45.1-3.2-18.7-2.6-37-6-56-6-46.8 0-73.5 38.7-73.5 82.6 0 87.8 80.4 101.3 150.4 101.3h48.2c70.3 0 150.6-13.4 150.6-101.3zm-82.6-55.1c-25.8 0-36.7 34.2-36.7 55.1s10.9 55.1 36.7 55.1 36.7-34.2 36.7-55.1-10.9-55.1-36.7-55.1z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.tabs", "navigation.sections", "navigation.top", "toc.follow", "search.suggest", "search.highlight", "content.tabs.link", "content.code.annotation", "content.code.copy"], "search": "../../assets/javascripts/workers/search.a264c092.min.js", "translations": {"clipboard.copied": "Copiado al portapapeles", "clipboard.copy": "Copiar al portapapeles", "search.result.more.one": "1 m\u00e1s en esta p\u00e1gina", "search.result.more.other": "# m\u00e1s en esta p\u00e1gina", "search.result.none": "No se encontraron documentos", "search.result.one": "1 documento encontrado", "search.result.other": "# documentos encontrados", "search.result.placeholder": "Teclee para comenzar b\u00fasqueda", "search.result.term.missing": "Falta", "select.version": "Seleccionar versi\u00f3n"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.726fbb30.min.js"></script>
      
    
  </body>
</html>